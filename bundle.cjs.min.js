"use strict";function e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function t(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,t(r.key),r)}}function i(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,a,n){return(a=t(a))in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var d={addressPrefix:"//secure-",webProtocol:"https:",configGlobalVer:"600",sdkvForConfig:"bj.6.0.0",localBuildVer:"",collectionAddress:"",nsdkvOverride:"600",baseConfigUrl:"https://secure-gl.imrworldwide.com/novms/js/2/ggcmb510.js",baseConfigUrlBucket:"cgi-bin/",sessionIdUrlPrefix:"cgi-bin/gn?prd=session&c9=devid,&c13=asid,",sessionIdUrlSuffix:"&sessionId=|!nol_userSessionId!|&c16=sdkv,|!nol_sdkv!|&uoo=|![nol_useroptout]!|&fp_id=|![(nol_fpid)]!|&fp_cr_tm=|![nol_fpidCreateTime]!|&fp_acc_tm=|![nol_fpidAccessTime]!|&fp_emm_tm=|![nol_fpidLastEMMPingTime]!|&ve_id=|![(nol_veid)]!|&c30=bldv,|![nol_bldv||nol_bldVersion]!|&uid2=|![(nol_uid2)]!|&uid2_token=|![(nol_uid2Token)]!|&hem_sha256=|![(nol_hemSha256)]!|&hem_sha1=|![(nol_hemSha1)]!|&hem_md5=|![(nol_hemMd5)]!|&hem_unknown=|![(nol_hemUnknown)]!|",imridCookieKey:"IMRID",cdnAddress:"imrworldwide.com",domain:"imrworldwide.com",nielsenDomains:[".imrworldwide.com",".nmrodam.com"],configGlobalFile:"glcfg510.js",buildVersion:"6.0.0.16",defaultSfCode:"sdk",defaultNsdkv:600,subdomain:"cdn-gl",paramPrefix:"",maxRetries:5,sdkUrl:"{{protocol}}//{{subdomain}}.{{domain}}/novms/js/{{sdksubpath}}/nlsSDK{{nsdkv}}.bundle.min.js",dprConfigAPI:"cfg",dprErrorAPI:"error",defaultTimelineSize:5,cdnAddressDomainPrefix:"https://cdn-gl",defaultCdnAddress:"https://sdk.imrworldwide.com/",euMarketFileMap:"600.eu",domlessSuffix:"_dl",sdkBuildVersion:"676"},c=function(){return global||window},u=function(){return(new Date).getTime()},p=function(e){return null!=e?d.cdnAddressDomainPrefix+e:d.defaultCdnAddress},m=function(){function e(t){if(n(this,e),!t)throw new Error("FuncsProcessor: args is required");this.implementationHooks=t.implementationHooks,this.validateFuncs()}return i(e,[{key:"validateFuncs",value:function(){var e=this;["Log","Fetch","SetTimeout","ClearTimeout","SetInterval","ClearInterval"].forEach((function(t){if(!e.implementationHooks[t])throw new Error("Missing required function: ".concat(t))}))}},{key:"storageSetItem",value:function(e,t){this.implementationHooks.Storage&&this.implementationHooks.Storage.setItem&&this.implementationHooks.Storage.setItem(e,t)}},{key:"storageGetItem",value:function(e){if(this.implementationHooks.Storage&&this.implementationHooks.Storage.getItem)return this.implementationHooks.Storage.getItem(e)}},{key:"storageRemoveItem",value:function(e){if(this.implementationHooks.Storage&&this.implementationHooks.Storage.removeItem)return this.implementationHooks.Storage.removeItem(e)}},{key:"storageClear",value:function(){if(this.implementationHooks.Storage&&this.implementationHooks.Storage.clear)return this.implementationHooks.Storage.clear()}},{key:"logInfo",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.info&&this.implementationHooks.Log.info(e)}},{key:"logDebug",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.debug&&this.implementationHooks.Log.debug(e)}},{key:"logWarn",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.warn&&this.implementationHooks.Log.warn(e)}},{key:"logError",value:function(e){this.implementationHooks.Log&&this.implementationHooks.Log.error&&this.implementationHooks.Log.error(e)}},{key:"fetchUrl",value:function(e,t){if(this.implementationHooks.Fetch)return t||(t={}),this.implementationHooks.Fetch(e,t);Promise.reject("Fetch function has not been provided to Nielsen SDK")}},{key:"processSetTimeout",value:function(e){var t;if(this.implementationHooks.setTimeout)return(t=this.implementationHooks).setTimeout.apply(t,s(e));throw new Error("setTimeout function has not been provided to Nielsen SDK")}},{key:"processClearTimeout",value:function(e){var t;if(this.implementationHooks.clearTimeout)return(t=this.implementationHooks).clearTimeout.apply(t,s(e));throw new Error("clearTimeout function has not been provided to Nielsen SDK")}},{key:"processSetInterval",value:function(e){var t;if(this.implementationHooks.setInterval)return(t=this.implementationHooks).setInterval.apply(t,s(e));throw new Error("setInterval function has not been provided to Nielsen SDK")}},{key:"processClearInterval",value:function(e){var t;if(this.implementationHooks.clearInterval)return(t=this.implementationHooks).clearInterval.apply(t,s(e));throw new Error("clearInterval function has not been provided to Nielsen SDK")}}],[{key:"getInstance",value:function(t){return e.instance||(e.instance=new e(t)),e.instance}}]),e}(),v="",f=5,g={defaultNSDKV:d.defaultNsdkv,defaultSfcode:d.defaultSfCode,subdomain:d.subdomain,domain:d.domain,protocol:d.webProtocol,sdkUrl:d.sdkUrl},_={eu:d.euMarketFileMap,"eu-cert":d.euMarketFileMap,"eu-uat":d.euMarketFileMap},h=function(e,t,a){var n=c(),r=m.getInstance();n[e]||(n[e]={},a.name&&(n[e][a.name]={g:void 0!==a?a:{}}));var i={apid:t,sfcode:S.getDefaultField("nol_sfcode")||g.defaultSfcode,nsdkv:g.defaultNSDKV},o=n[e][a.name]||n[a.name],s=o?o.g:{};if(s)for(var l=Object.keys(s),d=0;d<l.length;d++)void 0!==s[l[d]]&&null!==s[l[d]]&&""!==s[l[d]]&&(i[l[d]]=s[l[d]],"deviceId"!==l[d]||void 0===s.optout||"true"!==s.optout&&!0!==s.optout||(i[l[d]]=""));i.sfcode=S.getGlobalsField(e,t,"nol_sfcode")||i.sfcode,i.nsdkv=S.getGlobalsField(e,t,"nol_nsdkvConfig")||S.getGlobalsField(e,t,"nol_nsdkv")||_[i.sfcode]||i.nsdkv,i=S.setTesting(i);var u=S.getGlobalsField(e,t,"nol_sdkDebug");return u&&(i.nol_sdkDebug=u),r.logInfo("Nielsen Log: Info - Globals set: ".concat(JSON.stringify(i))),i},P=function(e,t){var a,n,r=[],i=e.split("&");for(a=0,n=i.length;a<n;a++)0!==i[a].indexOf(t)&&r.push(i[a]);return r.join("&")};function y(){var e=c();return e&&!e.NOLBUNDLE&&(e.NOLBUNDLE={}),e.NOLBUNDLE}function b(e,t){var a;if("num"==t)a=parseInt(e,10),e=isNaN(a)?0:a;else if("bin"==t)e=isNaN(Number(e))?"0":Number(e).toString(2);else if("bool"==t)switch(e.toString().toLowerCase()){case"false":case"no":case"0":case"":e=!1;break;default:e=!0}else"b2n"==t&&(a=parseInt(e,2),e=isNaN(a)?0:a);return e}function O(){try{var e=X();return e&&e.PLDPR&&e.PLDPR.cmsMapDictionary?e.PLDPR.cmsMapDictionary:{}}catch(e){m.getInstance().logError("Error in cmsMapDictionary",e)}}function L(){try{var e=X();return e&&e.PLDPR&&e.PLDPR.dataObj?e.PLDPR.dataObj:{}}catch(e){m.getInstance().logError("Error in getDataObj",e)}}var S={parseNOLParams:function(e){var t=e.replace(/^[^\#]+\#?/,""),a={};if(!t)return a;for(var n=new RegExp("&"+v,"gi"),r="<<nol_delimeter>>",i=r+v,o=(t=t.replace(n,i)).split(r),s=null,l=0;l<o.length;l++){s=o[l].indexOf("=");var d=unescape(o[l].substr(0,s)),c=unescape(o[l].substr(s+1));c=c.replace(/\+/g," "),a[d.replace(v,"")]=c}return a},findScript:function(e){if(document.currentScript)return document.currentScript.src;var t=document.getElementsByTagName("script"),a=[];if(t)for(var n="",r=null,i=new RegExp(e+".*?.js"),o=0;o<t.length;o++)(n=(r=t[o])&&r.attributes&&r.attributes.src?r.attributes.src.value:"").match(i)&&a.push(n);return a},loadScript:function(e,t,a){var n=0;function r(e,t,a){var n=window.document.createElement("script");n.async=!0,n.setAttribute("data-jsonpid",name),n.src=e,n.onload=t,n.onerror=a;var r=window.document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r)}r(e,t,(function i(o){var s=m.getInstance();n<f?(n++,s.processSetTimeout((function(){s&&s.logWarn("Retry request # "+n),r(e,t,i)}),2e3)):(s&&s.logError("Unable to load script "+e),a&&a())}))},setTesting:function(e){return e&&e.enableTesting&&cfg&&cfg.nol_GLOBALS&&g?("true"===e.enableTesting&&e.bundleVersion&&(e.environment||(e.environment="futuremaster"),"true"===cfg.nol_GLOBALS.nol_allowTesting&&(e.sfcode="cert",e.sdkUrl="//"+e.environment+".nonprod.digitalengsdk.com/novms/js/2/ver/nlsSDK600."+e.bundleVersion+".bundle.min.js")),e):e},getGlobalsField:function(e,t,a){var n=c();if(t&&a&&n[e]&&n[e].configs){var r=n[e].configs[t];if(r&&r.nol_GLOBALS)return r.nol_GLOBALS[a]}return null},getDefaultField:function(e,t,a){var n=c();if(t&&a&&n[e]&&n[e].configs){var r=n[e].configs[t];if(r&&r.nol_GLOBALS&&r.nol_GLOBALS.nol_tagMap&&r.nol_GLOBALS.nol_tagMap.nol_defaults)return r.nol_GLOBALS.nol_tagMap.nol_defaults[a]}return null},param:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";if(e&&"object"===a(e)&&Object.keys(e).length>0)for(var r in e)e.hasOwnProperty(r)&&(n+="".concat(""!==n?"&":"").concat(t?t+"-":"").concat(r,"=").concat(e[r]));return n},paramOverride:function(e,t,a){if(e&&t){var n=new RegExp("([&?]+".concat(t,"=)([^&$]*)"),"gi"),r=e.match(n);if(r)for(var i=0,o=r.length;i<o;i++){var s=r[i].substr(0,r[i].indexOf("=")+1)+(a||"");e=e.replace(r[i],s)}}return e}},T=function(e){},C=function(e){var t=m.getInstance();return new Promise((function(a,n){t.fetchUrl(e,{method:"GET",cache:"no-cache",credentials:"include",mode:"no-cors"}).then((function(n){if(!(n&&n.status&&n.status>=200&&n.status<300))throw new Error("Error in fetch request to ".concat(e," - Response: ").concat(n));t.logDebug("Success making fetch to ".concat(e)),a({status:n.status,response:n})})).catch((function(a){t.logError("Error in fireToUrl sendUrlRequest: to ".concat(e," - Error: ").concat(a)),n(a)}))}))},w=S.param,D=S.paramOverride,E=S.parseNOLParams,I=S.findScript,k=S.loadScript,R=S.setTesting,F=S.getGlobalsField,A=S.getDefaultField,M=function(){function e(t){n(this,e),this.webProtocol=d.webProtocol,this.addressPrefix=d.addressPrefix,this.configGlobalFile=d.configGlobalFile,this.cacheBusterRefreshMilliseconds=864e5,this.maxNumberOfAssetInstances=1,this.numSecToUpdateAssets=5,this.startGlobalTime=0,this.currentGlobalTime=0,this.currentGlobalSeconds=0,this.stateObj={},this.optOutStatus=!1,this.sessionIdUrlPrefix=d.sessionIdUrlPrefix,this.configGlobalVer=d.configGlobalVer,this.nsdkvOverride=d.nsdkvOverride,this.nielsenDomains=d.nielsenDomains;var a=this.getInstances();this.__instance=void 0!==a?a:{},this.isBuilt=!1,this.sdkvForConfig=d.sdkvForConfig,this._localBuildVer=d.sdkBuildVersion,this.BUILDVERSION=d.buildVersion,this.debug=0,this._configs={paramPrefix:d.paramPrefix,maxRetries:d.maxRetries},this._sdkSettings={defaultNSDKV:d.defaultNsdkv,defaultSfcode:d.defaultSfCode,subdomain:d.subdomain,domain:d.domain,protocol:d.webProtocol,sdkUrl:d.sdkUrl},this.marketFileMap={eu:d.euMarketFileMap,"eu-cert":d.euMarketFileMap,"eu-uat":d.euMarketFileMap},this._glcfg=t,this.globalObj=c(),this.getConfigAddress=this.getConfigAddress.bind(this),this.getAddress=this.getAddress.bind(this),this.funcsProcessor=m.getInstance()}return i(e,[{key:"getInstance",value:function(e){var t=void 0!==e&&("string"==typeof e||"object"==a(e)&&e.constructor===String)?e:"default";return this.__instance.hasOwnProperty(t)||(this.__instance[t]=Pe(t)),this.__instance[t]}},{key:"getInstances",value:function(){return this.__instance}},{key:"getAddress",value:function(){return p()}},{key:"getConfigAddress",value:function(){return this.collectionAddress}},{key:"getAddressProtocol",value:function(){return this.webProtocol}},{key:"loadXmlString",value:function(e){return null}},{key:"isNielsenTag",value:function(e){var t=!1;if(void 0!==e){var a=e.indexOf("?"),n=-1!==e.indexOf(this.nielsenDomains[0])?e.indexOf(this.nielsenDomains[0]):e.indexOf(this.nielsenDomains[1]);n>-1&&n<a&&(t=!0)}return t}},{key:"getVersion",value:function(){return this.configGlobalVer}},{key:"getVersionOverride",value:function(){return this.nsdkvOverride}},{key:"send",value:function(e){e&&this.funcsProcessor&&this.funcsProcessor.logDebug(e.parentNode)}},{key:"browserSafeAddEventListener",value:function(e){void 0!==e.element&&(e.element.addEventListener?e.element.addEventListener(e.eventType,e.func,e.useCapture):e.element.attachEvent&&e.element.attachEvent("on"+e.eventType,e.func))}},{key:"browserSafeRemoveEventListener",value:function(e){null!=e&&null!==e.element&&void 0!==e.element&&(e.element.removeEventListener?e.element.removeEventListener(e.eventType,e.func,e.useCapture):e.element.detachEvent&&e.element.detachEvent("on"+e.eventType,e.func))}}],[{key:"getStaticInstance",value:function(t){return e.instance||(e.instance=new e(t)),e.instance}}]),e}(),x=x||{};function V(e,t){var a=c(),n={set:function(e,t){return n.init=!0,n.elapsed=0,n.startTimeStamp=0,"function"==typeof e&&(n.funcCall=e),isNaN(t)||(n.intervalTime=t),n},play:function(e){return n.isActive||(e?(n.startTimeStamp=0,n.elapsed=0,n.setTimer()):n.setTimer(n.remaining),n.isActive=!0),n},pause:function(){return n.isActive&&(n.isActive=!1,n.remaining=n.remaining-(Date.now()-n.last),n.clearTimer()),n},stop:function(){return n.isActive=!1,n.remaining=n.intervalTime,n.clearTimer(),n},clearTimer:function(){a.clearTimeout(n.timeoutObject)},setTimer:function(e){var t=n;"function"==typeof n.funcCall&&(isNaN(e)&&(e=n.intervalTime),n.remaining=e,n.last=Date.now(),n.clearTimer(),n.timeoutObject=m.getInstance().processSetTimeout((function(){t.tick()}),e))},tick:function(){if(n.isActive){var e=n.last;n.remaining<n.intervalTime&&(e-=n.intervalTime-n.remaining),n.setTimer();var t=(n.last-e)/1e3;t<x.nol_maxTickDelta&&t>=0?n.elapsed=n.elapsed+t:n.elapsed++,n.funcCall()}},reset:function(){n.startTimeStamp=0,n.elapsed=0,n.remaining=n.intervalTime}};return n.init||n.set(e,t),n}function G(e){try{var t,a=function(){u.dcrTimer&&(u.latestDcrTickVal=u.dcrTimer.elapsed,c._listeners.fireEvent("dcrHeartbeat",u.dcrTimer)),u.focusTimer.enableTimeout&&u.focusTimer.timeElapsed&&(u.focusTimer.enableTimeout=!1)},n=function(e){t&&clearTimeout(t),c.globalHasFocus&&!c.globalHasFocus()&&(t=f.processSetTimeout((function(){u.safeFocusOn&&u.dcrTimer&&(u.safeFocusOn=!1,c.globalHasFocus&&!c.globalHasFocus()&&(c._listeners.fireEvent("info",{type:"info",msg:"Safe Focus timeout"}),u.dcrTimer.pause(),c.flushEvent(e))),clearTimeout(t)}),1e3*u.nol_idleTimeout),!u.safeFocusOn&&u.dcrTimer&&(c._listeners.fireEvent("info",{type:"info",msg:"Safe Focus initiated"}),u.safeFocusOn=!0,u.dcrTimer.play(u._reset),u._reset=!1))},r=function(e){(self===top||self!==top&&c.globalHasFocus&&!c.globalHasFocus())&&(m.getInstance().processSetTimeout((function(){return function(e){c.globalHasFocus&&c.globalHasFocus()?u.focusTimer.intervalID=i():u.dcrTimer&&(u.dcrTimer.pause(),c._listeners.fireEvent("info",{type:"info",msg:"Page onBlur fired and stopping static timer: ".concat(e?JSON.stringify(e,["type","isTrusted"]):"{}")}))}(e)}),0),u.safeFocusOn&&(u.safeFocusOn=!1))},i=function(){if(!u.focusTimer.intervalID&&!c.browser.isWithinIFrame())return setInterval((function(){if(u.dcrTimer&&!u.dcrTimer.isActive&&c.globalHasFocus&&c.globalHasFocus()&&(u.dcrTimer.play(!0),u._reset=!1,c._listeners.fireEvent("info",{type:"info",msg:"Page has focus via focus interval timer. Playing DCR Static timer!"})),u.focusTimer.enableTimeout){var e=Date.now(),t=(e-u.focusTimer.timeoutStartTime)/1e3;u.focusTimer.timeElapsed=u.focusTimer.timeElapsed+t,u.focusTimer.timeElapsed>u.nol_idleTimeout&&(clearInterval(u.focusTimer.intervalID),u.focusTimer.intervalID=null),u.focusTimer.timeoutStartTime=e}}),1e3)},o=function(e){u.dcrTimer&&(u.dcrTimer.play(u._reset),c._listeners.fireEvent("info",{type:"info",msg:"Page onFocus fired and playing static timer: ".concat(e?JSON.stringify(e,["type","isTrusted"]):"{}")})),u.focusTimer.intervalID&&(clearInterval(u.focusTimer.intervalID),u.focusTimer.intervalID=null),u._reset=!1},s=function(e){n(e)},l=function(e){u.dcrTimer&&u.dcrTimer.stop()},d=e.global,c=e.glcfg,u=c.PLDCR=c.PLDCR||{dcrTimer:void 0,startDcrTime:0,latestDcrTickVal:0,_reset:!1,nol_idleTimeout:1800,nol_maxTickDelta:10,cadenceOverrideEnabled:!1,cadenceOverride:30,safeFocusOn:!1,focusTimer:{intervalID:null,timeElapsed:0,enableTimeout:!1,timeoutStartTime:0}},p=e.ns,v=c.getBaseBuildVer?c.getBaseBuildVer()+"1":"6.0.01",f=m.getInstance();u.startDcrTick=function(){},u.latestDcrTick=function(){return u.latestDcrTickVal};return u.start=function(e){var t=!c.globalHasFocus||c.globalHasFocus();u._reset=e,(null===u.dcrTimer||void 0===u.dcrTimer||e)&&(t?(u.dcrTimer=V(a,1e3).play(!0),u._reset=!1):u.dcrTimer=V(a,1e3))},u.stop=function(){u.dcrTimer&&u.dcrTimer.stop()},u.init=function(e){},u.removeListeners=function(){p.browserSafeRemoveEventListener({element:d,eventType:"blur",func:r,useCapture:!1}),p.browserSafeRemoveEventListener({element:d,eventType:"focus",func:o,useCapture:!1}),p.browserSafeRemoveEventListener({element:d,eventType:"touchstart",func:s,useCapture:!1}),p.browserSafeRemoveEventListener({element:d,eventType:"pagehide",func:l,useCapture:!1}),c.browser.removeEventListener({element:d,eventType:"blur",useCapture:!1,func:c.flushEvent}),c.browser.removeEventListener({element:d,eventType:"pagehide",useCapture:!1,func:c.flushEvent})},u.safeFocus=n,u.built||(u.built=!0,u.BUILDVERSION=v,c.bindPlayers(u,"PLDCR")),u}catch(e){m.getInstance().logError("PLDCR Error: ",e)}}var j=function(){function e(){n(this,e);try{this._glcfg=X(),this._keys={currentPosition:"nolPriv_currPos",currentTimestamp:"nolPriv_now",stateCurrentPosition:"nolPriv_stateCurrentPH",stateCurrentTimestamp:"nolPriv_stateCurrentTS",stateCurrentStatus:"nolPriv_stateCurrentStatus",stateCurrentAsset:"nolPriv_stateCurrentAsset",stateCurrentType:"nolPriv_stateCurrentType",statePreviousPosition:"nolPriv_statePreviousPH",statePreviousTimestamp:"nolPriv_statePreviousTS",statePreviousStatus:"nolPriv_statePreviousStatus",statePreviousAsset:"nolPriv_statePreviousAsset",statePreviousType:"nolPriv_statePreviousType",tagName:"nol_comment",localTimer:"nol_timer",assetId:"nol_assetid"},this._params={optout:"uoo",nuid:"c1"},this.states={loaded:"LOADED",playing:"PLAYING",paused:"PAUSED",stopped:"STOPPED"},this.asset={current:function(e){return e?e._currAssetid:null},parse:function(e,t){var a=O(),n=a[e.get("nol_playerId")]&&a[e.get("nol_playerId")].nol_assetid?a[e.get("nol_playerId")].nol_assetid.clientField:"nol_assetid";return t?t[n]:null}},this.type={isCurrentlyContent:function(e){return"content"===e._currVidType},isCurrentlyAd:function(e){return"ad"===e._currVidType},isCurrentlyStatic:function(e){return"static"===e._currVidType},current:function(e){return e._currVidType},parse:function(e,t){var a=O()[e.get("nol_playerId")]||{},n=a.nol_vidtype?a.nol_vidtype.clientField:"nol_vidtype",r=t[n]?t[n].toString().toLowerCase():"",i=","+W({data:e,param:"nol_contentType"});return r&&-1!==i.indexOf(","+r)?"content":"dcrstatic"===W({data:e,param:"nol_product"})?"static":"ad"}},this.state={position:{current:function(t,a){return b(W({data:t,param:e.instance._keys.stateCurrentPosition,vidType:a||t._currVidType}),"num")},previous:function(t,a){return b(W({data:t,param:e.instance._keys.statePreviousPosition,vidType:a||t._currVidType}),"num")},set:function(t,a,n){var r=e.instance.state.position.current(t);W({data:t,param:e.instance._keys.statePreviousPosition,val:r,vidType:n||t._currVidType}),W({data:t,param:e.instance._keys.stateCurrentPosition,val:a,vidType:n||t._currVidType})}},timeStamp:{current:function(t,a){return b(W({data:t,param:e.instance._keys.stateCurrentTimestamp,vidType:a||t._currVidType}),"num")},previous:function(t,a){return b(W({data:t,param:e.instance._keys.statePreviousTimestamp,vidType:a||t._currVidType}),"num")},set:function(t,a,n){var r=e.instance.state.timeStamp.current(t);W({data:t,param:e.instance._keys.statePreviousTimestamp,val:r,vidType:n||t._currVidType}),W({data:t,param:e.instance._keys.stateCurrentTimestamp,val:a,vidType:n||t._currVidType})}},asset:{current:function(t,a){return W({data:t,param:e.instance._keys.stateCurrentAsset,vidType:a||t._currVidType})},previous:function(t,a){return W({data:t,param:e.instance._keys.statePreviousAsset,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.asset.current(t);W({data:t,param:e.instance._keys.statePreviousAsset,val:r,vidType:n||t._currVidType}),W({data:t,param:e.instance._keys.stateCurrentAsset,val:a,vidType:n||t._currVidType})}},status:{current:function(t,a){return W({data:t,param:e.instance._keys.stateCurrentStatus,vidType:a||t._currVidType})},previous:function(t,a){return W({data:t,param:e.instance._keys.statePreviousStatus,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.status.current(t,n);W({data:t,param:e.instance._keys.statePreviousStatus,val:r,vidType:n||t._currVidType}),W({data:t,param:e.instance._keys.stateCurrentStatus,val:a,vidType:n||t._currVidType})}},type:{current:function(t,a){return W({data:t,param:e.instance._keys.stateCurrentType,vidType:a||t._currVidType})},previous:function(t,a){return W({data:t,param:e.instance._keys.statePreviousType,vidType:a||t._currVidType})},set:function(t,a,n){var r=e.instance.state.type.current(t,n);W({data:t,param:e.instance._keys.statePreviousType,val:r,vidType:n||t._currVidType}),W({data:t,param:e.instance._keys.stateCurrentType,val:a,vidType:n||t._currVidType})}},set:function(t,a){var n=e.instance.findPlayer(t);switch(a.event){case"LOAD":e.instance.state.asset.set(t,a.assetId,a.contentType),e.instance.state.type.set(t,a.contentType),e.instance.state.timeStamp.set(t,a.timestamp);break;case"PLAY":case"RESUME":e.instance.state.status.set(t,e.instance.states.playing),e.instance.state.asset.set(t,a.assetId,a.contentType),e.instance.state.type.set(t,a.contentType),e.instance.state.timeStamp.set(t,a.timestamp),"PLAY"===a.event&&e.instance.state.position.set(t,0),"RESUME"===a.event&&null!=a.currentPos&&null!=a.currentPos&&"{{nextTick}}"!=a.currentPos&&(e.instance.state.position.set(t,a.curPos),e.instance.state.timeStamp.set(t,a.timestamp)),n.pauseObj.eventPauseTime=0;break;case"PAUSE":e.instance.state.status.set(t,e.instance.states.paused);break;case"STOP":e.instance.state.resetAsset(t),e.instance.state.status.set(t,e.instance.states.stopped);break;case"PLAYHEAD":case"REWIND":case"FORWARD":e.instance.state.position.set(t,a.curPos),e.instance.state.timeStamp.set(t,a.timestamp),n.pauseObj.eventPauseTime=0;break;case"MUTE":break;case"event_play":n.pauseObj.eventPauseTime=0}},get:function(t,a){try{if(t)return{position:{current:e.instance.state.position.current(t,a),previous:e.instance.state.position.previous(t,a)},timeStamp:{current:e.instance.state.timeStamp.current(t,a),previous:e.instance.state.timeStamp.previous(t,a)},asset:{current:e.instance.state.asset.current(t,a),previous:e.instance.state.asset.previous(t,a)},status:{current:e.instance.state.status.current(t,a),previous:e.instance.state.status.previous(t,a)},type:{current:e.instance.state.type.current(t,a),previous:e.instance.state.type.previous(t,a)}}}catch(e){}return null},resetAsset:function(t){e.instance.state.position.set(t,null),e.instance.state.timeStamp.set(t,null),e.instance.state.asset.set(t,null)},bind:function(t,a){try{if(t&&a)for(var n in a)W({data:t,param:e.instance._keys.statePreviousPosition,val:a[n].position?a[n].position.previous:null,vidType:n}),W({data:t,param:e.instance._keys.stateCurrentPosition,val:a[n].position?a[n].position.current:null,vidType:n}),W({data:t,param:e.instance._keys.statePreviousTimestamp,val:a[n].timeStamp?a[n].timeStamp.current:null,vidType:n}),W({data:t,param:e.instance._keys.stateCurrentTimestamp,al:a[n].timeStamp?a[n].timeStamp.current:null,vidType:n}),W({data:t,param:e.instance._keys.statePreviousAsset,val:a[n].asset?a[n].asset.current:null,vidType:n}),W({data:t,param:e.instance._keys.stateCurrentAsset,val:a[n].asset?a[n].asset.current:null,vidType:n}),W({data:t,param:e.instance._keys.statePreviousStatus,val:a[n].status?a[n].status.current:null,vidType:n}),W({data:t,param:e.instance._keys.stateCurrentStatus,val:a[n].status?a[n].status.current:null,vidType:n}),W({data:t,param:e.instance._keys.statePreviousType,val:a[n].type?a[n].type.current:null,vidType:n}),W({data:t,param:e.instance._keys.stateCurrentType,val:a[n].type?a[n].type.current:null,vidType:n})}catch(e){}},clone:function(t){try{return{content:e.instance.state.get(t,"content"),ad:e.instance.state.get(t,"ad")}}catch(e){}}},this.cms={parse:function(e,t,a){var n={metadata:(a?a.metadata:null)||{},defaultKey:(a?a.defaultKey:"")||"",silent:(a?a.silent:null)||!1,noClone:(a?a.noClone:null)||!1,vidType:a?a.vidType:"",noEncode:!(!a||!0!==a.noEncode)},r=e&&e.clientField?e.clientField:n.defaultKey;if(r&&t){if(n.metadata&&n.metadata.hasOwnProperty(r)&&n.metadata[r])return n.metadata[r];if(e&&e.clientField){if(n.end)return t.get(e.clientField,a?a.vidType:"");var i=t;!0!==n.noClone&&Ae(i=JSON.parse(JSON.stringify(t)),"loadmetadata",n.metadata,null,!0);var o=[];return!0===n.noEncode?o=[r]:(o=(e.encoding||"").split("")).splice(o.length/2,0,r),n.end=!0,rt(i,"|!"+o.join("")+"!|",null,n)}}return""}},this.mtvr={isTransPing:function(e){return!!e&&"id3"===W({data:e,param:"nol_product"})},isPCTag:function(e){return!!e&&(e.isProductOf("mtvr")&&""!==W({data:e,param:"nol_subTag"}))},pcChanged:function(e,t){return!!e&&t!==W({data:e,param:"nol_pccid"})},isFDTag:function(e){return!!e&&(e.isProductOf("mtvr")&&""===W({data:e,param:"nol_subTag"}))},fdChanged:function(e,t){return!!e&&t!==W({data:e,param:"nol_fdcid"})},resetTagSession:function(e,t){e&&e.set("nol_sessionId",t||this._glcfg.generateGUID(),"content")},clearTagSession:function(e){if(e)return e.del("nol_sessionId","content")},isNullPCCid:function(e){return e.get("nol_pccid")===e.get("nol_cidNull")},isNullFDCid:function(e){return e.get("nol_fdcid")===e.get("nol_cidNull")}}}catch(e){console.error("Error in PlayerController constructor",e)}}return i(e,[{key:"findPlayer",value:function(t){if(t){if("string"==typeof t)return this._glcfg._players[t];var a=W({data:t,param:"nol_playerId"});return e.instance.findPlayer(a)}return null}},{key:"currentPosition",value:function(t){return b(W({data:t,param:e._keys.currentPosition}),"num")}},{key:"currentTimestamp",value:function(t){return b(W({data:t,param:e._keys.currentTimestamp}),"num")}},{key:"tagName",value:function(t,a){return W({data:t,param:e._keys.tagName,vidType:a||t._currVidType})}},{key:"localTimer",value:function(t,a){return W({data:t,param:e._keys.localTimer,vidType:a||t._currVidType})||"nol_fdoffset"}},{key:"isInitialized",value:function(e,t){try{return t=t||e._currVidType,"{}"!==JSON.stringify(e._dataArrObj[t])}catch(e){return!1}}},{key:"updateMetadata",value:function(e,t,n,r){try{var i={nolParams:["nol_assetid","nol_assetName","nol_title","nol_vcTitle","nol_category","nol_channelName","nol_clientid","nol_vcid","nol_vidtype","nol_adLoadType"]};n=n||O()[e.get("nol_playerId")]||{};var o=function(e){var t=!0;for(var a in i.nolParams)if(n&&n.hasOwnProperty(i.nolParams[a])&&e===n[i.nolParams[a]].clientField){t=!1;break}return t};if(!e||!t)return;var s=void 0!==n&&"object"===a(n)&&n;for(var l in t)t.hasOwnProperty(l)&&(s&&o(l)?W({data:e,param:String(l),val:String(t[l])}):r&&r.inferred||this._glcfg._listeners.fireEvent("warn",{type:"warn",msg:"Attempt to update metadata field "+l+" is not allowed. Please remove "+l+" from your metadata parameter."}))}catch(e){this._glcfg._listeners.fireEvent("error",{type:"error",msg:"Failed to update metadata"})}}},{key:"extendfData",value:function(e){"function"!=typeof e.get&&(e.isProductOf=function(e){return!!e&&("object"===a(e)?e.indexOf(W({data:this,param:"nol_product"}))>-1:W({data:this,param:"nol_product"})===e)},e.get=function(e,t){return W({data:this,param:e,vidType:t})},e.set=function(e,t,a){return W({data:this,param:e,val:t,vidType:a})},e.del=function(e,t){e&&t&&this&&this._dataArrObj&&this._dataArrObj[t]&&delete this._dataArrObj[t][e]})}},{key:"getRequestMethod",value:function(e){return e&&e.hasOwnProperty("get")&&"function"==typeof e.get?e.get("nol_prefRequestMethod")||e.get("nol_requestMethod"):"GET"}},{key:"nuidOverride",value:function(e,t){return t&&(e=D(e,this._params.nuid,"nuid,OPTOUT")),e}},{key:"optoutOverride",value:function(t){return t&&(t=P(t,e._params.optout+"=")+(this._glcfg.isOptout()?"&"+e._params.optout+"=1":""),t=D(t,e._params.nuid,"nuid,"+this._glcfg.getLsId())),t}},{key:"getEventsFilter",value:function(e){return e.get("nol_eventFilter")||this.l_eventFilter[e.get("nol_playerId")]||{}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),N=0,B=d.maxRetries,U=function e(t){var a=c();if("string"==typeof t&&0!==t.length){var n=a.document.createElement("script");n.type="text/javascript",n.src=function(e,t){var a,n,r=[],i=e.split("&");for(a=0,n=i.length;a<n;a++)0!==i[a].indexOf(t)&&r.push(i[a]);return r.join("&")}(t,"rnd=")+"&rnd="+Math.round(1e6*Math.random()),n.onerror=function(t){var n=t.target.src;a.document.head?a.document.head.removeChild(t.target):a.document.getElementsByTagName("head")[0].removeChild(t.target),N<B&&(N++,m.getInstance().processSetTimeout((function(){e(n)}),5e3))},n.onload=function(e){N=0,a.document.head?a.document.head.removeChild(e.target):a.document.getElementsByTagName("head")[0].removeChild(e.target)},a.document.head?a.document.head.appendChild(n):a.document.getElementsByTagName("head")[0].appendChild(n)}};function Q(e){try{var t=function(e){return{tags:[],eventQueue:e&&e.eventQueue?e.eventQueue:[],tagSize:1,bReInit:!1,debug:c.debugDisabledVal,eventQueueIndex:0}},a=e.glcfg,n=e.global,r=j.getInstance(),i=m.getInstance(),o=d.sdkBuildVersion,s=d.domlessSuffix,l=e.ggcmb,c=a.PLDPR=void 0!==a.PLDPR?a.PLDPR:{sdkVersion:l.sdkvForConfig,BUILDVERSION:a.getBaseBuildVer()+o,baseConfigUrl:"cgi-bin/",addrProtocol:d.webProtocol,dprConfigAPI:d.dprConfigAPI,dprErrorAPI:d.dprErrorAPI,configVersion:a.getConfigVer?a.getConfigVer():300,defaultTimelineSize:d.defaultTimelineSize,functionMap:{"[":{end:"]",count:0},"{":{end:"}",count:0},"<":{end:/\.\d+,\d+\>/g,count:0}},configRegex:{regex:/\|\![\w\W]*?(\!\|)/g,length:2},cmsMapRegex:/[\[\{<\(\}\]>\)]/g,bucketRegex:new RegExp(/(.*?)(_content|_ad|_static)?$/i),dataObj:{},timeOffset:0,currentRetry:0,maxRetry:5,errorWait:5,sendQueue:[],sendInterval:void 0,lsRetryMax:2,sending:!1,sendQueue2:[],debugDisabledVal:"false",configAddr:void 0,cmsMapDictionary:e.cmsMapDictionary||{},l_eventFilter:{},l_serviceFilter:{},WEBSTORAGE:!1,USEBEACON:!1,_id3Map:void 0,sender:{send:function(t,n,i){var o=t,s=-1!==o.url.indexOf("&c62=")?e.removeParam(o.url,"c62=")+"&c62=sendTime,"+(void 0!==n?n:u()/1e3|0):o.url,l="";l=-1!==s.indexOf("prd=metadata")?s:e.removeParam(s,"rnd=")+"&rnd="+Math.round(1e6*Math.random()),i=i||"GET",t&&t.uoo&&(l=r.nuidOverride(l,t.uoo)),a.postMsgAvail&&o.hasOwnProperty("maskRefUrl")&&-1!==o.maskRefUrl&&"true"===o.maskRefUrl?e.sendMaskedPing(l):c.USEBEACON?navigator.sendBeacon(l):e.request(l)},setup:function(e){var t=e.hasOwnProperty("url")?e.url:"",n=e.params||{url:t,uoo:"true"===e.uoo?1:0,errorDelay:1e3*(e.delay||a.PLDPR.errorWait),retry:0,maskRefUrl:e.hasOwnProperty("maskRefUrl")&&String(e.maskRefUrl).length>0?e.maskRefUrl:-1};t&&t.length>0&&this.send(n,e.pingSendTime,e.method)},onError:function(e,t,a){var n=this,r=e.target.src;t&&t.retry<this.maxRetry&&r&&r.length>0&&(t.retry=t.retry+1,t.url=r,m.getInstance().processSetTimeout((function(){n.send(t,null,a)}),t.errorDelay))}},_errorSent:{},ns:e.ns};a.PLDPR.debug=a.PLDPR.debugDisabledVal,a.PLDPR.product=a.PLDPR.product||{};var p=e.namespace;return c.initFromConfig=function(e,r,o){a._listeners.fireEvent("info",{type:"info",msg:"Recieved config response."});try{var l=r||0;if(e&&e.nol_GLOBALS){var d,v,f,g,_,h,P,y,b=u(),O="localhost",L=e.nol_GLOBALS.debugSfcode||"uat-cert",S=e.nol_GLOBALS.nol_appid||"",T=e.nol_GLOBALS.nol_lsid||"",w=e.nol_GLOBALS.nol_emmURL||(e.nol_GLOBALS.nol_tagMap&&e.nol_GLOBALS.nol_tagMap.nol_defaults?e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_emmURL:"")||"",D=e.nol_GLOBALS.enableStaticInIframe&&"true"===e.nol_GLOBALS.enableStaticInIframe.toString().toLowerCase();if(D&&a.browser.isWithinIFrame()&&a.PLDCR.removeListeners(),a&&a.PLDCR&&(a.PLDCR.nol_idleTimeout=parseInt(e.nol_GLOBALS.nol_idleTimeout)||1800),o&&(a.optoutCookie&&"TOTAL"===a.optoutCookie&&"OPTOUT"!==a.localStorageId&&(T="OPTOUT",a._listeners.fireEvent("debug",{type:"debug",msg:'Optout cookie was set but lsid was "'+a.localStorageId+'". Setting lsid to OPTOUT'})),""===T&&("-1"===a.localStorageId?T="999":""===a.localStorageId?T=a.generateGUID():a.localStorageId&&(T=a.localStorageId))),T="999",a._listeners.fireEvent("sendOptOutStatus","OPTOUT"==T),void 0!==e.nol_GLOBALS.nol_maxRetry&&null!==e.nol_GLOBALS.nol_maxRetry&&""!==e.nol_GLOBALS.nol_maxRetry){var E=parseInt(e.nol_GLOBALS.nol_maxRetry);E>-1&&(a.PLDPR.maxRetry=E)}if(e&&e.hasOwnProperty("nol_GLOBALS")){if(l=r||e.nol_GLOBALS.nol_playerId||0,!(v=a._players[l]))return;for(f in O=e.nol_GLOBALS.nol_sfcode||O,a._listeners.fireEvent("debug",{type:"debug",msg:'SDK instance "'+v.name+'" initialized with globals '+JSON.stringify(v.getConfigParams().ggParams)}),v.pauseObj={pauseTime:0,eventPauseTime:0,maxPauseTime:parseInt(e.nol_GLOBALS.nol_pauseTimeout)||1800,cmsPauseTime:parseInt(e.nol_GLOBALS.nol_pauseEventTimeoutPlayhead)||15},v.staticIFrameFlag=D,e.nol_GLOBALS.nol_serverTime=u()/1e3|0,(i&&i.storageGetItem?a.PLDPR.dataObj[l]?a.PLDPR.dataObj[l].nol_serverTime||i.storageGetItem("nol_serverTime"):i.storageGetItem("nol_serverTime")||0:a.PLDPR.dataObj[l]?a.PLDPR.dataObj[l].nol_serverTime:0)===e.nol_GLOBALS.nol_serverTime?a.PLDPR.timeOffset=a.PLDPR.dataObj[l]?a.PLDPR.dataObj[l].nolPriv_serverTimeOffset:e.nol_GLOBALS.nol_serverTime-Math.round(b/1e3):(a.PLDPR.timeOffset=e.nol_GLOBALS.nol_serverTime-Math.round(b/1e3),i&&i.storageSetItem&&i.storageSetItem("nol_serverTime",e.nol_GLOBALS.nol_serverTime)),a.PLDPR.errorWait=e.nol_GLOBALS.nol_errorWait||a.PLDPR.errorWait,d=v.getConfigParams().ggParams||{},a.PLDPR.dataObj[l]=t(a.PLDPR.dataObj[l]),a.PLDPR.dataObj[l].nolPriv_serverTimeOffset=a.PLDPR.timeOffset,a.PLDPR.dataObj&&a.PLDPR.dataObj.hasOwnProperty(l)?a.PLDPR.dataObj[l].nol_nielsenAdSupportFlg=0:a._listeners.fireEvent("error",{type:"error",msg:"Error in initFromConfig. Invalid data object or playerId."}),a.PLDPR.dataObj[l].debug=-1!==L.indexOf(O)&&n&&n.JSON&&0===S.indexOf("T")&&v.getConfigParams().ggParams.nol_sdkDebug||c.debugDisabledVal,a.PLDPR.sendInterval&&(n.clearInterval(a.PLDPR.sendInterval),a.PLDPR.sendInterval=0),e.nol_GLOBALS.nol_sendTimer,d)d.hasOwnProperty(f)&&(a.PLDPR.dataObj[l][f]=d[f]);for(f in e.nol_GLOBALS)e.nol_GLOBALS.hasOwnProperty(f)&&(a.PLDPR.dataObj[l][f]=e.nol_GLOBALS[f]);for(f in a.PLDPR.l_eventFilter[l]=a.PLDPR.dataObj[l].nol_eventFilter||{},a.PLDPR.l_serviceFilter[l]=a.PLDPR.dataObj[l].nol_serviceFilter||{},a.PLDPR._id3Map=a.PLDPR.dataObj[l].nol_id3Map||{},a.PLDPR.cmsMapDictionary[l]=a.PLDPR.cmsMapDictionary[l]||{},a.PLDPR.dataObj[l].nol_clientCMSmap)a.PLDPR.dataObj[l].nol_clientCMSmap.hasOwnProperty(f)&&(h=(_=a.PLDPR.dataObj[l].nol_clientCMSmap[f].toString()||"").replace(a.PLDPR.cmsMapRegex,""),y=_.match(a.PLDPR.cmsMapRegex)||[],P={clientField:h.toString(),encoding:y.join("")},a.PLDPR.cmsMapDictionary[l][f]=P);if(d&&d.hasOwnProperty("nol_override")&&Object.keys(d.nol_override).length>0)for(f in d.nol_override)d.nol_override[f].length>0&&(a.PLDPR.dataObj[l][f]=d.nol_override[f]);e.nol_GLOBALS.hasOwnProperty("nol_maxStaticInstances")&&p.hasOwnProperty("setTotalNumAssetsAllowed")&&p.setTotalNumAssetsAllowed(e.nol_GLOBALS.nol_maxStaticInstances),v.configLoaded=!0,a.PLDPR.dataObj[l].nol_prefProtocol=a.getPrefProtocol(e),a.PLDPR.dataObj[l].nol_playerId=l,a.PLDPR.dataObj[l].nol_nuid=T,a.PLDPR.dataObj[l].nol_lsid=T,a.PLDPR.dataObj[l].nol_bldv=a.PLDPR.BUILDVERSION,a.PLDPR.dataObj[l].nol_sdkv=v.sdkvForConfig+s,a.PLDPR.dataObj[l].nol_assetName=e.nol_GLOBALS.hasOwnProperty("nol_assetName")&&e.nol_GLOBALS.nol_assetName.length>0?e.nol_GLOBALS.nol_assetName:"defChnAsset",a.PLDPR.dataObj[l].nol_sfcode=d.sfcode,a.PLDPR.dataObj[l].nol_dcrsfcode=d.sfcode,a.PLDPR.dataObj[l].nol_apn=d.apn||(e.nol_GLOBALS.hasOwnProperty("nol_apn")&&e.nol_GLOBALS.nol_apn.length>0?e.nol_GLOBALS.nol_apn:""),a.PLDPR.dataObj[l].nol_nmspc="NOLBUNDLE",a.PLDPR.dataObj[l].nol_lstrg="",a.PLDPR.dataObj[l].nol_userSessionId=v.sessionId,a.PLDPR.dataObj[l].nol_pageURLmeta=v.metadataCtrl.pageURL,a.PLDPR.dataObj[l].nol_pageTitle=v.metadataCtrl.pageTitle,!0===v.optout||"true"===a.PLDPR.dataObj[l].nol_useroptout?(a.PLDPR.dataObj[l].nol_useroptout="true",void 0!==a.PLDPR.dataObj[l].nol_deviceId&&""===a.PLDPR.dataObj[l].nol_deviceId||(a.PLDPR.dataObj[l].nol_deviceId="")):a.PLDPR.dataObj[l].nol_useroptout="",a.PLDPR.dataObj[l].nol_deviceId=!0===v.optout||"true"===a.PLDPR.dataObj[l].nol_useroptout?"":void 0!==v.deviceId?v.deviceId:a.PLDPR.dataObj[l].nol_deviceId,a._listeners.fireEvent("debug",{type:"debug",msg:"Cached emm: "+a.EMMURL+"; config emm: "+w}),w=a.evalTemplate(w,a.PLDPR.dataObj[l]),a.PLDPR.dataObj[l].nol_emmURL=w;var I=e.nol_GLOBALS.hasOwnProperty("nol_emmsfcodelist")?e.nol_GLOBALS.nol_emmsfcodelist:[],k=(I=I&&Array.isArray(I)?I.concat(["secure-eu","eu","eu-uat","eu-cert"]):["secure-eu","eu","eu-uat","eu-cert"]).indexOf(a.sfCode.toLowerCase())>-1;w&&k&&(m.getInstance().logDebug("emm URL: ".concat(w)),C(w),a._listeners.fireEvent("info",{type:"info",msg:"Firing EMM link ".concat(w)}))}if(e&&e.hasOwnProperty("nol_TAGS"))for(a.PLDPR.dataObj[l].tagSize=e.nol_TAGS.length,a.PLDPR.dataObj[l].tags=[],a._listeners.fireEvent("debug",{type:"debug",msg:"NIELSEN TAGS EXPECTED TO FIRE:"}),f=0;f<a.PLDPR.dataObj[l].tagSize;f+=1){a._listeners.fireEvent("debug",{type:"debug",msg:String(e.nol_TAGS[f].nol_comment)});var R=new Ke(JSON.parse(JSON.stringify(e.nol_TAGS[f])),a.PLDPR.dataObj,v);a.PLDPR.dataObj[l].tags.push(R)}void 0!==a.enablePlayer&&a.enablePlayer(l,"PLDPR"),a.PLDPR.dataObj[l].bReInit=!1,d.nol_hybridCfg&&n&&n.JSON&&((g=n.document.createElement("script")).text="(function() {if (typeof "+d.nol_hybridCfg+" === 'function'){"+d.nol_hybridCfg+"('"+JSON.stringify(e)+"')}}())",n.document.head?(n.document.head.appendChild(g),n.document.head.removeChild(g)):(n.document.getElementsByTagName("head")[0].appendChild(g),n.document.getElementsByTagName("head")[0].removeChild(g))),a.PLDPR.dataObj[l].forceStreamRegen=!1;var F=a.getSdkvGlobal(a.PLDPR.dataObj[l].nsdkvOverride,"CADENCEOVERRIDE");a.PLDPR.dataObj[l].hasOwnProperty("nsdkvOverride")&&F&&(a.PLDPR.dataObj[l].nol_cadenceOverride||(a.PLDPR.dataObj[l].nol_cadenceOverride=F),a.PLDPR.dataObj[l].nol_cadenceOverrideEnabled=!0),a._listeners.addListener("tick",(function(){v&&v.hasOwnProperty("pauseObj")&&v.pauseObj.hasOwnProperty("pauseTime")&&(!0===v._pauseTimeoutEnabled?v.pauseObj.pauseTime+=1:v.pauseObj.pauseTime=0,v.pauseObj.eventPauseTime+=1)})),a._listeners.fireEvent("flushQueue")}else i&&i.logWarn&&i.logWarn("Warning: CMS config response is not valid. Please ensure NOL global parameter values are correct."),a._listeners.fireEvent("warn",{type:"warn",msg:"Warning in initFromConfig. NOL global parameters are not valid."});return a.PLDPR.dataObj[l]}catch(e){i&&i.logError&&i.logError("Error initializing CMS config response. Please ensure NOL global parameter values are correct. "+e.message),a._listeners.fireEvent("error",{type:"error",msg:"Error in initFromConfig. Error parsing config response. "+e.message})}},c.getCmsMap=function(e){try{if(void 0!==e&&"string"==typeof e||a._listeners.fireEvent("error",{type:"error",msg:"Error in getCmsMap. PlayerID must be passed as string data type."}),a.PLDPR.dataObj&&a.PLDPR.dataObj.hasOwnProperty(e)&&void 0!==a.PLDPR.dataObj[e].nol_clientCMSmap)return a.PLDPR.dataObj[e].nol_clientCMSmap}catch(e){a._listeners.fireEvent("error",{type:"error",msg:"Error in getCmsMap."})}},c.resolveExpression=function(e,t){return t?(t._dataArrObj||(t={_dataArrObj:{content:{0:t}},_settings:t,_currVidType:"content"}),r.extendfData(t),rt(t,e,null,{vidType:"content",silent:!0,noClone:!0})):e},c.init=function(e){var n,r,i=e.getConfigParams()||{},o="",s=i.nol_playerId||0;for(n in a.PLDPR.product=ht({dataFunc:W}),r={pli:{val:s,protect:!0},nmspc:{val:"NOLBUNDLE",protect:!0},sdkv:{val:a.PLDPR.sdkVersion,protect:!0},fmt:{val:"jsonp",protect:!0},apn:{val:"Tester",protect:!1},fbtag:{val:"true",protect:!1},cfgv:{val:a.PLDPR.configVersion,protect:!0},bldv:{val:a.PLDPR.BUILDVERSION,protect:!0},prefprotocol:{val:"https",protect:!1}},e.addListener("ggPM",(function(e){!function(e){var n;if(a.PLDPR.dataObj[e.id]&&a.PLDPR.dataObj[e.id].tags.length===a.PLDPR.dataObj[e.id].tagSize){if(a._listeners.fireEvent("debug",{type:"debug",msg:"pli="+e.id+"&ggpm="+JSON.stringify(e),evtType:e.evtInfo.eventType}),a.PLDPR.dataObj[e.id].debug!==c.debugDisabledVal&&"logging"===a.PLDPR.dataObj[e.id].debug){if((n=a.PLDPR.dataObj[e.id].nol_debugUrl)||(n=a.PLDPR.dataObj[e.id].nol_prefProtocol+"://nielsen.guru/validation/query_string.php?"),a.PLDPR.dataObj[e.id].eventQueue.length>a.PLDPR.dataObj[e.id].eventQueueIndex+1)for(var r=a.PLDPR.dataObj[e.id].eventQueueIndex;r<a.PLDPR.dataObj[e.id].eventQueue.length;r++)q(n+"pli="+e.id+"&ggpm="+JSON.stringify(a.PLDPR.dataObj[e.id].eventQueue[r])),a.PLDPR.dataObj[e.id].eventQueueIndex=r;q(n=n+"pli="+e.id+"&ggpm="+JSON.stringify(e))}e.timeStamp=u();for(var i=0,o=a.PLDPR.dataObj[e.id].tags.length;i<o;i+=1)a.PLDPR.dataObj.hasOwnProperty(e.id)&&a.PLDPR.dataObj[e.id].tags[i].eventListener(e)}else a.PLDPR.dataObj[e.id]&&a.PLDPR.dataObj[e.id].eventQueue||(a.PLDPR.dataObj[e.id]=t(a.PLDPR.dataObj[e.id])),a.PLDPR.dataObj[e.id].eventQueue.push(e);c.product.dtvr&&c.product.dtvr.postQueueGgpm&&c.product.dtvr.postQueueGgpm()}(e)})),e.lsPopulatedInterval=0,e.lsCurrentRetry=0,e.serviceSending={tsv:!1,stn:!1},e.ottStatusObj={},e.oServiceCall={},e.static={started:!1},i.ggParams)!i.ggParams.hasOwnProperty(n)||r[n]&&r[n].protect||0==n.indexOf("nol_")||(r[n]={val:z(i.ggParams[n])});for(n in r)r.hasOwnProperty(n)&&(o=o+(n+"=")+r[n].val+"&");o=o.substr(0,o.length-1)},c.built||(c.built=!0,a.bindPlayers(c,"PLDPR"),a._listeners.fireEvent("flushQueue")),c}catch(e){m.getInstance().logError("Error in PLDPR module. ".concat(e.message))}}function H(e,t){var a,n,r=0===e.PLDPR.addrProtocol.indexOf("https")?"https":"http",i=t.url,o=t.hasOwnProperty("maskRef")?t.maskRef:-1,s=t.method||"GET";if("__sendIt"!==i&&"https"===r&&-1===i.indexOf("https")&&(i=r+i.substr(i.indexOf("://"))),t.prod&&"ocr"===t.prod&&-1!==i.indexOf("&ty=js"))U(i);else if(e.PLDPR.sendInterval||"__sendIt"===i)if(i&&e.PLDPR.sendInterval&&this.sending)this.sendQueue2.push(i);else if("__sendIt"!==i||this.sending)i&&e.PLDPR.sendInterval&&!this.sending&&this.sendQueue.push(i);else{for(this.sending=!0,a=0,n=this.sendQueue.length;a<n;a+=1)e.PLDPR.sender.setup({pingSendTime:ct(t.serverTimeOffset),url:this.sendQueue.shift(),uoo:t.uoo,maskRefUrl:o,method:s});this.sendQueue=this.sendQueue.concat(this.sendQueue2),this.sending=!1,this.sendQueue2=[]}else e.PLDPR.sender.setup({pingSendTime:ct(t.serverTimeOffset),url:i,uoo:t.uoo,maskRefUrl:o,method:s})}function q(e){X().PLDPR.sender.setup({pingSendTime:"undefined",url:e,method:"GET"}),this.logger(e)}function W(e){var t,n=[];try{var r=X();if(e){if("string"==typeof e.param){if(e.param=e.param.trim(),n=e.param.split("_"),-1===(t=e.param.indexOf("nol_"))&&-1===e.param.indexOf("nolPriv_")&&!n.length)return}else n=e.param;var i="";if(Array.isArray(n)&&n.length>2&&t>-1&&("content"===n[n.length-1]||"ad"===n[n.length-1]||"static"===n[n.length-1])){i=n.splice(0,n.length-1).join("_");var o=n[0];"ad"!==o&&"content"!==o||(e.vidType=o)}else i=e.param;var s=e.vidType||e.data._currVidType,l=e.data._currAssetid?String(e.data._currAssetid):"0",d=void 0!==e.data._dataArrObj[s][l]?e.data._dataArrObj[s][l]:e.data._dataArrObj[s][Object.keys(e.data._dataArrObj[s]).splice(-1,1)],c=r.PLDPR.cmsMapDictionary[e.data._settings.nol_playerId]||{},u=c&&c[i]?c[i].clientField:i,p="";if("object"===a(u))p=d;else if("nol_segmentTimeSpent"===u||"nol_cumeTimeSpent"===u||"nol_count"===u){p=W({data:e.data,param:"nol_timeSpentViewing"})[s][u]}else void 0===e.val||null===e.val?void 0!==(p=d&&d.hasOwnProperty(u)?d[u]:r.PLDPR.dataObj[e.data._settings.nol_playerId][u])&&""!==p||void 0!==(p=K(e)||"")&&""!==p||(0===u.indexOf("nol_")?e.param=u:e.param=i,p=K(e)||""):d&&(d[u]=e.val);return p}return null}catch(e){m.getInstance().logError("Error in Data(): "+e.message+" params: "+n),X()._listeners.fireEvent("error",{type:"error",msg:"Error in Data(): "+e.message})}}function z(e){return encodeURIComponent(e).replace("'","%27")}function K(e,t){var n,r=X(),i=e.data._settings,o=e.param;return null==t?void 0===(n=i.hasOwnProperty(o)&&r.PLDPR.dataObj[i.nol_playerId].nol_tagMap.hasOwnProperty(o)&&("object"===a(r.PLDPR.dataObj[i.nol_playerId].nol_tagMap[o])||"array"==typeof r.PLDPR.dataObj[i.nol_playerId].nol_tagMap[o])?r.PLDPR.dataObj[i.nol_playerId].nol_tagMap[o][i[o]]:i.hasOwnProperty("nol_defaults")&&i.nol_defaults.hasOwnProperty(o)?i.nol_defaults[o]:r.PLDPR.dataObj[i.nol_playerId].nol_tagMap.nol_defaults[o]||r.PLDPR.dataObj[i.nol_playerId][o])&&(n=i.hasOwnProperty(o)?i[o]:r.PLDPR.dataObj[i.nol_playerId].nol_tagMap[o]):i.hasOwnProperty("nol_defaults")&&i.nol_defaults.hasOwnProperty(o)?i.nol_defaults[o]=t:i[o]=t,n}function J(e){var t=m.getInstance();function a(e){t.logInfo(e)}function n(e){t.logWarn(e)}function r(e){t.logError(e)}var i=e.glcfg,o=i.PLLOG=i.PLLOG||{},s=i.getBaseBuildVer?i.getBaseBuildVer()+"0":"6.0.00",l={INFO:{info:a},DEBUG:{info:a,debug:function(e){t.logDebug(e)},warn:n,error:r},WARN:{info:a,warn:n},ERROR:{info:a,error:r},CONSOLE:{info:a},TRUE:{info:a},LOGGER:{logger:function(e){t.logDebug(e)}}};return o.init=function(e){if(e&&e.getConfigParams){var t=e.getConfigParams();t.hasOwnProperty("ggParams")&&t.ggParams.hasOwnProperty("nol_sdkDebug")&&function(e){if(e){var t=String(e).toUpperCase();if(l.hasOwnProperty(t))for(var a in l[t]){var n=String(a).toLowerCase();i._listeners.addListenerSingle(n,l[t][n])}}}(t.ggParams.nol_sdkDebug)}},o.built||(o.built=!0,o.BUILDVERSION=s,i.bindPlayers(o,"PLLOG")),o}var Y=!1;function $(e){var t,n,r,i,o,s,l,u,p,m,v={600:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.0",LSID:!0},"600_rc":{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.0.rc",LSID:!0},601:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.1",LSID:!0},"601_rc":{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.0.1.rc",LSID:!0},501:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLCMB:600,PLLOG:600,CONFIG:300,BASEVER:"6.1.0",LSID:!1,FORCEFOCUS:!0,CADENCEOVERRIDE:30},615:{PLVBL:600,PLSIVT:600,PLSTM:600,PLDPR:600,PLDCR:600,PLLOG:600,CONFIG:300,BASEVER:"6.1.5",LSID:!1,FORCEFOCUS:!0,CADENCEOVERRIDE:30}};if(!Y){var f=e||{};if(Y=!0,m=f.NOLBUNDLE.GLCFG||{},i=0,o=30,s=0,l=d.webProtocol+"://"+d.cdnAddress+"/",p={PLDPR:{path:l+"novms/js/2/pldpr"+v[u="600"].PLDPR+".js",status:0,pluginName:"PLDPR"},PLDCR:{path:l+"novms/js/2/pldcr"+v[u].PLDCR+".js",status:0,pluginName:"PLDCR"},PLLOG:{path:l+"novms/js/2/pllog"+v[u].PLLOG+".js",status:0,pluginName:"PLLOG"}},m.gIframe=null,m.gIframeReady=!1,m.thirdPartyData={cookiesEnabled:!0,localStorageEnabled:!0},m.built=!1,m.postMsgAvail=m.postMsgAvail||"function"==typeof f.postMessage,m.availModules=m.availModules||{},m._players=m._players||{},m.id=m.id||"0",m.childGlobal=m.childGlobal||!!f&&f.top!==f.self,m.parentFound=m.parentFound||!1,m.loadChildren=function(e){var t,a=g(void 0!==e?e:u);for(t in p)p.hasOwnProperty(t)&&a.hasOwnProperty(t)&&!m[t]&&_(t,p[t])},m.getBaseBuildVer=function(){var e=g(u);if(e.hasOwnProperty("BASEVER"))return e.BASEVER+"."},m.getConfigVer=function(){var e=g(u);if(e.hasOwnProperty("CONFIG"))return e.CONFIG},m.globalHasFocus=function(){var e=g(undefined.getVersionOverride());return!e||!e.hasOwnProperty("FORCEFOCUS")||f.document&&void 0!==f.document.visibilityState&&"visible"!==f.document.visibilityState?!f.self||!f.self.document||"function"!=typeof f.self.document.hasFocus||f.self.document.hasFocus():e.FORCEFOCUS},m.getSdkvGlobal=function(e,t){if(e&&t){var a=g(e);return!(!a||!a.hasOwnProperty(t))&&a[t]}},m.isValidJson=function(e){var t;try{t=JSON.parse(e)}catch(e){return!1}return"Object"==typeof t},m.getPrefProtocol=function(e){try{return m.userAgent.isIOS()&&m.userAgent.iosVersion().major>=9||0===f.location.protocol.indexOf("https")?"https":e.nol_GLOBALS.hasOwnProperty("nol_prefProtocol")&&-1!==["http","https"].indexOf(e.nol_GLOBALS.nol_prefProtocol)?e.nol_GLOBALS.nol_prefProtocol:e.nol_GLOBALS.nol_tagMap&&e.nol_GLOBALS.nol_tagMap.nol_defaults&&e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol&&-1!==["http","https"].indexOf(e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol)?e.nol_GLOBALS.nol_tagMap.nol_defaults.nol_prefProtocol:"https"}catch(e){return"https"}},m.generateGUID=function(){function e(){var e;do{e=Math.floor(992*Math.random())}while(e>61);return e}for(var t="",a=0;a<29;a++)t+="0123456789abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz".charAt(e());return t+=Math.floor((new Date).getTime()/1e3)},m.evalTemplate=function(e,t,a){if(e&&t){var n={regex:/\|\![\w\W]*?(\!\|)/g,length:2},r=e.match(n.regex);if(r)for(var i=0;i<r.length;i++){var o=r[i].match(/\w+/gi)||"",s=t[o[0]],l=r[i].substr(n.length,r[i].length-2*n.length),d=l.match(/[\{<\(]/g)?l.match(/[\{<\(]/g).reverse():[],c=l.match(/[\}>\)]/g)||[],u=Math.min(d.length,c.length);if(u>0&&s)for(var p=0;p<u;p++)m=d[p],v=c[p],("<"===m&&">"===v||"{"===m&&"}"===v||"("===m&&")"===v)&&(s=h(d[p],l,s,a));o&&o.length>0&&"nol_imrid"!==o[0].toLowerCase()&&(e=e.replace(r[i],s||""))}}var m,v;return e},m.bindPlayers=function(e,t){var a;if(t)for(a in m.availModules[t]=e,m._players)m._players.hasOwnProperty(a)&&1==m._players[a].init&&(m._players[a].modules[t]||(m._players[a][t]=new e.init(m._players[a]),m._players[a].modules[t]=2))},m.enablePlayer=function(e,t){e&&t&&(m._players[e].modules[t]=2)},m.registerListener=function(e,t){t&&(t.addListener(e,(function(t){m._listeners.fireEvent(e,t)})),t.init||(t.init=1,function(e){if(e){var t;for(t in m.availModules)m.availModules.hasOwnProperty(t)&&1==e.init&&(e.modules[t]||(e[t]=new m.availModules[t].init(e),e.modules[t]=1));var a=e.getConfigParams().nol_playerId;m._players[a]=e,m._listeners.addListener("tick",(function(){!function(e){try{if(!e.modules.allModInit){var t=!0,a=g(e.sdkv);for(n in p)if(p.hasOwnProperty(n)&&a.hasOwnProperty(n)&&!m[n]){if("PLLOG"!==n&&2!==e.modules[n]){t=!1;break}}else;t&&(e.modules.allModInit=!0,m._listeners.fireEvent("flushQueue"))}}catch(e){}}(m._players[a])}))}}(t)))},m.updateReceiver=function(e){!function(e){e&&m._listeners.fireEvent(e.eventTrigger,e)}(e)},m._listeners=m._listeners||new function e(){if(!(this instanceof e))return new e;m._listeners={},this.addListener=function(e,t,a,n){var r=a||!1;void 0===m._listeners[e]&&(m._listeners[e]=[]),m._listeners[e].push({cb:t,remove:r,player:n,single:!1})},this.addListenerSingle=function(e,t,a,n){var r,i,o,s=a||!1;void 0===m._listeners[e]&&(m._listeners[e]=[]);var l=!1;for(i=0,o=(r=m._listeners[e]).length;i<o;i++)if(r[i].single){l=!0;break}l||m._listeners[e].push({cb:t,remove:s,player:n,single:!0})},this.fireEvent=function(e,t){if(e){var a,n,r;if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(m._listeners[e.type]instanceof Array){for(n=0,r=(a=m._listeners[e.type]).length;n<r;n++)a[n]&&a[n].cb.call(this,e);for(n=0;n<a.length;n++)a[n]&&a[n].remove&&(!e.target||!a[n].player||e.target&&a[n].player&&(e.target.nol_playerId===a[n].player.id||e.target.id===a[n].player.id))&&(a.splice(n,1),n--)}}},this.removeListener=function(e,t){var a,n,r;if(m._listeners[e]instanceof Array)for(n=0,r=(a=m._listeners[e]).length;n<r;n++)if(a[n]&&a[n].cb===t){a[n].remove=!0;break}}},m.configController={_keys:{cmsKey:"nol_clientCMSmap",cmsMapRegex:/[\[\{<\(\}\]>\)]/g},getGlobal:function(e,t){return e&&t&&t.nol_GLOBALS&&t.nol_GLOBALS[e]||""},cmsMap:function(e,t){var a=this.getGlobal(this._keys.cmsKey,t);return a&&a[e]?a[e].replace(this._keys.cmsMapRegex,"").toString():""}},m.scriptController={inject:function(e,t,n,r){if(e&&document&&"function"==typeof document.createElement){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.async=!0,i.onload=n,i.onerror=r,i.src=e;var o=null;if("script"===(t=t||"")){if((o=document.getElementsByTagName("script"))&&o.length>0)return void(t=o[0].parentNode.insertBefore(i,o[0]))}else if("head"===t){if((o=document.getElementsByTagName("header"))&&o.length>0)return void(t=o[0].appendChild(i))}else if(t&&"string"==typeof t){if((t=document.getElementById(t))&&"function"==typeof t.insertBefore)return void t.parentNode.insertBefore(i,t)}else if(t&&"object"===a(t)&&t.appendChild&&"function"==typeof t.appendChild)return void t.appendChild(i);document.body.appendChild(i)}}},m.init=function(){if(!m.built){try{m.loadChildren(),void 0===t&&(t=f.setInterval((function(e){m._listeners.fireEvent("tick",e)}),1e3)),m.childGlobal&&(i=f.setInterval((function(){!function(){var e=c();e.document&&void 0!==e.document.referrer&&e.document.referrer.length>0&&m.postMsgAvail&&void 0!==e.parent&&void 0!==e.parent.postMessage&&e.parent.postMessage("nolInit",0===e.location.protocol.indexOf("http")?e.document.referrer:"*");o<s?e.clearInterval(i):s+=1}()}),500))}catch(e){}m.built=!0}},f.gg_nol_CallBack)for(n=0,r=f.gg_nol_CallBack.length;n<r;n+=1)f.gg_nol_CallBack[n]&&f.gg_nol_CallBack[n].callBack&&f.gg_nol_CallBack[n].callBack(m)}function g(e){return v[e]||v[u]||{}}function _(e,t){var a=Z.getStaticInstance();a&&e&&t&&a.loadLib(e,t.pluginName,m,(function(){t.status=1}))}function h(e,t,a,n){var r,i;return"<"===e||">"===e?(r=t.match(/\.\d+,\d+\>/g))?(i=r[0].match(/[\d]+/g),a=String(a).substr(i[0],i[1])):a=function(e,t){var a,n,r,i,o="";if(!e||!t)return e;for(i=t.length,n=0,r=e.length;n<r;n++)o+=0==(a=e.charCodeAt(n)^t.charCodeAt(n%i))?e.charAt(n):String.fromCharCode(a);return o}(String(a),n):"("!==e&&")"!==e||(a=encodeURIComponent(a).replace("'","%27")),a}return m}function X(){try{var e=c();return e&&(!e.NOLBUNDLE||e.NOLBUNDLE&&!e.NOLBUNDLE.GLCFG)&&(e.NOLBUNDLE||(e.NOLBUNDLE={}),e.NOLBUNDLE.GLCFG=$(e),e.NOLBUNDLE.GLCFG.init()),e.NOLBUNDLE.GLCFG}catch(e){m.getInstance().logDebug("Error in getGlcfgInstance",e)}}var Z=function(){function e(t){n(this,e),this.funcsProcessor=m.getInstance()}return i(e,[{key:"getPluginClassReference",value:function(e){switch(e){case"PLDPR":return Q;case"PLDCR":return G;case"PLLOG":return J;default:return null}}},{key:"loadLib",value:function(e,t,a,n){try{var r=y(),i=r.libs=r.libs||{},o=this.getPluginClassReference(t);if(null!=e&&"string"==typeof e&&null!=o&&"function"==typeof o){if(i[e])return;i[e]=o({global:a,glcfg:X(),namespace:r,ggcmb:"PLDPR"===e?M.getStaticInstance():function(){},request:"PLDPR"===e?C:function(){},sendMaskedPing:"PLDPR"===e?T:function(){},cmsMapDictionary:"PLDPR"===e?O():function(){},removeParam:"PLDPR"===e?P:function(){}}),i[e]={callbacks:[]},i[e].callbacks.push({func:n,arg:a})}else null==o&&this.initLib(e,a)}catch(e){this.funcsProcessor.logError("ERROR in Load lib: ",e)}}},{key:"registerLib",value:function(e,t){var a=X();try{var n=y(),r=n.libs=n.libs||{};if(r){r.hasOwnProperty(e)||this.initLib(e,a,t);var i=r[e];i.body=t;for(var o=i.callbacks.shift();o;)o.func(i.body(o.arg)),o=i.callbacks.shift()}}catch(e){}}},{key:"initLib",value:function(e,t,a){var n=y(),r=n.libs=n.libs||{};if(r[e]||(r[e]={handle:null,callbacks:[]}),r[e].body=a,r[e].body){var i=r[e].body(t);return t[e]=i,void(r[e].handle=i)}}},{key:"getLib",value:function(e){if(void 0!==e&&"GLCFG"===e)return X();var t=y(),a=t.libs=t.libs||{};return a[e]?a[e].handle:null}}],[{key:"getStaticInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();var ee=function(e,t,a){var n=c();try{a=a||n,e&&a&&a.dispatchEvent(new n.CustomEvent(e,{detail:t}))}catch(e){n&&n._listeners&&n._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to call element.dispatchEvent()."})}},te=function(e){var t=c();try{if(e=e.toString().toLowerCase(),t&&t.location&&t.location.search&&t.location.search.length>0){var a=t.location.search.substr(1).split("&"),n="";if(a.find)n=a.find((function(t){return 0===t.toLowerCase().indexOf(e+"=")}));else for(var r=0,i=a.length;r<i;r++)if(0===a[r].toLowerCase().indexOf(e+"=")){n=a[r];break}if(n){var o=n.split("=");if(o&&o.length>1)return o[1]}}}catch(e){t&&t._listeners&&t._listeners.fireEvent("error",{type:"error",msg:"Browser error attempting to retrieve query string parameter."})}return""},ae=ee,ne=te,re=function(e){var t=m.getInstance();try{var a=e.type,n=e.timestamp;switch(a.toLowerCase()){case"blur":!function(e){y().GLCFG._listeners.fireEvent("blur",e),m.getInstance().logDebug("Handling blur - ".concat(e))}(n);break;case"focus":!function(e){y().GLCFG._listeners.fireEvent("focus",e),m.getInstance().logDebug("Handling focus - ".concat(e))}(n);break;case"appclose":!function(e){y().GLCFG._listeners.fireEvent("appclose",e),m.getInstance().logDebug("Handling appClose - ".concat(e))}(n);break;default:t.logDebug("Unknown event ".concat(a))}}catch(a){t.logDebug("Error in processing event object: ".concat(e," - ").concat(a))}},ie=d.addressPrefix,oe=(d.webProtocol,d.configGlobalVer),se=d.sdkvForConfig,le=d.sdkBuildVersion,de=d.collectionAddress,ce=!1,ue=0,pe=0,me=d.nsdkvOverride,ve=d.sessionIdUrlPrefix,fe=d.sessionIdUrlSuffix,ge=d.domlessSuffix,_e=function(e){e&&e.hasOwnProperty("target")&&(ce="true"===String(e.target).toLowerCase())},he=function(e){if(e&&e.hasOwnProperty("target")&&!isNaN(e.target.elapsed)){var t=M.getStaticInstance().getInstances()||{};for(var a in t)!function(a){var n,r,i,o,s=y();if(void 0!==(n=t[a])&&n.hasOwnProperty("staticPage")&&n.staticPage.hasOwnProperty("evtParams")&&"string"==typeof(r=n.staticPage.evtParams).param1.type&&"static"===r.param1.type.toLowerCase()){if(s&&s.GLCFG&&(i=s.GLCFG.globalHasFocus&&s.GLCFG.globalHasFocus(),o=s.GLCFG.PLDCR&&s.GLCFG.PLDCR.safeFocusOn),i||o||n.staticIFrameFlag)return void n.ggPM("48",e.target.elapsed,"","","");if(!i||document&&document.visibilityState&&"hidden"===document.visibilityState)n.ggPM("flush","0"),e.target.pause(),o&&(s.GLCFG.PLDCR.safeFocusOn=!1)}}(a)}},Pe=function(e,t){try{var n,r,i=function(e,t){if("string"==typeof e&&(e={type:e}),e.target||(e.target=t),!e.type)throw new Error("Event object missing 'type' property.");if(g[e.type]instanceof Array)for(var a=g[e.type],n=0,r=a.length;n<r;n++)a[n].call(S,t)},o=function(e){e&&(e.registerListener("ggPM",S),e._listeners&&(e._listeners.addListener("updateCmbStaticPage",S.handleUpdateOfStatic),e._listeners.addListener("removeCmbAssetId",S.removeAsset),e._listeners.addListener("tick",(function(){ue=Date.now(),pe=Math.ceil((ue-0)/1e3),L=!1,i("globalTick",{time:ue,seconds:pe})})),e._listeners.addListener("dcrHeartbeat",he),e._listeners.addListener("flushQueue",S.emptyQueue),e._listeners.addListener("handleSessionReset",S.handleSessionReset),e._listeners.addListener("flushPauseEventQueue",S.flushPauseEventQueue),e._listeners.addListener("sendOptOutStatus",_e),e._listeners.addListener("error",(function(e){m.getInstance().logError("Error fired"+e.target)}))))},s=function(e,t){n&&n.ggParams&&n.ggParams.nol_sdkDebug&&["debug","info","warn","true"].indexOf(n.ggParams.nol_sdkDebug.toString().toLowerCase())>-1&&m.getInstance().logInfo("Nielsen Log: "+e,t||"")},l=function(e){L||!e||"blur"!==e.type&&"scroll"!==e.type&&"touchstart"!==e.type&&"blur"===e.type||(S.ggPM("flush","0"),L=!0,s("Data flushed on "+e.type+" event"))},d=function(e){},u=c(),v=y(),f=X(),g={},_=[],h=[],P=[],b={},O=String(Date.now())+Math.round(1e4*Math.random()),L=!1,S=t||{};if(S.id=O,S.name=e,S.initialized=!1,S.staticPage={},S.modules={allModInit:!1},S.configLoaded=!1,S.apid="",S.sdkv=oe,S.sdkvForConfig=se,S.useCachedConfig=null!=t,S.sessionId="",S.sivt=null,S.state=null,S._pauseTimeoutEnabled=!1,S.isAdobe=!1,t){if(t.q){var T,w=null;for(T=0;T<t.q.length;T++)(w=t.q[T])&&w.length>0&&_.push({eventType:w[0],param1:w.length>1?w[1]:void 0,param2:w.length>2?w[2]:void 0,param3:w.length>3?w[3]:void 0,param4:w.length>4?w[4]:void 0});delete t.q}else t.getEventQue&&(_=t.getEventQue());h=t.te||[]}var D={_queueEventLog:!1,_eventLog:[],init:function(){try{var e=ne("nol_eventHookDelay");if(D._queueEventLog=!1,e){var t=parseInt(e);"NaN"!==t.toString()&&(D._queueEventLog=!0,m.getInstance().processSetTimeout((function(){D._queueEventLog=!1}),1e3*(t<=20?t:20)))}}catch(e){D._queueEventLog=!1}},trigger:function(e,t){try{if(t){var a=JSON.parse(JSON.stringify(t));a.name=e.name,a.sdkv=se,D._queueEventLog?D._eventLog.push(a):D._eventLog&&D._eventLog.length>0&&(D._eventLog=[])}}catch(e){}}},E={metadataURL:"",metadataPing:"",pageURL:"",pageTitle:"",hasMetaPingFired:!1,_isWithinIFrame:function(){try{return u.self!=u.top}catch(e){return!0}},_isWithinFriendlyIFrame:function(){try{return!!(u&&u.top&&u.top.document&&u.top.document.domain)&&!!u.top.document}catch(e){return!1}},_isReferrerAvailable:function(){try{return!(!u.document||!u.document.referrer)&&""!==u.document.referrer}catch(e){return!1}},evalPageData:function(){},handleMetadataPingReset:function(){this.hasMetaPingFired&&(this.hasMetaPingFired=!1)}},I=(S.name,function(e,t){});return S.metadataCtrl=E,S.getOptOutStatus=function(){return ce},S.getId=function(){return O},S.GetName=function(){return S.name},S.Initialized=function(e){if(void 0===e)return S.initialized;S.initialized=e},S.getPauseQueueCount=function(){return Object&&Object.keys?Object.keys(b).length:0},S.disablePauseTimeout=function(){S._pauseTimeoutEnabled&&(S._pauseTimeoutEnabled=!1,s("Player "+S.id+" pause timeout disabled"))},S.enablePauseTimeout=function(){S._pauseTimeoutEnabled||(S._pauseTimeoutEnabled=!0,s("Player "+S.id+" pause timeout enabled"))},S.removeAsset=function(e){void 0!==e&&e.target.param1.hasOwnProperty("assetid")&&(S.staticPage={})},S.handleUpdateOfStatic=function(e){if(e&&e.target){var t=e.target.evtInfo;if(v.GLCFG&&v.GLCFG.PLDCR&&void 0!==t&&t.param1.hasOwnProperty("assetid")&&S.getId()===e.target.plid){var a=v.GLCFG.PLDCR.latestDcrTick();0!==Object.keys(S.staticPage).length&&S.staticPage.hasOwnProperty("id")&&S.staticPage.id===t.param1.assetid&&S.staticPage.hasOwnProperty("lastTimeStamp")?S.staticPage.lastTimeStamp=a:S.staticPage={id:t.param1.assetid,evtParams:t,startTimeStamp:a,lastTimeStamp:a}}}},S.addListener=function(e,t){t&&(void 0===g[e]&&(g[e]=[]),g[e].push(t))},S.removeListener=function(e,t){if(S._listeners[e]instanceof Array)for(var a=g[e],n=0,r=a.length;n<r;n++)if(a[n]===t){a.splice(n,1);break}},S.handleSessionReset=function(e){if(e&&e.target&&e.target.hasOwnProperty("plid")&&O===e.target.plid&&e.target.hasOwnProperty("passedFdata")&&e.target.passedFdata.hasOwnProperty("_dataArrObj")&&e.target.passedFdata._dataArrObj){var t={plid:e.target.plid,fData:e.target.passedFdata._dataArrObj,content:{},ad:{},err:0};if(0===function(e){try{var t="Error in retrieveMeta";if(e&&e.hasOwnProperty("fData")&&e.hasOwnProperty("ad")&&e.hasOwnProperty("content")&&e.hasOwnProperty("plid")){var n=function(e){try{if(!e||!e.hasOwnProperty("cmsMap"))return[];var t=[];for(var a in e.cmsMap)e.cmsMap.hasOwnProperty(a)&&-1!==e.cmsMap[a].indexOf("nol_")&&t.push(e.cmsMap[a].replace(/[{(\[\])}]/g,""));return t}catch(e){}}({cmsMap:v.GLCFG.PLDPR.getCmsMap(e.plid)});for(var r in e.fData)if(e.fData.hasOwnProperty(r)&&"count"!==r){var i=e.fData[r][Object.keys(e.fData[r]).splice(-1,1)];if(null!=i&&"object"===a(i))for(var o in i){var s=String(o);-1!==s.indexOf("nol_")&&-1===n.indexOf(s)||(e[r][o]=i[o])}}return e}return e&&e.hasOwnProperty("err")?(e.err=t+": Missing passedFdata, Ad, content or static properties",e):{err:t}}catch(e){}}(t).err&&e.target.passedFdata.hasOwnProperty("_currVidType")){var n=e.target.passedFdata._currVidType,r=Object.keys(t.content).length>0,i=Object.keys(t.ad).length>0;(r||i)&&("sessionreset"!==e.target.passedFdata.get("nolPriv_prevEventState")&&S.ggPM("57","1","sessionReset","",""),r&&!b.hasOwnProperty("content")&&(b.content={evt:"pauseloadmeta",meta:t.content,plid:e.target.plid}),"ad"===n&&i&&!b.hasOwnProperty("ad")&&(b.ad={evt:"pauseloadmeta",meta:t.ad,plid:e.target.plid}))}}S._listeners&&S._listeners.fireEvent&&S._listeners.fireEvent("debug",{type:"debug",msg:"Fired handleSessionReset from ggcmb."})},S.flushPauseEventQueue=function(){if(!(Object.keys(b).length<=0)){if(S.modules.PLDPR){var e;for(e in b)i("ggPM",{evtInfo:{eventType:b[e].evt,param1:b[e].meta},id:O});b={}}S._listeners&&S._listeners.fireEvent&&S._listeners.fireEvent("debug",{type:"debug",msg:"Fired flushPauseEventQueue from ggcmb."})}},S.cloneObj=function(e){return e&&"object"===a(e)?JSON.parse(JSON.stringify(e)):e},S.ggPM=function(e,t,a,n,r){if(S.initialized)if(null!=e&&""!==e){var o={};if(o.eventType=e,o.param1=S.cloneObj(t),o.param2=S.cloneObj(a),o.param3=S.cloneObj(n),o.param4=S.cloneObj(r),!S.modules.allModInit||2!=S.modules.PLCMB&&2!=S.modules.PLDPR)_.push(o);else{S.emptyQueue();var s=JSON.parse(JSON.stringify(o));i("ggPM",{evtInfo:o,id:O}),D.trigger(S,s)}}else v&&v.GLCFG&&v.GLCFG._listeners&&v.GLCFG._listeners.fireEvent("sendError",{data:{type:17,msg:"Error in ggPM() - Missing event type param in ggPM"},id:O,timeStamp:Date.now()})},S.trackEvent=function(e,t,n){if(e&&"object"===a(e)){if(!S.initialized||!S.state)return;if(S.modules.allModInit&&S.configLoaded&&2==S.modules.PLDPR){if(!(e=Array.isArray(h)&&h.length>0?(t||h.push(S.cloneObj(e)),h.splice(0,1)[0]||{}):e))return;S.state.transition(e,(function(e,t,a,n,r){var o={inferred:!0};o.eventType=e,o.param1=S.cloneObj(t),o.param2=S.cloneObj(a),o.param3=S.cloneObj(n),o.param4=S.cloneObj(r);var s=JSON.parse(JSON.stringify(o));i("ggPM",{evtInfo:o,id:O}),D.trigger(S,s)})),D.trigger(S,{eventType:"trackEvent",param1:e})}else h.push(S.cloneObj(e))}else v&&v.GLCFG&&v.GLCFG._listeners&&v.GLCFG._listeners.fireEvent("sendError",{data:{type:17,msg:"Error in trackEvent() - Missing trackEvent metadata object"},id:O,timeStamp:Date.now()})},S.getConfigParams=function(){return n},S.emptyQueue=function(){if(!(_.length<=0&&h.length<=0)&&S.modules.allModInit&&S.configLoaded&&(S.modules.PLCMB||S.modules.PLDPR)){for(var e=0;e<_.length;e++){var t=JSON.parse(JSON.stringify(_[e]));i("ggPM",{evtInfo:_[e],id:O}),D.trigger(S,t)}for(_=[];h.length>0;)h[0]&&S.trackEvent(h[0],!0)}},S.getContainer=function(){return r},S.getClientConfig=function(){return v.configs?v.configs[S.apid]:null},S.getBaseDomain=function(e){return e.nol_GLOBALS&&void 0!==e.nol_GLOBALS.enableCookielessDomain&&"true"===e.nol_GLOBALS.enableCookielessDomain.toString().toLowerCase()?".nmrodam.com/":".imrworldwide.com/"},S.modifySddParam=function(e){if(e&&e.nol_GLOBALS&&e.nol_GLOBALS.enableSDD&&"true"===e.nol_GLOBALS.enableSDD&&e.nol_GLOBALS.nol_tagMap&&e.nol_GLOBALS.nol_tagMap.nol_url){for(var t=/(sdd=)[^&]*/,a=e.nol_GLOBALS.nol_tagMap.nol_url,n=0;n<a.length;n++)a[n].match(t)&&(a[n]=a[n].replace(t,"$1|![(nol_staticIntervalTimeElapsed)]!|"));e.nol_GLOBALS.nol_tagMap.nol_url=a}return e},S.ggInitialize=function(e,t,i,l,d,c){if(S.initialized)return new Promise((function(e,t){e(S)}));D.init();var u,g,_="us";if(r=c,n={ggParams:e,uid:i,oldFlashDetect:l,detectBrowser:d,nol_playerId:O},a(e)==a(String())){for(u=f.loadXmlString("<vi>"+e+"</vi>").firstChild.firstChild,g=0,e={};u&&void 0!==u&&g<20;)null!==u.firstChild&&(e[u.nodeName]=u.firstChild.nodeValue),u=u.nextSibling,g++;n.ggParams=e}var h=JSON.parse(JSON.stringify(n.ggParams));delete h.apid,delete h.sfcode,delete h.nsdkv,delete h.nol_sdkDebug,delete h.optout,n.ggParams.nol_sdkDebug=ne("nol_sdkDebug")||n.ggParams.nol_sdkDebug,S.Initialized(!0),S.apid=n.ggParams.apid,S.deviceId="true"==S.optout?"":e.deviceId;var y=S.getClientConfig(),b=S.getBaseDomain(y);y=S.modifySddParam(y),oe=(e.nsdkv?e.nsdkv.toString():"")||oe,me=(e.nsdkvOverride?e.nsdkvOverride.toString():"")||me,_=e.sfcode||_;e.coreaddress?e.coreaddress:p(b);se=e.sdkconfigver||se,S.nsdkvOverride=n.ggParams.nsdkvOverride,S.sdkv=oe,S.sdkvForConfig=S.useCachedConfig&&S.sdkv&&3===S.sdkv.length?"bj."+S.sdkv[0]+"."+S.sdkv[1]+"."+S.sdkv[2]:se,de=v.GLCFG.getPrefProtocol(y)+":"+(e.coreaddress?ie+_:"//secure-"+_)+b;var L=n&&n.ggParams,T=L.optout,w=L.nol_sdkDebug,k=L.apid,R=(L.enableFpid,y&&y.nol_GLOBALS),F=R.nol_useroptout,A=R.nol_xorSeed,M=R.nol_dfltAppid,x=(R.enableCookielessDomain,R.enableFpid,R.nol_fpid_ttl,R.nol_emmsfcodelist,R.nol_tagMap.nol_defaults),V=void 0!==F&&"true"===F.toString().toLowerCase()||void 0!==T&&["true","1","t","y","yes"].indexOf(T.toString().toLowerCase())>-1;try{S.optout=V}catch(e){}S.state=f.PLSTM?new f.PLSTM.stateMachine(S.id,y):null,function(){var t=Z.getStaticInstance();S.sessionId=v.GLCFG&&v.GLCFG.generateGUID?v.GLCFG.generateGUID():S.id;var a=y&&y.nol_GLOBALS,n=(a.syncPingFlagList,a.nol_appid,a.nol_metadataURL);void 0!==w&&["debug","info","warn","true"].indexOf(w.toString().toLowerCase()),n&&(E.metadataURL=n);var r={nol_prefProtocol:v.GLCFG.getPrefProtocol(y),nol_sfcode:_,nol_userSessionId:S.sessionId,nol_appid:y.nol_GLOBALS.nol_appid,nol_deviceId:"true"==S.optout?"":e.deviceId,nol_sdkDelimiter:y.nol_GLOBALS.nol_sdkDelimiter,nol_sdkv:S.sdkvForConfig+ge,nol_bldv:v.GLCFG.getBaseBuildVer()+le,nol_useroptout:S.optout?"true":""},i=x?x.nol_sessionURL.replace("&retry=|![nol_retry]!|",""):de+ve+(M||k)+fe;if(i=v.GLCFG.evalTemplate(i,r,A),C(i),t.getLib("GLCFG")){if(v.GLCFG&&(v.GLCFG.sfCode=_,o(t.getLib("GLCFG")),v.GLCFG.loadChildren(S.sdkv),v.GLCFG.PLDPR)){if(v.GLCFG.PLDPR.initFromConfig(y,S.id,!1),P.length)for(var l=0;l<P.length;l++)v.GLCFG._listeners.fireEvent("sendError",{data:P[l],id:O,timeStamp:Date.now()});f.PLSIVT&&(S.sivt=new f.PLSIVT(S))}}else{!function(e,t){s("Firing ping "+e.url);var a=m.getInstance();if(void 0!==e&&(!e||e.hasOwnProperty("url")&&0!==e.url.length)&&e.hasOwnProperty("retryDelay")&&e.hasOwnProperty("currRetry")&&e.hasOwnProperty("maxRetry")){var n={requestUrl:function(){var a=this;try{++e.currRetry>e.maxRetry?(a.logErr("maxRetry reached"),t&&t()):a.sendUrlRequest(e.url)}catch(e){a.logErr("Error in fireToUrl requestUrl: "+e),t&&t()}},sendUrlRequest:function(n){var r=this;try{if(void 0===n)return;a.fetchUrl(n,{method:"GET",cache:"no-cache",credentials:"include",mode:"no-cors"}).then((function(e){e.status>=200&&e.status<300?(t&&t(),a.logDebug("Success making fetch to ".concat(n))):r.requestUrl()})).catch((function(t){r.logErr("Error in fireToUrl sendUrlRequest: "+t),a.processSetTimeout((function(){r.requestUrl()}),e.retryDelay)}))}catch(e){r.logErr("Error in fireToUrl sendUrlRequest: "+e),t&&t()}},logErr:function(e){e&&a&&a.logError("Error: ",e)}};n.requestUrl()}}({url:i,currRetry:-1,maxRetry:5,retryDelay:1e3});var d=X();o(d)}new Promise(I)}()},S.isViewable=function(){return!1},S.processEvent=function(e){var t=e.type,a=e.timestamp;m.getInstance().logDebug("Process ".concat(t," at ").concat(a)),re({type:t,timestamp:a})},!u||!u.GLCFG||u.GLCFG.flushEvent&&u.GLCFG.focusEvent||(u.GLCFG.flushEvent=l,u.GLCFG.focusEvent=d),v.GLCFG._listeners.addListener("blur",(function(e){l(e)})),v.GLCFG._listeners.addListener("focus",(function(e){})),v.GLCFG._listeners.addListener("appclose",(function(e){S.ggPM("end","0"),l(e)})),S}catch(e){m.getInstance().logError("Error inside CMB: ".concat(e))}},ye=function(){function e(){n(this,e),o(this,"_videoController",{checkRewind:function(e,t){if(e&&null!=t&&"stream"!==W({data:e,param:"nol_cadence"})&&"impression"!==W({data:e,param:"nol_cadence"})){var a=Math.floor(b(t,"num")),n=j.getInstance().state.position.current(e);return{match:a-n<0,currentPos:a,previousPos:n}}return!1},checkForward:function(e,t){if(e&&null!=t&&"stream"!==W({data:e,param:"nol_cadence"})&&"impression"!==W({data:e,param:"nol_cadence"})){var a=j.getInstance(),n=Math.floor(b(t,"num")),r=a.state.position.current(e),i=a.state.timeStamp.current(e),o=b(W({data:e,param:"nol_cmsIntrvlGp"}),"num")||2,s=Math.ceil(u()/1e3-i)||1;if(0==r&&n>86400&&"nol_cmsoffset"===a.localTimer(e)){var l=Math.round(u()/1e3).toString().substr(0,t.toString().length);l&&(r=parseInt(l))}var d=n-r;return{match:d>o&&d>Math.ceil(1.5*s),currentPos:n,previousPos:r}}return!1}}),o(this,"_controller",{inferEvent:function(e,t,a,n,r){var i=null,o=j.getInstance(),s=M.getStaticInstance(),l=be.getInstance();try{if(i={event:"event_"+e,curPos:o.state.position.current(t),prevPos:null,timestamp:n},e&&t)switch(e.toLowerCase()){case"3":case"15":case"loadmetadata":case"pauseloadmeta":var d=o.asset.parse(t,r),c=o.state.asset.current(t),u=o.state.asset.previous(t),p=o.state.type.current(t),m=o.type.parse(t,r),v=o.state.asset.current(t,m);if(i.event=this.events.load,i.assetId=d,i.contentType=m,o.state&&o.state.status&&o.state.status.current(t,m)==o.states.paused&&(c==d&&null!==d||p!==m)){i.event=this.events.resume,i.assetId=d,i.contentType=m,i.curPos="{{nextTick}}";break}if(v!=d||o.state&&o.state.status&&o.state.status.current(t,m)===o.states.stopped&&u==d&&null!==d||null===c){i.event=this.events.play,i.curPos="{{nextTick}}";break}break;case"5":case"play":i.event="event_play";break;case"7":case"stop":i.event="event_stop";break;case"57":case"end":case"oncomplete":i.event=this.events.stop;break;case"49":case"setplayheadposition":case"playheadposition":if(a>-1){var f=this._videoController.checkRewind(t,a);if(f.match){i.event=this.events.rewind,i.curPos=f.currentPos,i.prevPos=f.previousPos,i.p1=i.prevPos-i.curPos;break}if(-1===l.get(t).indexOf("{{nextTick}}")){var g=this._videoController.checkForward(t,a);if(g.match){i.event=this.events.forward,i.curPos=g.currentPos,i.prevPos=g.previousPos,i.p1=i.curPos-i.prevPos;break}}if(o.state.status.current(t)===o.states.paused){i.event=this.events.resume,i.assetId=o.state.asset.current(t),i.contentType=o.type.current(t),i.curPos=a;break}i.event=this.events.playhead,i.curPos=a}break;case"55":var _=W({data:t,param:W({data:t,param:"nol_timer"})})||W({data:t,param:"nol_fdoffset"});"daypart"===W({data:t,param:"nol_cadence"})&&(_=(_=b(_,"num"))+W({data:t,param:"nol_timer"})=="nol_pcoffset"?b(W({data:t,param:"nol_pcTimeCode"}),"num"):b(W({data:t,param:"nol_fdTimeCode"}),"num")),i.event=this.events.playhead;break;case"9":case"mute":i.event=this.events.mute,i.p1=a}}catch(t){s._listeners.fireEvent("error",{type:"error",msg:"Error in eventsController. Error inferring event - "+e})}return i}}),this.events={load:"LOAD",play:"PLAY",pause:"PAUSE",stop:"STOP",resume:"RESUME",rewind:"REWIND",forward:"FORWARD",playhead:"PLAYHEAD",mute:"MUTE",unmute:"UNMUTE"},this.inferEvent=this._controller.inferEvent}return i(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),be=function(){function e(){var t=this;n(this,e),o(this,"_controller",{_playerController:j.getInstance(),get:function(e,a){var n="";return e&&(n=W({data:e,param:t._key,vidType:a||e._currVidType})),n},set:function(e,a,n){return e&&W({data:e,param:t._key,val:a,vidType:n||e._currVidType}),e},clear:function(e){e&&(W({data:e,param:t._key,val:"",vidType:"ad"}),W({data:e,param:t._key,val:"",vidType:"content"}))},clone:function(e){try{return{content:t.get(e,"content"),ad:t.get(e,"ad")}}catch(e){return null}},bind:function(e,a){try{if(e&&a)for(var n in a)t.set(e,a[n],n)}catch(e){}},append:function(e,a){if(e&&a){var n=t.get(e),r=t._controller.delimiter(e),i=t._controller.parseEventData(a);t.set(e,n?[n,i].join(r):i)}},delimiter:function(e){return e?(t._cache.delimiter||(t._cache.delimiter=W({data:e,param:t._delimiterKey})),t._cache.delimiter):""},isEnabled:function(e){return!!e&&"true"===W({data:e,param:t._enabledKey})},isEventEnabled:function(e,a){if(a&&e){var n=t._controller.lookupEvent(e.toLowerCase());if(n)return t._controller.eventsList(a).indexOf(n.name)>-1}return!1},eventsList:function(e){if(e){if(!t._cache.eventsList||0==t._cache.eventsList.length){var a=W({data:e,param:t._eventsKey});a&&(t._cache.eventsList=a.split(","))}return t._cache.eventsList}},eventDictionary:function(){return{play:{name:"play",abbrv:"PL"},pause:{name:"pause",abbrv:"PU"},rewind:{name:"rewind",abbrv:"RW"},forward:{name:"forward",abbrv:"FW"},stop:{name:"stop",abbrv:"ST"},resume:{name:"resume",abbrv:"RE"},mute:{name:"mute",abbrv:"MT"}}},clearCache:function(){t._cache.delimiter="",t._cache.eventsList=[]},lookupEvent:function(e){if(e){var a=t._controller.eventDictionary();if(a)return a[e.toLowerCase()]}return null},parseEventData:function(e){var a="";if(e){var n=t._controller.lookupEvent(e.event);if(n){var r=[n.abbrv,e.timestamp,e.curPos];void 0!==e.prevPos&&null!==e.prevPos&&e.curPos!=e.prevPos&&r.push(e.prevPos),void 0!==e.p1&&null!==e.p1&&r.push(e.p1),a=r.join(t._valueDelimiter)}}return a},handleEvent:function(e,a){e&&a&&t.isEventEnabled(a.event,e)&&t.append(e,a)},setNextTick:function(e,a,n){try{var r=t.get(e,n);if(r&&r.indexOf("{{nextTick}}")>-1)if(a&&a.event===t._eventsController.events.playhead)e=t.set(e,r.replace(/{{nextTick}}/gi,1==a.curPos?"0":a.curPos),n);else{var i="0";if(t._controller._playerController&&t._controller._playerController.state&&t._controller._playerController.state.position&&t._controller._playerController.state.position.current&&t._controller._playerController.state.position.current(e,n))i=t._controller._playerController.state.position.current(e,n)||"0";e=t.set(e,r.replace(/{{nextTick}}/gi,i),n)}return e}catch(e){}},preProcess:function(e,a){try{e&&a&&a.event&&a.event!==t._eventsController.events.play&&-1===a.event.indexOf("event_")&&(t.setNextTick(e,a),a.event===t._eventsController.events.stop&&t._controller._playerController&&t._controller._playerController.type&&"content"!==t._controller._playerController.type.current(e)&&t.setNextTick(e,a,"content"),t._controller.handleEvent(e,a))}catch(e){}},postProcess:function(e,a){try{e&&a&&a.event&&a.event===t._eventsController.events.play&&t._controller.handleEvent(e,a)}catch(e){}}}),this._key="nol_eventData",this._delimiterKey="nol_eventDataDelimiter",this._eventsKey="nol_eventDataEvents",this._enabledKey="nol_eventDataEnabled",this._valueDelimiter=":",this._cache={delimiter:"",eventsList:[]},this.get=this._controller.get,this.set=this._controller.set,this.clone=this._controller.clone,this.bind=this._controller.bind,this.clear=this._controller.clear,this.append=this._controller.append,this.isEnabled=this._controller.isEnabled,this.isEventEnabled=this._controller.isEventEnabled,this.preProcess=this._controller.preProcess,this.postProcess=this._controller.postProcess,this.setNextTick=this._controller.setNextTick,this._eventsController=ye.getInstance()}return i(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Oe={},Le={},Se={},Te=5,Ce=null,we=null,De=d.baseConfigUrlBucket,Ee=d.dprErrorAPI;function Ie(e){var t,a,n=null,r="content"==e._currVidType?b(W({data:e,param:"nol_chnlCountThrshld"}),"num")||Te:b(W({data:e,param:"nol_staticCountThrshld"}),"num")||Te,i=e._dataArrObj[e._currVidType],o=0,s=e._dataArrObj.count;if(!e._dataArrObj[e._currVidType].hasOwnProperty(e._currAssetid)){if(s[e._currVidType]>=r){for(a in i)if(i.hasOwnProperty(a)){if((o=i[a].nolPriv_priority)<=0){t=a;break}(null===n||n>o)&&(n=o,t=a)}i.hasOwnProperty(t)&&(delete i[t],s[e._currVidType]--)}e._dataArrObj[e._currVidType][e._currAssetid]={nolPriv_priority:0},s[e._currVidType]++}}function ke(e,t,a){var n,r,i=j.getInstance(),o={},s=0,l=i.getEventsFilter(e);if(W({data:e,param:"nol_playerId"})===t.target.nol_playerId){for(r in t.target)t.target.hasOwnProperty(r)&&(W({data:e,param:r,val:t.target[r]}),o[r]=t.target[r]);var d=i.findPlayer(e);if(d){var c=void 0!==d.oServiceCall[a.service]&&d.oServiceCall[a.service].hasOwnProperty("status")?d.oServiceCall[a.service].status:"undefined";d.oServiceCall[a.service]={status:"complete",prevStatus:c,station:a.key,data:o},d.serviceSending[a.service]=!1}var u=e.get("nol_serviceFilter");if(He(e,u?u[a.service]:l),"true"===W({data:e,param:"nol_disabled"}))return;e.serviceFlag[a.service].need&&(W({data:e,param:"nol_davState",val:"1"}),e.serviceFlag[a.service].need=!1,t.target.hasOwnProperty("nol_fdTimeCode")&&"daypart"===W({data:e,param:"nol_cadence"})&&(s=b(t.target.nol_fdTimeCode,"num"),n=b(W({data:e,param:"nol_queueTime"}),"num"),W({data:e,param:"nol_queueTime",val:n+s})),ft(W({data:e,param:"nol_queueTime"}),e))}}function Re(e,t){var a=L(),n=X();try{var r=W({data:e,param:"nol_playerId"});a&&a.hasOwnProperty(r)&&(!a[r].hasOwnProperty("nol_sessionId")||a[r].hasOwnProperty("forceStreamRegen")&&!0===a[r].forceStreamRegen)&&(t=t||n.generateGUID(),a[r].nol_sessionId=t,a[r].forceStreamRegen=!1)}catch(e){n._listeners.fireEvent("error",{type:"error",msg:"Error in calcStreamId - "+e.message})}}function Fe(e){var t=X();try{var a=W({data:e,param:"nol_playerId"});if(a&&t._players&&t._players.hasOwnProperty(a)){var n,r=t._players[a];if(r&&Object.keys(r.ottStatusObj).length>0)for(n in r.ottStatusObj)W({data:e,param:n,val:r.ottStatusObj[n],vidType:"content"})}}catch(e){t._listeners.fireEvent("error",{type:"error",msg:"Error in populateOttStatus"+e})}}function Ae(e,t,a,n,r){try{var i=j.getInstance();i.extendfData(e);var o,s=e.get("nol_useroptout"),l="",d="nol_minutes, nol_tagPresence, nol_pingCount, nol_currSeg, nol_segmentTimeSpent, nol_cumeTimeSpent, nol_count",c=W({data:e,param:{}});if(Ie(e),Oe=i.getEventsFilter(e),"ad"===e._currVidType.toLowerCase()&&(l="st,a",W({data:e,param:"nol_currSeg",val:"0"})),""===W({data:e,param:"nol_errorURL"})){var u=M.getStaticInstance();W({data:e,param:"nol_errorURL",val:(u.getConfigAddress&&void 0!==u.getConfigAddress()?u.getConfigAddress():u.getAddress())+De+Ee+"?message=|![nol_errorMessage]!|"})}if("loadMetadata"===t)for(o in c)c.hasOwnProperty(o)&&-1===d.indexOf(o)&&W({data:e,param:o,val:K({data:e,param:o})||""});for(o in a)a.hasOwnProperty(o)&&W({data:e,param:String(o),val:String(a[o])});if(e.set("nol_useroptout",s),W({data:e,param:"nolPriv_sendData",val:!0}),W({data:e,param:"nol_davState",val:"0"}),W({data:e,param:"nol_highWM",val:"0"}),W({data:e,param:"nol_iagData",val:""}),W({data:e,param:"nol_disabled",val:"false"}),W({data:e,param:"nol_sendQual",val:K({data:e,param:"nol_sendQual"})||""}),W({data:e,param:"nolPriv_assetid",val:""}),e.set("nolPriv_prevEvent",""),"S"===K({data:e,param:"nol_segmentPrefix"})&&W({data:e,param:"nol_segmentPrefix",val:"S"}),W({data:e,param:"nol_c3"})||W({data:e,param:"nol_c3",val:l}),!r){"content"===e._currVidType.toLowerCase()&&Re(e),W({data:e,param:"nol_applyViewInc",val:"1"}),(!W({data:e,param:"nol_minutes"})||"daypart"!==W({data:e,param:"nol_cadence"})&&"dcrstatic"!==W({data:e,param:"nol_product"})||"dcrstatic"===W({data:e,param:"nol_product"})&&"stream"===W({data:e,param:"nol_cadence"}))&&(mt(e),W({data:e,param:"nol_pingCount",val:0}));var p=W({data:e,param:"nol_adLoadType",vidType:"content"});""!==p&&null!=p&&He(e,Oe.onAdLoadFlag),Fe(e),n&&n.resetViewability&&n.resetViewability(e)}}catch(e){m.getInstance().logError("Error in init",e)}}function Me(e,t){X();var a=L();a[t].bReInit||(a[t].bReInit=!0,a[t].eventQueue=[],e&&a[t].eventQueue.push(e),U(Ce))}function xe(e,t,a){X(),(t&&!0===t.flush||!("dcrstatic"===W({data:e,param:"nol_product"})&&"stream"!==W({data:e,param:"nol_cadence"})||e.isProductOf("vrivideo")))&&("content"===W({data:e,param:"nol_ac"})&&"interval"===e.get("nol_cadence")&&W({data:e,param:"nol_segmentTimeSpent"})>0||"streamduration"===W({data:e,param:"nol_cadence"})&&e.get("nol_segmentTimeSpent","ad")>0||"id3"===W({data:e,param:"nol_product"})&&W({data:e,param:"nol_id3Data"})||"dcrstatic"===W({data:e,param:"nol_product"})&&"stream"===W({data:e,param:"nol_cadence"})||"postroll"===W({data:e,param:"nol_vidtype"})&&"interval"===W({data:e,param:"nol_cadence"})||t&&!0===t.flush&&e.isProductOf("dcrvideo")&&"interval"===e.get("nol_cadence")&&e.get("nol_segmentTimeSpent")>0||t&&!0===t.flush&&e.isProductOf("dcrvideo")&&"streamduration"===e.get("nol_cadence")&&"ad"===e.get("nol_ac")&&e.get("nol_segmentTimeSpent","ad")>0||t&&!0===t.flush&&e.isProductOf("dcrstatic")&&"interval"===e.get("nol_cadence")&&e.get("nol_segmentTimeSpent","static")>0)&&("content"===W({data:e,param:"nol_ac"})||t&&!0===t.save?ot(e,{save:!0},a&&a.onPingFired?a.onPingFired:null):ot(e,null,a&&a.onPingFired?a.onPingFired:null),W({data:e,param:"nolPriv_now",val:0}))}function Ve(e,t,a){var n,r=X(),i=j.getInstance(),o=i.findPlayer(e),s=i.getEventsFilter(e),l=o.oServiceCall[t.service],d=t.url,c=t.key;if(t.evntCB=W({data:e,param:e.serviceFlag[t.service].callback}),t.callBack=function(a){ke(e,a,t)},a)return r._listeners.addListener(t.evntCB,t.callBack,!0,o),void yt(rt(e,d),t.service,o,a);if(!l&&c&&d&&d.length>0)"stnupdate"===t.evntCB&&(void 0===o.oServiceCall[t.service]||void 0===o.oServiceCall[t.service].status||"init"!==o.oServiceCall[t.service].status&&"complete"!==o.oServiceCall[t.service].status)&&(o.oServiceCall[t.service]={status:"init",station:null,data:null}),r._listeners.addListener(t.evntCB,t.callBack,!0,o),yt(rt(e,d),t.service,o);else if(l&&"init"===l.status);else if(l&&"complete"===l.status&&c!==l.station)r._listeners.addListener(t.evntCB,t.callBack,!0,o),yt(rt(e,d),t.service,o);else if(l&&"complete"===l.status&&c===l.station){for(n in l.data)l.data.hasOwnProperty(n)&&W({data:e,param:n,val:l.data[n]});if(Le&&Le[o.id]&&Le[o.id][t.service]?He(e,Le[o.id][t.service]):He(e,s),"true"===W({data:e,param:"nol_disabled"}))return;e.serviceFlag[t.service].need&&(W({data:e,param:"nol_davState",val:"1"}),e.serviceFlag[t.service].need=!1,ft(W({data:e,param:"nol_queueTime"}),e))}else r._listeners.fireEvent(t.evntCB,t),m.getInstance().processSetTimeout((function(){Ve(e,t)}),1e3)}function Ge(e,t,a,n,r){var i=j.getInstance(),o=be.getInstance(),s=ye.getInstance(),l=null,d=Math.round(u()/1e3);try{if(e)o.isEnabled(e)&&(l=s.inferEvent(t.currEvtType,e,t._param1,d,t._param3))&&(l.event!==s.events.play&&i.state.set(e,l),o.preProcess(e,l)),t.currEvtType&&("5"===t.currEvtType.toString()&&"6"===e.get("nolPriv_prevEvent")&&"st,a"===e.get("nol_c3")&&"false"===e.get("nol_disabled")&&"dcrvideo"===e.get("nol_product")&&"streamduration"===e.get("nol_cadence")&&(Se[a.timeStamp]=it(e,{type:18,msg:"Event 6 -> 5 detected in ad."},!0,!0)),e.set("nolPriv_prevEvent",t.currEvtType.toString().toLowerCase()),e.set("nolPriv_prevEventState",t.eventState?t.eventState.toString().toLowerCase():"")),(""!==i.cms.parse(r.nol_adobeId,e,{metadata:t._param1,defaultKey:"nol_adobeId",silent:!0})||""!==i.cms.parse(r.nol_adobeSessionId,e,{metadata:t._param1,defaultKey:"nol_adobeSessionId",silent:!0})||n.isAdobe)&&(n.disablePauseTimeout(),n.isAdobe=!0)}catch(e){X()._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPreProc(). Error preprocessing event - "+e.message})}return{inferredEvent:l,timestamp:d}}function je(e,t){var a=X(),n=be.getInstance(),r=ye.getInstance(),i=j.getInstance();try{e&&t.inferredEvent&&(t.inferredEvent.event===r.events.play&&i.state.set(e,t.inferredEvent),n.postProcess(e,t.inferredEvent))}catch(e){a._listeners.fireEvent("error",{type:"error",msg:"Error in ggpmPostProc(). Error postprocessing event - "+e.message})}}function Ne(e,t,a){var n,r,i,o,s=X();return e.staticIFrameFlag||(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - enableStaticInIframe flag not set to "true" in config.')}),n=!0),s.browser.isWithinIFrame()||(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t," event - DCR Static implementation is not within an iframe.")}),r=!0),s.PLDCR&&s.PLDCR.dcrTimer?void 0===s.PLDCR.dcrTimer.isActive&&"stoptimer"===t&&(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - Timer not activated, please call ggPM event "starttimer" before calling "').concat(t,'".')}),i=!0):(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t,' event - Timer not instantiated, please call ggPM event "staticstart" before calling "').concat(t,'".')}),i=!0),-1===["focus","touchstart","blur"].indexOf(a)&&(s._listeners.fireEvent("error",{type:"error",msg:"Error in ".concat(t," event - Invalid event type: ").concat(a,".")}),o=!0),n||r||i||o}function Be(e,t,n){var r=X(),i=j.getInstance(),o=be.getInstance(),s=r.PLDPR.product,l=L(),d=W({data:e,param:"nol_playerId"});if(d===t.id)if(t.evtInfo&&void 0!==t.evtInfo.eventType&&null!==t.evtInfo.eventType&&""!==t.evtInfo.eventType&&(!t.evtInfo.hasOwnProperty("param1")||null!==t.evtInfo.param1&&void 0!==t.evtInfo.param1)){var c,p,v,f,g,_,h,P,y,S,T,C,w,D=t.evtInfo,E=D.param1,I=D.param3?D.param3:E.hasOwnProperty("param3")?E.param3:E,k=D.param2||"",R=b(W({data:e,param:"nolPriv_id3Count"}),"num"),F=W({data:e,param:"nol_enableFilterMap"}),A={filters:{onId3PcCidChanged:!1,onId3FdCidChanged:!1},count:0,filterType:"old"},M=i.getEventsFilter(e),x=W({data:e,param:"nol_prod"}),V={},G=D.eventType.toString(),N=W({data:e,param:"nolPriv_serverTimeOffset"}),B=O()[d]||{},U=B.nol_vidtype?B.nol_vidtype.clientField:"nol_vidtype",Q=B.nol_tagSrc?B.nol_tagSrc.clientField:"nol_tagSrc",H=B.nol_ac?B.nol_ac.clientField:"nol_ac",q=B.nol_linearAdLoadFlag?B.nol_linearAdLoadFlag.clientField:"nol_linearAdLoadFlag",z=I[U]?I[U].toString().toLowerCase():I.type?I.type.toString().toLowerCase():"",K="nol_assetid",J=i.findPlayer(e),Y=W({data:e,param:"nol_cadence"}),$={};J.resetSession=J.resetSession||!1,"object"===a(I)&&Object.prototype.hasOwnProperty.call(I,"type")&&""===I.type&&t.timeStamp&&!Se[t.timeStamp]&&(r._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Type param is empty"}),Se[t.timeStamp]=it(e,{type:17,msg:"Type param is empty in ggPM"},!0,!0)),z&&t.timeStamp&&!Se[t.timeStamp]&&-1==["static","content","ad","preroll","postroll","midroll"].indexOf(z.toLowerCase())&&(r._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid content type param"}),Se[t.timeStamp]=it(e,{type:17,msg:"Invalid content type param in ggPM"},!0,!0));var Z={onTick:function(t){!e.isProductOf(["mtvr","id3"])&&n&&n.tickViewability&&"function"==typeof n.tickViewability&&n.tickViewability(e,t)},onCalcStart:function(t,a){e.isProductOf(["mtvr","id3"])&&n&&n.tickViewability&&"function"==typeof n.tickViewability?n.tickViewability(e,t,a):a&&a()},onPingFired:function(e){n&&n.resetViewability&&n.resetViewability(e),e.isProductOf(["mtvr","id3"])&&n&&n.tickViewability&&"function"==typeof n.tickViewability&&n.tickViewability(e,e.get("nolPriv_currPos"))}};G=G.toLowerCase();var ee=Ge(e,{currEvtType:G,_param1:E,eventState:k,_param3:I},t,J,B),te=W({data:e,param:"nol_linearAdLoadFlag",vidType:e._currVidType});"object"===a(t.evtInfo.param1)&&t.evtInfo.param1.adModel&&-1==["0","1","2"].indexOf(t.evtInfo.param1.adModel)&&(["0","1","2"].indexOf(te)>-1?t.evtInfo.param1.adModel=te:t.evtInfo.param1.adModel=W({data:e,param:"nol_linearAdLoadFlag"})),G="3"===G.toLowerCase()?"15":G.toLowerCase();var ae=tt(t),ne="14"===G||"staticstart"===G;switch(G){case"3":case"14":case"15":case"loadmetadata":case"staticstart":case"pauseloadmeta":if("object"===a(t.evtInfo.param1)&&-1==["0","1","2"].indexOf(t.evtInfo.param1.adModel)&&(t.evtInfo.param1.adModel=W({data:e,param:"nol_linearAdLoadFlag"})),("14"===G||"staticstart"===G)&&"dcrstatic"!==W({data:e,param:"nol_product"}))return;if("14"!==G&&"staticstart"!==G&&"dcrstatic"===W({data:e,param:"nol_product"}))return;if("pauseloadmeta"===G&&e.isProductOf("vrivideo"))return;"14"!==G&&"staticstart"!==G||"dcrstatic"!==W({data:e,param:"nol_product"})||!J.staticIFrameFlag||r.browser.isWithinIFrame()||t.timeStamp&&!Se[t.timeStamp]&&(r._listeners.fireEvent("error",{type:"error",msg:"DCR Static not in iFrame, but enableStaticInIframe is set to true in config"}),Se[t.timeStamp]=it(e,{type:17,msg:"DCR Static not in iFrame, but enableStaticInIframe is set to true in config"},!0,!0));var re=","+W({data:e,param:"nol_contentType"}),ie=e._currVidType;W({data:e,param:"nolPriv_prevEvent"}),W({data:e,param:"nol_currPos"});var oe=z&&-1!==re.indexOf(","+z.toLowerCase())?"content":"dcrstatic"===W({data:e,param:"nol_product"})?"static":"ad";if("ad"===W({data:e,param:"nol_ac"})&&W({data:e,param:"nol_segmentTimeSpent",vidType:"ad"})>0&&"streamduration"===Y&&ze(e,Z.onPingFired),e._currVidType=oe,(ie!==e._currVidType||e.get("nolPriv_forcedContent"))&&(n&&n.resetViewability(e),e.set("nolPriv_forcedContent",!1)),s.dtvr&&("15"===G||"loadmetadata"===G)&&e.isProductOf(["mtvr","id3"])&&"content"===e._currVidType){s.dtvr.handleGgpm(e,ae,n);break}"ad"===ie&&"content"===e._currVidType&&e.isProductOf("dcrvideo")&&"interval"===e.get("nol_cadence")&&e.set("nolPriv_currPos","");var se=null,le=null,de=String(i.cms.parse(B.nol_assetid,e,{metadata:I,defaultKey:"nol_assetid",silent:!0}));ne&&String(e._currAssetid)!==de&&(ze(e,Z.onPingFired),W({data:e,param:K,val:-1}),We({data:e,resetStatic:!0}),J.static.started&&(r.PLDCR.dcrTimer.reset(),e.set("nolPriv_currPos","0")));var ce=!0===e.get("nol_onCompleteFired");if(!0===W({data:e,param:"nol_onCompleteFired"})?("content"!==e._currVidType&&"static"!==e._currVidType||("content"===e._currVidType.toLowerCase()&&l[d].hasOwnProperty("forceStreamRegen")&&!0===l[d].forceStreamRegen&&Re(e),W({data:e,param:K,val:-1}),"content"===e._currVidType?(se=i.state.clone(e),le=o.clone(e),We({data:e,savedVals:["nol_nielsenAdSupportFlg"],savedReplayParams:$})):We({data:e,resetStatic:!0})),W({data:e,param:"nol_onCompleteFired",val:!1})):"14"!==G&&"staticstart"!==G||"stream"!==W({data:e,param:"nol_cadence"})||(W({data:e,param:K,val:-1}),We({data:e})),"ad"===e._currVidType&&e._dataArrObj[e._currVidType].hasOwnProperty(e._currAssetid)){var ue=st(W({data:e,param:"nol_segmentLength"}));W({data:e,param:"nol_minutes",val:ue}),W({data:e,param:K,val:-1}),W({data:e,param:U,val:z}),"1"!==W({data:e,param:"nol_nielsenAdSupportFlg",vidType:"content"})&&W({data:e,param:"nol_nielsenAdSupportFlg",val:"1",vidType:"content"})}if(e._currAssetid=de&&"daypart"===W({data:e,param:"nol_cadence"})||"stream"!==W({data:e,param:"nol_cadence"})&&"dcrstatic"===W({data:e,param:"nol_product"})?de:e._currAssetid,I.nol_ac=e._currVidType,b(W({data:e,param:"nol_serverTime"}),"num")+86400<Math.round(u()/1e3)+N)return ze(e,Z.onPingFired),void Me(t,W({data:e,param:"nol_playerId"}));for(T=0,C=F.length;T<C;T+=1)c=B[F[T]]?B[F[T]].clientField:F[T],V[F[T]]=String(I[c]||"");p=de||W({data:e,param:"nolPriv_assetid"}),"15"!==G&&"loadmetadata"!==G||"id3"!==W({data:e,param:"nol_product"})||!W({data:e,param:"nol_id3Data"})||ot(e,null,Z&&Z.onPingFired?Z.onPingFired:null);var pe=p!==W({data:e,param:K})||e&&e._dataArrObj&&e._dataArrObj.content&&"object"===a(e._dataArrObj.content)&&!e._dataArrObj.content[0];if(He(e,M.onCmsDetected,V),"false"!==V.nol_disabled||!I)return void("cms"!==e._currTagSrc&&(pe?(Ae(e,"loadMetadata",I,n),W({data:e,param:"nol_disabled",val:"true"})):i.updateMetadata(e,I,B,{inferred:!0}),"15"!==G&&"loadmetadata"!==G||"id3"!==W({data:e,param:Q,vidType:"content"})&&!e.isProductOf("mtvr")||!0===W({data:e,param:"nolPriv_dtvrHybrid",vidType:"content"})||W({data:e,param:"nolPriv_dtvrHybrid",val:!0,vidType:"content"})));if("static"===e._currVidType&&"dcrstatic"===W({data:e,param:"nol_product"})&&r._listeners.fireEvent("updateCmbStaticPage",{evtInfo:D,plid:d}),p!==W({data:e,param:K})){"ad"!==W({data:e,param:"nol_ac"})&&ze(e,Z.onPingFired,void 0,"onAssetIdChange");var me=W({data:e,param:K});if(Ae(e,"loadMetadata",I,n),me&&!ce&&"content"===e._currVidType.toLowerCase()&&e.isProductOf("dcrvideo")&&"impression"===e.get("nol_cadence")&&(J.resetSession=!0),Object.keys($).length>0){for(var ve in $)$.hasOwnProperty(ve)&&""!==$[ve]&&W({data:e,param:ve,val:$[ve]});$={}}if(W({data:e,param:"nolPriv_assetid",val:W({data:e,param:K})}),"15"!==G&&"loadmetadata"!==G||"id3"!==W({data:e,param:Q,vidType:"content"})&&!e.isProductOf("mtvr")||!0===W({data:e,param:"nolPriv_dtvrHybrid",vidType:"content"})||W({data:e,param:"nolPriv_dtvrHybrid",val:!0,vidType:"content"}),He(e,M.onAssetIdChanged),"true"===W({data:e,param:"nol_disabled"}))return;if("drm"===W({data:e,param:"nol_product"}))e.serviceFlag.stn.need=!0;else if(e.serviceFlag.stn.need=!1,"true"===W({data:e,param:"nol_disabled"}))return;if(He(e,M.onComplete),se&&i.state.bind(e,se),le&&o.bind(e,le),"true"===W({data:e,param:"nol_disabled"}))return}"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"impression"!==W({data:e,param:"nol_cadence"})&&e.set("nolPriv_adCounted",!1),e.isProductOf("vrivideo")&&"impression"===e.get("nol_cadence")&&(e.set("nol_vriEvent","start"),e.set("nol_startPos","")),W({data:e,param:"nol_pingStartTimeUTC",val:Math.round(u()/1e3)}),-1!==x.indexOf("iag")&&_t(e,e._currVidType),("ad"===e._currVidType&&!e.isProductOf(["dcrvideo","vrivideo"])||"stream"===W({data:e,param:"nol_cadence"}))&&(W({data:e,param:"nol_pingCount",val:0}),W({data:e,param:"nolPriv_sendData",val:!0}),W({data:e,param:"nol_davState",val:"0"}),e.serviceFlag.stn.need||"content"===e._currVidType||"nol_cmsoffset"!==W({data:e,param:"nol_timer"})&&"nol_pageoffset"!==W({data:e,param:"nol_timer"})||ft(0,e,Z)),"14"!==G&&"staticstart"!==G||"dcrstatic"!==W({data:e,param:"nol_product"})||!0===J.static.started||(r.PLDCR.start(!0),J.static.started=!0);break;case"5":case"play":if("mtvr"===W({data:e,param:"nol_product"})){if(s.dtvr){s.dtvr.handleGgpm(e,ae,n);break}if(I[y=B.nol_channelName?B.nol_channelName.clientField:"nol_channelName"]&&I[y].length>0)for(w in I)I.hasOwnProperty(w)&&W({data:e,param:w,val:I[w]})}else e.isProductOf(["dcrvideo","vrivideo"])&&1==e.get("nolPriv_adStop")&&(e.set("nolPriv_adStop",!1),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"interval"===e.get("nol_cadence")&&e.set("nolPriv_currPos","","content"),e._currVidType="content",V={nol_vidtype:W({data:e,param:U,vidType:e._currVidType}),nol_tagSrc:W({data:e,param:Q,vidType:e._currVidType}),nol_linearAdLoadFlag:W({data:e,param:q,vidType:e._currVidType}),nol_ac:W({data:e,param:H,vidType:e._currVidType})},He(e,M.onCmsDetected,V));break;case"6":case"pause":xe(e,null,Z);break;case"7":case"stop":xe(e,null,Z),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&e.set("nolPriv_adStop",!0);break;case"flush":if("interval"===(Y=e.get("nol_cadence"))||"streamduration"===Y){if(e.isProductOf("dcrvideo")){xe(e,{flush:!0,save:!0},Z);break}var fe=r&&r.PLDCR;e.isProductOf("dcrstatic")&&fe&&(xe(e,{flush:!0,save:!0},Z),fe.dcrTimer&&fe.dcrTimer.reset(),e.set("nolPriv_currPos","0"),fe.focusTimer.enableTimeout=!!fe.focusTimer.intervalID,fe.focusTimer.enableTimeout&&(fe.focusTimer.timeoutStartTime=Date.now()))}break;case"changecontext":E&&["content","ad"].indexOf(E)>-1&&(e._currVidType=E);break;case"updateott":if(xe(e,null,Z),E&&E.hasOwnProperty("ottStatus")&&E.ottStatus.length>0){if(E.hasOwnProperty("kGCKMetadataNlsKeyOptout")&&E.hasOwnProperty("kGCKMetadataNlsKeyDeviceID")){var ge=E.kGCKMetadataNlsKeyOptout.toString().toLowerCase();W({data:e,param:"nol_userSessionId",val:E.kGCKMetadataNlsKeyDeviceID,vidType:"content"}),W({data:e,param:"nol_useroptout",val:"1"===ge||"true"===ge?"true":"false",vidType:"content"}),-1===[1,"1","true",0,"0","false"].indexOf(ge)&&r._listeners.fireEvent("warn",{type:"warn",msg:"Warning: Invalid kGCKMetadataNlsKeyOptout value."})}for(var K in E)E.hasOwnProperty(K)&&(W({data:e,param:K,val:E[K],vidType:"content"}),J.ottStatusObj[K]=E[K]);M.onOTTDetected&&He(e,M.onOTTDetected)}break;case"57":case"56":case"end":case"oncomplete":case"staticend":if(("56"===G||"staticend"===G)&&"dcrstatic"!==W({data:e,param:"nol_product"}))return;if("56"!==G&&"staticend"!==G&&"dcrstatic"===W({data:e,param:"nol_product"}))return;if(e.isProductOf("vrivideo")&&("57"===G||"end"===G)&&("sessionReset"===k||"modcadence"!=e.get("nol_cadence")))return;if(s.dtvr&&("57"===G||"end"===G||"oncomplete"===G)&&e.isProductOf(["mtvr","id3"])){s.dtvr.handleGgpm(e,ae,n);break}if("ad"===e._currVidType&&("streamduration"===W({data:e,param:"nol_cadence"})?ot(e,null,Z.onPingFired):e.isProductOf(["dcrvideo"])&&"interval"===W({data:e,param:"nol_cadence"})&&(""===W({data:e,param:"nol_dataDate",vidType:"content"})&&""!==W({data:e,param:"nol_dataDate"})&&(W({data:e,param:"nol_dataDate",val:W({data:e,param:"nol_dataDate"}),vidType:"content"}),W({data:e,param:"nol_hourCode",val:W({data:e,param:"nol_hourCode"}),vidType:"content"}),W({data:e,param:"nol_dayId",val:W({data:e,param:"nol_dayId"}),vidType:"content"})),e._currVidType="content",M.onEndDetected&&He(e,M.onEndDetected),ot(e,null,Z.onPingFired))),e.isProductOf("dcrvideo")&&e.set("nolPriv_currPos",""),e.isProductOf("vrivideo")&&"modcadence"===e.get("nol_cadence")){var _e=e.get("nol_length")||i.cms.parse(B.nol_length,e,{defaultKey:"nol_length",silent:!0});if("NaN"===parseInt(_e).toString())return;if(!(parseInt(e.get("nol_currPos"))>=parseInt(e.get("nol_length"))))return;e.set("nol_vriEvent","ended")}"static"!==W({data:e,param:"nol_ac"})&&(e._currVidType="content"),M.onEndDetected&&He(e,M.onEndDetected),W({data:e,param:"nol_forceFireOnClose_content",val:"1"}),"false"!==W({data:e,param:"nol_disabled"})&&"id3"!==W({data:e,param:"nol_product"})||("static"===W({data:e,param:"nol_ac"})&&r._listeners.fireEvent("removeCmbAssetId",D),ze(e,Z.onPingFired)),W({data:e,param:"nol_onCompleteFired",val:!0}),l[d].forceStreamRegen=!0,"56"!=G&&"staticend"!=G||"dcrstatic"!==W({data:e,param:"nol_product"})||(r.PLDCR.stop(),J.static.started=!1),"sessionReset"!==k&&J.disablePauseTimeout();break;case"48":case"setpageduration":case"pageduration":case"staticposition":if("true"===W({data:e,param:"nol_disabled"})||!E||"nol_pageoffset"!==W({data:e,param:"nol_timer"}))return;var he;"1"===W({data:e,param:"nol_onPaginateFired_static"})&&(W({data:e,param:"nol_onPaginateFired",val:"0",vidType:"static"}),"impression"!==W({data:e,param:"nol_cadence"})&&pt(e,{vidType:"static"})),b(W({data:e,param:"nol_highWM"}),"num")<b(E,"num")&&W({data:e,param:"nol_highWM",val:E}),ft(E,e,Z),W({data:e,param:"nol_davState",val:"1"}),J&&J.sivt&&J.sivt.initialized&&J.sivt.addSIVTTag&&J.sivt.initialized()&&"impression"===e.get("nol_cadence")&&J.sivt.dcrStaticInit&&!J.sivt.dcrStaticInit()&&J.sivt.addSIVTTag(e),he=e.get("nol_cadenceOverrideEnabled")&&e.get("nol_cadenceOverride")?e.get("nol_cadenceOverride"):!(!r.PLDCR.cadenceOverrideEnabled||!r.PLDCR.cadenceOverride)&&r.PLDCR.cadenceOverride;var Pe=60*parseInt(e.get("nol_segmentLength")||0);"dcrstatic"===e.get("nol_product")&&he&&he>0&&he<=E&&(!Pe||he<Pe)&&(xe(e,{flush:!0,save:!0},Z),r.PLDCR.dcrTimer.reset(),e.set("nolPriv_currPos","0"));break;case"49":case"setplayheadposition":case"playheadposition":if(E>-1){if(!0===W({data:e,param:"nol_onCompleteFired"})&&r._listeners.fireEvent("flushPauseEventQueue"),"number"!=typeof E){if("string"!=typeof E)return;E=b(E,"num")}else E=Math.floor(E);if(e.isProductOf("dcrvideo")&&W({data:e,param:"nol_isLive",val:(E>86400).toString()}),"true"===W({data:e,param:"nol_disabled"})||!E||"nol_cmsoffset"!==W({data:e,param:"nol_timer"})||"ad"===e._currVidType&&e.isProductOf(["dcrvideo","vrivideo"])&&"impression"===W({data:e,param:"nol_cadence"}))return;if(J&&!0===J.resetSession&&(J.resetSession=!1,l[d].forceStreamRegen=!0,Re(e)),e.isProductOf("vrivideo")){var ye=Math.floor(E);"impression"===e.get("nol_cadence")&&1===ye&&ye<e.get("nolPriv_prevPos")&&(e.set("nol_pingCount",0),e.set("nol_currPos","")),"modcadence"===e.get("nol_cadence")&&e.set("nol_vriEvent","loop")}if(b(W({data:e,param:"nol_highWM"}),"num")<E&&W({data:e,param:"nol_highWM",val:E}),e.serviceFlag.stn.need?(W({data:e,param:"nol_queueTime",val:E}),Ve(e,{service:"stn",key:W({data:e,param:"nol_assetid"}),url:W({data:e,param:"nol_stationURL"}),nol_playerId:W({data:e,param:"nol_playerId"})})):ft(E,e,Z),W({data:e,param:"nol_davState",val:"1"}),J&&J.sivt&&J.sivt.initialized&&J.sivt.addSIVTTag&&J.sivt.initialized()&&"impression"===e.get("nol_cadence")&&J.sivt.dcrVideoInit&&!J.sivt.dcrVideoInit()&&J.sivt.addSIVTTag(e),"ad"===e._currVidType&&e.isProductOf("dcrvideo")&&"impression"!==W({data:e,param:"nol_cadence"})&&!1===e.get("nolPriv_adCounted"))W({data:e,param:"nol_timeSpentViewing"})[e._currVidType].nol_count++,e.set("nolPriv_adCounted",!0);"content"!==e._currVidType||J.isAdobe||J._pauseTimeoutEnabled||J.enablePauseTimeout()}else t.timeStamp&&!Se[t.timeStamp]&&(Se[t.timeStamp]=it(e,{type:15,msg:"A negative playhead position was sent and will be ignored."},void 0,!0),Se[t.timeStamp]&&r._listeners.fireEvent("warn",{type:"warn",msg:"Warning: A negative playhead position was sent and will be ignored."}));break;case"55":case"sendid3":if("nol_cmsoffset"===e.get("nol_timer")||"nol_pageoffset"===e.get("nol_timer"))return;if(s.dtvr){s.dtvr.handleGgpm(e,ae,n);break}var Oe=!1,Le=!1;if(("object"===a(E)&&Object.keys(E).length>0||"string"==typeof E&&E.length>0)&&((!0===W({data:e,param:"nol_onCompleteFired"})&&J&&J.getPauseQueueCount&&J.getPauseQueueCount()>0||!0===W({data:e,param:"nol_onCompleteFired"})&&J&&!J.getPauseQueueCount)&&r._listeners.fireEvent("flushPauseEventQueue"),"object"===a(E)))for(C=0;C<E.length;C+=1)if(E[C].key&&"PRIV"===E[C].key){E=E[C].info;break}if(249!==(_=E.toString()).length&&t.timeStamp&&!Se[t.timeStamp]){Se[t.timeStamp]=it(e,{type:17,msg:"ID3 tag length is not 249. ID3 Tag: ".concat(_)},!0,!0);var Te=m.getInstance();Te&&Te.logWarn("Warning: ID3 tag length is not 249.")}if(E={},(g=_.split("/")).length<b(we.nol_breakout,"num"))return;for(w in we)we.hasOwnProperty(w)&&(E[w]=g[we[w]],"nol_breakout"===w&&(E[w]=g[b(we[w],"num")].substr(0,2)),V[w]=E[w]);if(!E||W({data:e,param:"nol_tsvBreakoutMap"})&&-1===W({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(E.nol_breakout)||-1===E.nol_nWebAddress.indexOf("nielsen.com")||E.nol_fdcid===W({data:e,param:"nol_cidNull"})&&E.nol_pccid===W({data:e,param:"nol_cidNull"}))return;for(e._currVidType="content",T=0,C=F.length;T<C;T+=1)c=B[F[T]]?B[F[T]].clientField:F[T],V[F[T]]=E[c]||W({data:e,param:F[T]});if(V.nol_vidtype="content",He(e,M.onId3Detected,V),"false"!==V.nol_disabled||"nol_cmsoffset"===W({data:e,param:"nol_timer"}))return;if("daypart"===W({data:e,param:"nol_cadence"})){var Ce=W({data:e,param:"nol_assetid"})||e._currAssetid;!Ce&&E.nol_fdcid&&E.nol_fdcid!==W({data:e,param:"nol_cidNull"})?e._currAssetid=E.nol_fdcid:!e._currAssetid&&Ce&&(e._currAssetid=Ce)}E.nol_ac=e._currVidType,E.nol_assetid=W({data:e,param:"nol_assetid"})||e._currAssetid,R>0&&(-1!==W({data:e,param:"nol_product"}).indexOf("id3")||-1!==W({data:e,param:"nol_product"}).indexOf("mtvr"))&&(E.nol_pccid!==W({data:e,param:"nol_cidNull"})&&E.nol_pccid!==W({data:e,param:"nol_pccid"})||E.nol_fdcid!==W({data:e,param:"nol_cidNull"})&&E.nol_fdcid!==W({data:e,param:"nol_fdcid"}))&&ot(e,null,Z.onPingFired,!0);var De=i.mtvr.pcChanged(e,E.nol_pccid),Ee=i.mtvr.fdChanged(e,E.nol_fdcid);if(De&&(i.mtvr.isPCTag(e)||i.mtvr.isTransPing(e))&&(A.filters.onId3PcCidChanged=!0,A.count=A.count+1,n&&n.startViewability(e),(Ee||i.mtvr.isNullFDCid(e))&&e.set("nol_id3Seq",0)),Ee&&(i.mtvr.isFDTag(e)||i.mtvr.isTransPing(e))&&(A.filters.onId3FdCidChanged=!0,A.count=A.count+1,n&&n.startViewability(e),e.set("nol_id3Seq",0)),Ee&&i.mtvr.isPCTag(e)&&(Oe=!0),""===e.get("nol_fdrtvod")||"0"===e.get("nol_fdrtvod")||!i.mtvr.isPCTag(e)&&!i.mtvr.isFDTag(e)||i.mtvr.isNullPCCid(e)||""===e.get("nol_pccid")||i.mtvr.isNullFDCid(e)||""===e.get("nol_fdcid")||!De||(Le=!0,i.mtvr.isFDTag(e)&&M&&M.onId3FdCidChanged&&He(e,M.onId3FdCidChanged)),A.count){if(Ae(e,"sendID3",E,n),!A.filters.onId3FdCidChanged&&W({data:e,param:"nol_fdcid"})!=W({data:e,param:"nol_cidNull"})||-1===W({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(E.nol_breakout)||(e.serviceFlag.tsv.need=!0),A.count>0)for(w in A.filters)if(A.filters[w]&&(He(e,M[w]),"true"===W({data:e,param:"nol_disabled"})))return;if(M.onComplete&&(He(e,M.onComplete),"true"===W({data:e,param:"nol_disabled"})))return}else for(w in E)E.hasOwnProperty(w)&&W({data:e,param:w,val:E[w]});if((Ee&&i.mtvr.isFDTag(e)||De&&i.mtvr.isPCTag(e))&&e.isProductOf("mtvr")&&"impression"===e.get("nol_cadence")&&"false"===e.get("nol_disabled")){var Ie=l[d].nolPriv_newMTVRStreamId;l[d].nolPriv_newMTVRStreamId=Ie&&l[d].restEvtTimestamp==t.timeStamp?Ie:r.generateGUID(),i.mtvr.resetTagSession(e,l[d].nolPriv_newMTVRStreamId),l[d].restEvtTimestamp=t.timeStamp,r._listeners.fireEvent("debug",{type:"debug",msg:e.get("nol_comment")+" new mtvr session is "+Ie})}if((e.isProductOf("mtvr")||e.isProductOf("id3"))&&"false"===e.get("nol_disabled")&&l[d].restEvtTimestamp!=t.timeStamp){var ke=l[d].nolPriv_newMTVRStreamId;ke&&ke!==e.get("nol_sessionId","content")&&i.mtvr.resetTagSession(e,ke)}if(W({data:e,param:"nol_id3Raw",val:_}),(e.serviceFlag.tsv.need||Oe||Le)&&-1!=="|mtvr|,|dprid3|,|id3|".indexOf("|"+W({data:e,param:"nol_product"})+"|")&&"false"===e.get("nol_disabled")&&(["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&e.set("nol_rtvod",""),P=Le?W({data:e,param:"nol_pccid"}):Oe||!0!==A.filters.onId3PcCidChanged||i.mtvr.isNullPCCid(e)?W({data:e,param:"nol_fdcid"}):W({data:e,param:"nol_pccid"}),e.get("nol_tsvURL")&&Ve(e,{service:"tsv",key:P,url:W({data:e,param:"nol_tsvURL"})})),(e.isProductOf("id3")||e.isProductOf("mtvr")&&"interval"===e.get("nol_cadence")&&"false"===e.get("nol_disabled"))&&E.nol_watermark&&String(E.nol_watermark).length>0&&(v=W({data:e,param:"nol_id3Data"}),f=Math.round(u()/1e3+N),S=W({data:e,param:"nol_id3Seq"})||0,v?W({data:e,param:"nol_id3Data",val:v=v+"|"+f+","+W({data:e,param:"nol_id3Raw"})}):(W({data:e,param:"nol_id3Data",val:S+":"+W({data:e,param:"nol_clocksrc"})+":"+W({data:e,param:"nol_tsvFlag"})+":"+f+","+W({data:e,param:"nol_id3Raw"})}),W({data:e,param:"nol_id3Seq",val:b(S,"num")+1,vidType:"content"})),e.isProductOf("id3")))return R>0&&ot(e,{returnLength:!0},Z.onPingFired),W({data:e,param:"nolPriv_id3Count",val:R+=1}),void W({data:e,param:"nol_davState",val:"1"});if(W({data:e,param:"nolPriv_id3Count",val:R+=1}),h=W({data:e,param:W({data:e,param:"nol_timer"})})||W({data:e,param:"nol_fdoffset"}),"daypart"===W({data:e,param:"nol_cadence"})&&(h=b(h,"num"),h+="nol_pcoffset"==W({data:e,param:"nol_timer"})?b(W({data:e,param:"nol_pcTimeCode"}),"num"):b(W({data:e,param:"nol_fdTimeCode"}),"num")),e.serviceFlag.tsv.need)W({data:e,param:"nol_queueTime",val:h});else{if("true"===W({data:e,param:"nol_disabled"}))return;ft(h,e,Z),W({data:e,param:"nol_davState",val:"1"})}(Ee&&i.mtvr.isFDTag(e)||De&&i.mtvr.isPCTag(e))&&(i.mtvr.isPCTag(e)&&"false"===e.get("nol_disabled")?n&&n.tickViewability(e,E.nol_pcoffset):i.mtvr.isFDTag(e)&&"false"===e.get("nol_disabled")&&n&&n.tickViewability(e,E.nol_fdoffset));break;case"60":case"mute":case"buffer":case"buttonevent":break;case"61":case"volume":n&&n.viewability&&n.viewability.setVolume(E);break;case"30":case"onpaginate":"dcrstatic"===W({data:e,param:"nol_product"})&&M.onPaginateDetected&&"stream"!==W({data:e,param:"nol_cadence"})&&He(e,M.onPaginateDetected),W({data:e,param:"nol_onPaginateFired",val:"1",vidType:"static"});break;case"35":case"updatemetadata":if(e.isProductOf(["dcrvideo","vrivideo"])){i.updateMetadata(e,I,B,t.evtInfo);var Fe=W({data:e,param:"nol_adLoadType",vidType:"content"});""!==Fe&&null!=Fe&&He(e,M.onAdLoadFlag)}break;case"starttimer":if(e.isProductOf("dcrstatic")&&"impression"===e.get("nol_cadence")){if(Ne(J,G,E="string"==typeof E?E.toLowerCase():""))break;var Be="focus"===E,Ue="touchstart"===E;r.PLDCR.dcrTimer.isActive||(Be&&(r.PLDCR.dcrTimer.play(r.PLDCR._reset),r.PLDCR._reset=!1),Ue&&r.PLDCR.safeFocus({type:E}))}break;case"stoptimer":if(e.isProductOf("dcrstatic")&&"interval"===e.get("nol_cadence")){if(Ne(J,G,E="string"==typeof E?E.toLowerCase():""))break;r.PLDCR.dcrTimer.isActive&&"blur"===E&&(xe(e,{flush:!0,save:!0},Z),r.PLDCR.dcrTimer.reset(),e.set("nolPriv_currPos","0"),r.PLDCR.dcrTimer.pause(),r.PLDCR.safeFocusOn&&(r.PLDCR.safeFocusOn=!1))}}je(e,ee)}else t.timeStamp&&!Se[t.timeStamp]&&"true"!==e.get("nol_disabled")&&(t.evtInfo&&!t.evtInfo.eventType&&(r._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid event type param"}),Se[t.timeStamp]=it(e,{type:17,msg:"Missing event type param in ggPM"},!0,!0)),!t.evtInfo||null!==t.evtInfo.param1&&void 0!==t.evtInfo.param1||(r._listeners.fireEvent("error",{type:"error",msg:"Error in handleGgpm - Invalid Param1 passed"}),Se[t.timeStamp]=it(e,{type:17,msg:"Missing param1 detected on event "+t.evtInfo.eventType},!0,!0)))}var Ue={};function Qe(e,t,a){var n=!1,r=a.toString().toLowerCase().indexOf(t.toString().toLowerCase());return("-"===e&&-1===r||"+"===e&&(a===t||-1!==r&&a&&t)||"--"===e&&-1===t.toString().toLowerCase().indexOf(a.toString().toLowerCase())||"++"===e&&-1!==t.toString().toLowerCase().indexOf(a.toString().toLowerCase()))&&(n=!0),n}function He(e,t,a,n){var r,i,o,s,l,d,c,u,p,m,v,f=t||e.get("nol_finalFilter",n),g=a||{};if(f&&void 0!==f)for(r=0,i=f.length;r<i;r++){if((u=f[r]).tagVar.length)for(o=0,s=u.tagVar.length;o<s&&(m=e.get(u.tagVar[o].name,n));o++);else m=e.get(u.tagVar.name,n);if(m&&u.tagVar.value===m){for(o=0,s=u.cond.length;o<s;o++){if(c=g[u.cond[o]]||e.get(u.cond[o],n),d=0===u.is.value.indexOf("nol_")&&e.get(u.is.value,n)?e.get(u.is.value,n):u.is.value,void 0===c||void 0===d||!Qe(u.is.type,c,d)){p=!1;break}p=!0}if(void 0!==p&&void 0!==(v=p?u.then:u.else))for(l in v)v.hasOwnProperty(l)&&(void 0!==g.nol_vidtype?g[l]=v[l]:e.set(l,v[l],n))}}}function qe(e,t){var a,n,r=c(),i=e.split("||"),o=i[0]||e;if(r)for(a=0,n=i.length;a<n;a++)void 0!==r["on"+(o=i[a])]&&(r.addEventListener?r.addEventListener(o,t,!1):r.attachEvent&&r.attachEvent("on"+o,t))}function We(e,t){var a;try{if(!e||!e.hasOwnProperty("data"))return;if(e.hasOwnProperty("savedVals")&&e.hasOwnProperty("savedReplayParams"))if(Array.isArray(e.savedVals))for(a in e.savedVals)e.savedVals.hasOwnProperty(a)&&(e.savedReplayParams[e.savedVals[a]]=W({data:e.data,param:e.savedVals[a]}));else"string"==typeof e.savedVals&&(e.savedReplayParams[e.savedVals]=W({data:e.data,param:e.savedVals}));e.hasOwnProperty("resetStatic")&&!0===e.resetStatic&&(e.data._dataArrObj.static={}),e.data._dataArrObj.ad={},e.data._dataArrObj.content={},e.data._dataArrObj.count={content:0,ad:0,static:0},e.data._currAssetid="0"}catch(e){X()._listeners.fireEvent("error",{type:"error",msg:"Error in resetDataObj"+e})}}function ze(e,t,a,n){n=n||"";"id3"===W({data:e,param:"nol_product"})&&W({data:e,param:"nol_id3Data"})?ot(e,null,t||null,a):e.isProductOf("vrivideo")&&"ended"!==e.set("nol_vriEvent")||"true"!==W({data:e,param:"nol_disabled"})&&("1"===W({data:e,param:"nol_davState"})||"onbeforeunload"===n&&"1"===e.get("nol_davState","ad"))&&("onAssetIdChange"===n&&"1"===W({data:e,param:"nol_davty"})&&W({data:e,param:"nol_davty",val:"2"}),W({data:e,param:"nol_davState",val:"2"}),"daypart"===W({data:e,param:"nol_cadence"})?ot(e,{save:!0},t||null,a):ot(e,null,t||null,a),e.isProductOf(["mtvr","id3"])?W({data:e,param:"nolPriv_enableDtvr",val:"true"}):mt(e),W({data:e,param:"nol_disabled",val:"true"}))}function Ke(e,t,a){var n,r,i,o=j.getInstance(),s=X(),l=ye.getInstance(),d=be.getInstance(),c=a.id||a.getId?a.getId():"0",u=t[c].nol_tagMap.nol_url,p=0,m=u?u[e.nol_url]||e.nol_url||"":e.nol_url||"",v={nol_disabled:"true",nol_errorMessage:"none",nol_vidtype:"",nol_muteState:"0",nol_volumeLevel:"100",nol_clockSource:"D",nol_aggregate:"1",nol_pingCount:"0",nol_intrvlThrshld:"90",nol_id3IntrvlGp:"15",nolPriv_sendData:!0,nol_timer:"nol_fdoffset",nol_isLive:"false",nolPriv_errorSent:"",nolPriv_id3Count:0,nolPriv_cmsMap:{},nol_timeSpentViewing:{ad:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},content:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0},static:{nol_cumeTimeSpent:0,nol_segmentTimeSpent:0,nol_count:0}},nol_enableFilterMap:["nol_vidtype","nol_tagSrc","nol_linearAdLoadFlag","nol_ac"],nol_xorSeed:"N!3ls3nBL",nol_currSeg:"0",nol_minWonOverride:"0",nol_customExtension:["nol_legacyCustom"],nol_pingCreationTime:"0",nol_pingSendTime:"0",nol_clientUrl:"",nol_sendTime:"0",nol_pageURL:"",nol_referrerURL:"",nol_random:Math.round(1e9*Math.random()),nol_ottStatus:"0",nol_ottType:"none",nol_ottDevice:"NA",nol_ottDeviceName:"NA",nol_ottDeviceID:"NA",nol_ottDeviceManufacturer:"NA",nol_ottDeviceModel:"NA",nol_ottDeviceVersion:"NA",nol_onPaginateFired:"0",nol_forceFireOnClose:"0",nol_applyViewInc:"0",nol_viVersion:"",nol_omidsdkVersion:""},f=e;f.nol_playerId=c;var g=this,_={_dataArrObj:{ad:{},content:{},static:{},count:{content:0,static:0}},_settings:f,_currVidType:"ad",_currAssetid:"0",serviceFlag:{stn:{need:!1,callback:"nol_stnevt"},tsv:{need:!1,callback:"nol_tsvevt"}}};for(i in o.extendfData(_),this.name=_.get("nol_comment"),this.playerId=c,this.resetViewability=function(e,t){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&g.viewability.clear(e,t)},this.startViewability=function(e){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&"function"==typeof g.viewability.start&&g.viewability.start(e)},this.stopViewability=function(){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()&&"function"==typeof g.viewability.stop&&g.viewability.stop()},this.tickViewability=function(e,t,a){g&&g.viewability&&g.viewability.initialized&&g.viewability.initialized()?g.viewability.tick(t,e,(function(){g.viewability.setData(e),a&&a(),s._listeners.fireEvent("debug",{type:"debug",msg:JSON.stringify(g.viewability.getData())})})):a&&a()},s._listeners.addListener("tick",(function(){if(a.pauseObj.eventPauseTime>=a.pauseObj.cmsPauseTime&&o.state&&o.state.status&&o.state.status.current(_)!==o.states.stopped&&o.state.status.current(_)!==o.states.paused&&d.isEnabled(_)){var e={event:l.events.pause,curPos:o.state.position.current(_),prevPos:null,timestamp:o.state.timeStamp.current(_)};o.state.set(_,e),d.preProcess(_,e),a.pauseObj.eventPauseTime=0}a.pauseObj.pauseTime>a.pauseObj.maxPauseTime&&"dcrstatic"!==W({data:_,param:"nol_product"})&&"vrivideo"!==W({data:_,param:"nol_product"})&&(a.pauseObj.pauseTime=0,s._listeners.fireEvent("handleSessionReset",{plid:c,passedFdata:_}),s._listeners.fireEvent("debug",{type:"debug",msg:"Max pause time reached. Just fired handleSessionReset."}))})),We({data:_}),v)e.hasOwnProperty(i)?f[i]=e[i]:f[i]=t[c][i]||v[i];if(f.nol_customExtension&&m){for(n=0,r=f.nol_customExtension.length;n<r;n++)m=m.replace("|!["+f.nol_customExtension[n]+"]!|",t[c][f.nol_customExtension[n]]||"");f.nol_url=m}if(s.PLVBL&&_.get("nol_vizuURL")&&("interval"===_.get("nol_cadence")||"streamduration"===_.get("nol_cadence"))&&(this.viewability=new s.PLVBL(_,a)),"true"!==W({data:_,param:"nol_fireStop"})&&-1==="interval,episode,streamduration".indexOf(W({data:_,param:"nol_cadence"}))||qe("pagehide||beforeunload",(function(){W({data:_,param:"nol_forceFireOnClose_content",val:"1"});var e=o.getEventsFilter(_);e&&e.onEndDetected&&(He(_,e.onEndDetected,null,"ad"),He(_,e.onEndDetected,null,"content"),He(_,e.onEndDetected,null,"static")),d.setNextTick(_,null,"content"),ze(_,!1,!0,"onbeforeunload")})),this.eventListener=function(e){Be(_,e,g)},t[c].eventQueue.length>p)for(n=0;n<t[c].eventQueue.length;n++)t[c]&&t[c].eventQueue&&(t[c].eventQueue[n].timeStamp="queued"+n),Be(_,t[c].eventQueue[n]),p=n;s._listeners.addListener("sendError",(function(e){if(!e.target||c===e.target.id){var t=e.target.id+"_"+e.target.timeStamp;Ue[t]||(s._listeners.fireEvent("error",{type:"error",msg:e.target.data?e.target.data.msg:""}),Ue[t]=it(_,e.target.data,!0,!0))}}))}var Je={"[":{end:"]",count:0},"{":{end:"}",count:0},"<":{end:/\.\d+,\d+\>/g,count:0}},Ye={regex:/\|\![\w\W]*?(\!\|)/g,length:2},$e=new RegExp(/(.*?)(_content|_ad|_static)?$/i),Xe=function(){};function Ze(e,t,a,n){var r="";return a&&a.clientField!==t&&!0!==n.end&&(r=j.getInstance().cms.parse(a,e,n))?r:W({data:e,param:t,vidType:n?n.vidType:""})}function et(e,t){var a,n,r,i,o="";if(!e||!t)return e;for(i=t.length,n=0,r=e.length;n<r;n++)o+=0===(a=e.charCodeAt(n)^t.charCodeAt(n%i))?e.charAt(n):String.fromCharCode(a);return o}function tt(e){var t;try{if(null===e||"object"!==a(e)||"isActiveClone"in e)return e;for(var n in t=e instanceof Date?new e.constructor:e.constructor(),e)Object.prototype.hasOwnProperty.call(e,n)&&(e.isActiveClone=null,t[n]=tt(e[n]),delete e.isActiveClone);return t}catch(e){return!1}}function at(e,t,a,n,r){var i,o;-1===a.indexOf("[")&&-1===a.indexOf("]")&&(!n.val||n.val.length<=0)?r||(it(e,{type:"100",msg:a+" missing -- "+W({data:e,param:"nol_comment"})}),n.state=!1,n.val=""):"<"===t||">"===t?(i=a.match(Je["<"].end))?(o=i[0].match(/[\d]+/g),n.val=String(n.val).substr(o[0],o[1])):n.val=et(String(n.val),W({data:e,param:"nol_xorSeed"})):"("!==t&&")"!==t||(n.val=z(n.val))}function nt(e,t,a){var n,r,i,o,s,l,d,c,u,p,m,v,f,g,_=t.match(/[\[\{<\(]/g),h=W({data:e,param:"nol_xorSeed"})||"";_=_?_.reverse():[],r=t.match(/[\}\]\>\)]/g)||[],o={start:_.length?t.lastIndexOf(String(_[0])):-1,end:r.length?t.indexOf(String(r[0])):t.length},r&&">"===r[0]&&(o.end=t.search(Je["<"].end)||t.indexOf(">")),u=(l=t.substring(o.start+1,o.end)).split("||");var P=$e.exec(l),y=P&&P.length>1?P[1]:l,b=null,L="",S=O()[e.get("nol_playerId")]||{};for(p=0,m=u.length;p<m&&(l=u[p],L=(b=$e.exec(u[p]))&&b.length>2&&b[2]?b[2].replace("_",""):"","string"!=typeof(v=Ze(e,l,S[y],{vidType:(a?a.vidType:null)||L,silent:!0,noClone:!0,end:!!a&&a.end,noEncode:!0}))&&(v=v.toString()),!(v&&v.length>0));p++);if(v&&v.length>0&&(g="string"==typeof l?l.split("_"):l,(s=S[f=Array.isArray(g)&&g.length>2&&l.indexOf("nol_")>-1&&("content"===g[g.length-1]||"ad"===g[g.length-1]||"static"===g[g.length-1])?g.splice(0,g.length-1).join("_"):l]?S[f].encoding:"")&&(_=_.reverse().concat(s.match(/[\[\{<\(]/g)).reverse(),r=r.reverse().concat(s.match(/[\}\]>\)]/g)).reverse())),n={val:v,state:W({data:e,param:"nolPriv_sendData"})},d=_?_.length:0,c=r?r.length:0,(i=Math.min(d,c))>0)for(p=0,m=i;p<m;p++)at(e,_[0]||r[0],t,n,h),_.shift(),r.shift();else!0!==(!!a&&a.silent)&&(!n.val||n.val&&n.val.length<=0)&&(n.state=!1,n.val="",it(e,{type:100,msg:l+" missing "+W({data:e,param:"nol_comment"})}));return{val:n.val,strManipulate:_,strManiEnd:r}}function rt(e,t,a,n){var r,i,o,s,l,d,c,u,p,m,v,f,g,_={val:"",state:W({data:e,param:"nolPriv_sendData"})},h=[],P=[],y=[],b="",O=W({data:e,param:"nol_xorSeed"});if(n=n||{},null!==(l=(t=t||W({data:e,param:"nol_url"})||"").match(Ye.regex)))for(p=0,m=l.length;p<m;p++)if(r=l[p]){if(h=[],b="",s=0,(o=(i=r.substr(Ye.length,r.length-2*Ye.length)).split("+"))&&o.length>1){for(v=0,f=o.length;v<f;v++)if(b=o[v],n.silent=!0,(d=nt(e,b,n)).strManipulate.length>0&&(s=h.length,P=[].concat(d.strManipulate,P)),h[s]=h[s]?h[s]+d.val:d.val,d.strManiEnd.length>0&&d.strManiEnd.length!==P.length){for(y=[].concat(y,d.strManiEnd),_={val:h[s],state:W({data:e,param:"nolPriv_sendData"})},c=0,g=d.strManiEnd.length;c<g;c++)at(e,P[0],b,_,O),P.shift(),y.shift();h[s]=_.val}for(_.val=h.join(""),c=0,g=(u=P.length>=y.length?P:y).length;c<g;c++)at(e,u[0],b,_,O),P.shift(),y.shift()}else _={val:(d=nt(e,i,n)).val,state:W({data:e,param:"nolPriv_sendData"})};t=t.replace(r,_.val)}return t}function it(e,t,a,n){var r,i,o=X(),s=W({data:e,param:"nolPriv_errorSent"});if(!0!==n&&W({data:e,param:"nolPriv_sendData",val:!1}),!a&&-1!==(!t||s.indexOf(t.type.toString())))return!1;W({data:e,param:"nol_errorMessage",val:r=t.type+","+z(t.msg)}),o._listeners.fireEvent("error",{type:"error",msg:r});var l=e.get("nol_errorURL");return l&&(t.msg&&(t.msg=encodeURIComponent(t.msg)),17===t.type&&(l=l.replace("|!(nol_errorMessage)!|",t.msg)),e.isProductOf(["mtvr","id3"])&&(l=l.replace("|![nol_sessionId_content]!|","")),i=rt(e,l),H(o,{serverTimeOffset:W({data:e,param:"nolPriv_serverTimeOffset"}),url:i,uoo:W({data:e,param:"nol_useroptout"}),maskRef:W({data:e,param:"nol_rfrmsk"}),method:j.getInstance().getRequestMethod(e)})),W({data:e,param:"nolPriv_errorSent",val:s+=t.type.toString()+","}),!0}function ot(e,t,a,n){var r=X(),i=j.getInstance(),o=be.getInstance(),s=L(),l=!1,d=i.findPlayer(e),c=d.fpSession,p=d.metadataCtrl;if(!n){var m=""===e.get("nol_fdcid")||i.mtvr.isNullFDCid(e)?e.get("nol_pccid"):e.get("nol_fdcid");if(e.isProductOf("mtvr")&&["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&"interval"===e.get("nol_cadence")&&""===e.get("nol_rtvod")&&"true"!==e.get("nol_disabled")&&e.get("nol_tsvURL"))if(dt(e,null,!0)){var v=tt(e);v&&(!function(e,t,a,n){Ve(n,{service:"tsv",key:m,url:n.get("nol_tsvURL")},(function(){ot(n,t,a,!0)})),Ve(e,{service:"tsv",key:m,url:e.get("nol_tsvURL")},(function(){}))}(e,t,a,v),l=!0)}}c&&c.allowCookies&&c.appendfData(e);var f,g,_,h,P,y=W({data:e,param:"nol_url"})||"",O=0,S=W({data:e,param:"nol_playerId"}),T=b(W({data:e,param:"nol_maxPingCount"}),"num"),C=b(W({data:e,param:"nol_pingCount"}),"num"),w=!!t&&t.returnLength,D=W({data:e,param:"nol_cadence"}),E=e.isProductOf("mtvr"),I=e.isProductOf(["dcrvideo","dcrstatic"]),k=e.isProductOf("dcrstatic"),R=r&&r.PLDCR&&r.PLDCR.focusTimer,F=i.getEventsFilter(e),A=b(W({data:e,param:"nol_maxLength"}),"num");if(W({data:e,param:"nol_pingCreationTime",val:ct(W({data:e,param:"nolPriv_serverTimeOffset"}))}),g=W({data:e,param:"nol_timeSpentViewing"}).content,_=W({data:e,param:"nol_timeSpentViewing"}).ad,h=W({data:e,param:"nol_timeSpentViewing"}).static,ut(W({data:e,param:"nol_segmentTimeSpent"})),(!e.isProductOf(["dcrvideo","vrivideo"])||"1"===W({data:e,param:"nol_forceFireOnClose_content"})||!(e.isProductOf(["dcrvideo","vrivideo"])&&0===g.nol_segmentTimeSpent||"dcrstatic"===W({data:e,param:"nol_product"})&&0===h.nol_segmentTimeSpent)||"interval"!==D&&"streamduration"!==D||0!==_.nol_count||0!==_.nol_segmentTimeSpent)&&"false"===W({data:e,param:"nol_disabled"})&&(0===T||T>C)){if(o.setNextTick(e,null,"content"),f=dt(e,t)||"stream"===D||"impression"===D||"id3"===W({data:e,param:"nol_product"}),W({data:e,param:"nol_random",val:Math.round(1e9*Math.random())}),k&&"interval"===D&&R&&e.set("nol_staticIntervalTimeElapsed",parseInt(R.timeElapsed)),(O=(y=rt(e,y)).length)<10)return null;if(W({data:e,param:"nolPriv_sendData"})&&f&&!w||A>0&&A<O){if(W({data:e,param:"nol_id3Data"})&&W({data:e,param:"nol_id3Data",val:!1}),Xe(W({data:e,param:"nol_comment"})," -queued @"+Math.floor(u()/1e3)+", timeOffset == "+W({data:e,param:"nolPriv_serverTimeOffset"})+", DU == "+W({data:e,param:"nol_segmentTimeSpent"})+" -- "),F.onSendPing&&(He(e,F.onSendPing),"true"===W({data:e,param:"nol_disabled"})))return;l||H(r,{serverTimeOffset:W({data:e,param:"nolPriv_serverTimeOffset"}),url:y,prod:W({data:e,param:"nol_product"}),uoo:W({data:e,param:"nol_useroptout"}),maskRef:W({data:e,param:"nol_rfrmsk"}),method:i.getRequestMethod(e)}),a&&a(e),p.metadataURL&&("impression"===D&&I||"episode"===D&&E)&&(p.metadataPing=rt(e,p.metadataURL),p.hasMetaPingFired||(H(r,{serverTimeOffset:W({data:e,param:"nolPriv_serverTimeOffset"}),url:p.metadataPing,prod:W({data:e,param:"nol_product"}),maskRef:W({data:e,param:"nol_rfrmsk"}),method:i.getRequestMethod(e)}),Xe("Metadata Ping -queued @".concat(Math.floor(u()/1e3),", timeOffset == ").concat(W({data:e,param:"nolPriv_serverTimeOffset"})," -- ").concat(p.metadataPing)),p.hasMetaPingFired=!0)),W({data:e,param:"nol_viewCount_"+e._currVidType.toLowerCase(),val:"0"}),o.clear(e),s&&s.hasOwnProperty(S)&&s[S].hasOwnProperty("debug")&&"logging"===s[S].debug&&((P=W({data:e,param:"nol_debugUrl"}))||(P=W({data:e,param:"nol_prefProtocol"})+"://nielsen.guru/validation/query_string.php?"),q(P=P+"pli="+S+"&sendPing="+W({data:e,param:"nol_product"})+"&"+y.substring(y.indexOf("?")+1))),C++,g.nol_segmentTimeSpent=0,g.nol_count=0,_.nol_segmentTimeSpent=0,_.nol_count=0,h.nol_segmentTimeSpent=0,h.nol_count=0,R&&R.timeElapsed&&(R.timeElapsed=0),W({data:e,param:"nolPriv_priority",val:0}),W({data:e,param:"nol_pingCount",val:C.toString()}),W({data:e,param:"nol_forceFireOnClose_content",val:"0"});var M=st(W({data:e,param:"nol_segmentLength"}));W({data:e,param:"nol_duration",val:new Array(M.length+1).join("0")})}else if(w)return{len:O,fData:y};return null}}function st(e){var t,a=[];for(t=0;t<b(e,"num");t++)a.push({tsv:0,save:!1,updated:!1});return a}function lt(e,t){var a=e||6;return Math.ceil(t/a)*a||"0"}function dt(e,t,a){var n,r,i=!1,o=0,s=!1,l=b(W({data:e,param:"nol_unQualSegmentValue"}),"num"),d=W({data:e,param:"nol_minutes"}),c=[],u=!!t&&t.save,p=b(W({data:e,param:"nol_segmentTimeSpent"}),"num"),m=b(W({data:e,param:"nol_sendQual"}),"num"),v=W({data:e,param:"nol_cadence"});for(n=0,r=d.length;n<r;n++)Math.floor(d[n].tsv/W({data:e,param:"nol_creditValue"}))>=1?(d[n].save&&"daypart"!==W({data:e,param:"nol_cadence"})?c.push(0):(c.push(W({data:e,param:"nol_creditFlag"})),o++,i=!0),s=!0):(c.push(0),s=!1),!0!==a&&(u?d[n].save=s:(d[n].tsv=0,d[n].save=!1,d[n].updated=!1));return m&&(i=o>=m),!0===b(W({data:e,param:"nol_minWonOverride"}),"bool")&&(i=!0),!0===a||(W({data:e,param:"nol_duration",val:c.join("")}),i||"interval"!==v&&"streamduration"!==v||u||("S"===W({data:e,param:"nol_segmentPrefix"})&&l&&W({data:e,param:"nol_duration",val:lt(l,p)}),i=p>1)),i}function ct(e){return void 0!==e?(u()/1e3|0)+e:u()/1e3|0}function ut(e){if(Number(e)===e&&e%1!=0){var t=m.getInstance();t&&t.logWarn("Warning: nol_segmentTimeSpent is a float - should be an integer.")}}function pt(e,t){try{if("1"===W({data:e,param:"nol_unifiedEnabled"})){var a=t&&t.hasOwnProperty("vidType")?t.vidType:e._currVidType.toLowerCase(),n=b(W({data:e,param:"nol_viewCount_"+a}),"num");W({data:e,param:"nol_viewCount_"+a,val:n++}),"1"===W({data:e,param:"nol_applyViewInc"})&&W({data:e,param:"nol_applyViewInc",val:"0"})}}catch(e){X()._listeners.fireEvent("error",{type:"error",msg:"Error in incViewCnt"+e})}}function mt(e){try{if(void 0===e)return;var t=st(W({data:e,param:"nol_segmentLength"}));W({data:e,param:"nol_minutes",val:t}),W({data:e,param:"nol_duration",val:new Array(t.length+1).join("0")})}catch(e){X()._listeners.fireEvent("error",{type:"error",msg:"Error in resetMinutes(). Error - "+e.message})}}function vt(e,t){var a=b(W({data:e,param:"nol_segmentLength"}),"num")*b(W({data:e,param:"nol_segmentValue"}),"num");return{segmentEnd:0===Math.floor(t%a),segment:Math.floor(t/a+1),minute:Math.floor(t%a/W({data:e,param:"nol_segmentValue"})),seconds:t%W({data:e,param:"nol_segmentValue"})}}function ft(e,t,a){var n,r,i,o,s,l,d,c,p,m,v,f,g,_,h,P,y=X(),O=j.getInstance(),L=W({data:t,param:"nol_tagSrc"}),S=(e=""!==e?e:"id3"===L&&W({data:t,param:"nol_fdcid"})!==W({data:t,param:"nol_cidNull"})?W({data:t,param:"nol_fdoffset"}):"id3"===L&&W({data:t,param:"nol_pccid"})!==W({data:t,param:"nol_cidNull"})?W({data:t,param:"nol_pcoffset"}):e,O.getEventsFilter(t)),T=W({data:t,param:"nol_minutes"}),C=b(W({data:t,param:"nol_pingCount"}),"num"),w=W({data:t,param:"nol_playerId"}),D=y._players&&y._players.hasOwnProperty(w)?y._players[w]:-1,E=W({data:t,param:"nol_localDay"}),I=W({data:t,param:"nol_dayQhr"}),k=W({data:t,param:"nol_weekQhr"}),R=W({data:t,param:"nol_wmDay"}),F=W({data:t,param:"nol_wmDayQhr"}),A=b(W({data:t,param:"nol_weekEndUTC"}),"num"),M=A-b(W({data:t,param:"nol_weekStartUTC"}),"num"),x=b(W({data:t,param:"nolPriv_serverTimeOffset"}),"num"),V=W({data:t,param:"nol_timer"})||"nol_fdoffset",G=b(W({data:t,param:"nolPriv_currMin"}),"num"),N=b(W({data:t,param:"nol_maxPingCount"}),"num"),B=b(W({data:t,param:"nol_creditValue"}),"num"),U=b(e,"num"),Q=b(W({data:t,param:"nol_intrvlThrshld"}),"num")||86400,H="nol_cmsoffset"===V||"nol_pageoffset"===V?b(W({data:t,param:"nol_cmsIntrvlGp"}),"num")||2:b(W({data:t,param:"nol_id3IntrvlGp"}),"num"),q=b(W({data:t,param:"nol_segmentLength"}),"num")*b(W({data:t,param:"nol_segmentValue"}),"num"),z=b(W({data:t,param:"nol_currSeg"}),"num"),K=b(W({data:t,param:"nolPriv_now"}),"num"),J=W({data:t,param:"nol_timeSpentViewing"})[t._currVidType],Y=t.get("nolPriv_currPos"),$=""===Y,Z=!1,ee=!1;if(t.set("nolPriv_prevPos",t.get("nol_currPos")),1===e?t.set("nol_currPos","0"):t.set("nol_currPos",e),"modcadence"===t.get("nol_cadence"))e%t.get("nol_segmentValue")==0&&(e<t.get("nol_length")||!t.get("nol_length"))&&ot(t,null,a&&a.onPingFired?a.onPingFired:null);else{if(f=Math.floor(U/86400)+1,R||W({data:t,param:"nol_wmDay",val:f}),g=Math.floor(U%86400/900)+1,F||W({data:t,param:"nol_wmDayQhr",val:g}),U>86400&&"nol_cmsoffset"===V?d=(U+=x)+b(W({data:t,param:"nol_startDayTimeOffset"}),"num")+b(W({data:t,param:"nol_GMTOffset"}),"num"):d=U,p=Math.floor(d/86400)+1,E&&E!=p&&(ot(t,null,a&&a.onPingFired?a.onPingFired:null),E=null),E||W({data:t,param:"nol_localDay",val:p}),U>A&&(S.onWeekEndUTC?He(t,S.onWeekEndUTC):(W({data:t,param:"nol_week",val:W({data:t,param:"nol_nextWeek"})}),W({data:t,param:"nol_period",val:W({data:t,param:"nol_nextPeriod"})}),W({data:t,param:"nol_weekStartUTC",val:A+1}),W({data:t,param:"nol_weekEndUTC",val:A+1+M}))),m=Math.floor((U-b(W({data:t,param:"nol_weekStartUTC"}),"num"))/900)+1,k&&m===k||W({data:t,param:"nol_weekQhr",val:m}),"nol_cmsoffset"===V&&(U=d%86400),v=Math.floor(U/900)+1,I||W({data:t,param:"nol_dayQhr",val:v}),U=Math.floor(U),"1"===W({data:t,param:"nol_applyViewInc"})&&(pt(t),W({data:t,param:"nol_applyViewInc",val:"0"})),"true"===W({data:t,param:"nol_disabled"})||void 0===U||N>0&&N<=C&&"daypart"!==W({data:t,param:"nol_cadence"}))return;if("stream"!==W({data:t,param:"nol_cadence"})&&"impression"!==W({data:t,param:"nol_cadence"})){Y=$?U:b(Y,"num"),K||(K=u()),h=Math.ceil((u()-K)/1e3)||1,n=(P=vt(t,t.isProductOf(["mtvr","id3","dcrvideo"])?Y:U)).segment,_=P.minute,r=P.seconds,Z=U-Y<0,l=t.isProductOf("mtvr")?U-Y:$&&0!==Y||Z?1:U-Y;var te=($||Z)&&z!==n;if(W({data:t,param:"nolPriv_currPos",val:U}),(z&&void 0!==n&&z!==n&&"dcrvideo"===t.get("nol_product")&&t.get("nol_segmentTimeSpent")>0||z&&void 0!==n&&(!t.isProductOf(["mtvr","id3"])&&te||t.isProductOf(["mtvr","id3"])&&(z!==n||Z&&t.get("nol_segmentTimeSpent")>t.get("nol_segmentValue")&&"daypart"!==W({data:t,param:"nol_cadence"}))))&&(("dcrvideo"!==W({data:t,param:"nol_product"})||"dcrvideo"===W({data:t,param:"nol_product"})&&W({data:t,param:"nol_segmentTimeSpent"})>0)&&ot(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),"episode"!==W({data:t,param:"nol_cadence"})&&W({data:t,param:"nol_pingCount",val:0}),T=st(W({data:t,param:"nol_segmentLength"})),W({data:t,param:"nol_minutes",val:T}),I&&I!==v&&(W({data:t,param:"nol_dayQhr",val:v}),W({data:t,param:"nol_weekQhr",val:m}),E&&E!==p&&W({data:t,param:"nol_localDay",val:p})),F&&F!==g&&W({data:t,param:"nol_wmDayQhr",val:g}),R&&R!==f&&W({data:t,param:"nol_wmDay",val:f})),z=n,void 0!==_&&l>0){if(G===_||P.segmentEnd||T[_].save||"daypart"===W({data:t,param:"nol_cadence"})||(T[_].tsv>=B?ot(t,null,a&&a.onPingFired?a.onPingFired:null):(T[_].tsv=0,T[_].updated=!1)),l<H||l<=Math.ceil(1.5*h)&&l<Q){var ae=function(){for(i=0;i<l;i+=1){if(t.isProductOf(["mtvr","id3"])&&(r+i)%W({data:t,param:"nol_segmentValue"})!=0||!t.isProductOf(["mtvr","id3"])&&0!==r){if("daypart"!==W({data:t,param:"nol_cadence"})&&T[_].tsv>=W({data:t,param:"nol_segmentValue"})&&(T[_].save?(T[_].tsv=0,T[_].save=!1,T[_].updated=!1):t.isProductOf(["dcrstatic"])||ot(t,null,a&&a.onPingFired?a.onPingFired:null)),T[_].tsv+=1,J.nol_cumeTimeSpent=J.nol_cumeTimeSpent+1,J.nol_segmentTimeSpent=J.nol_segmentTimeSpent+1,T[_].tsv>=B&&c){for(T[_].updated||(W({data:t,param:"nolPriv_priority",val:u()}),T[_].updated=!0),o=0,s=0;o<T.length;o+=1)if((s+=T[o].tsv>=B?1:0)>=c){c="send";break}"send"===c&&W({data:t,param:"nol_sendQual"})&&(S.onViewWon&&He(t,S.onViewWon),t.isProductOf(["dcrstatic"])||ot(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),c=0,"daypart"!==W({data:t,param:"nol_cadence"})&&W({data:t,param:"nol_sendQual",val:"0"}))}}else 0!==i&&(_+=1),T.length<=_?(ot(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),_=0,W({data:t,param:"nol_currSeg",val:z+=1}),W({data:t,param:"nol_pingCount",val:0}),T=st(W({data:t,param:"nol_segmentLength"})),W({data:t,param:"nol_minutes",val:T}),I&&I!==v&&(W({data:t,param:"nol_dayQhr",val:v}),W({data:t,param:"nol_weekQhr",val:m}),E&&E!==p&&W({data:t,param:"nol_localDay",val:p})),F&&F!==g&&W({data:t,param:"nol_wmDayQhr",val:g}),R&&R!==f&&W({data:t,param:"nol_wmDay",val:f})):"daypart"!==W({data:t,param:"nol_cadence"})&&!T[_].save&&T[_].tsv>=B&&(!P.segmentEnd||t.isProductOf(["mtvr","id3"]))?ot(t,null,a&&a.onPingFired?a.onPingFired:null):T[_].save||P&&P.segmentEnd&&t.isProductOf(["dcrvideo"])||(T[_].tsv=1,T[_].updated=!1),J.nol_cumeTimeSpent=J.nol_cumeTimeSpent+1,J.nol_segmentTimeSpent=J.nol_segmentTimeSpent+1;t.set("nolPriv_currMin",_),a&&a.onTick&&a.onTick(U-(l-i)+1,J.nol_cumeTimeSpent)}};c=b(W({data:t,param:"nol_sendQual"}),"num"),a&&a.onCalcStart&&"function"==typeof a.onCalcStart?a.onCalcStart(U,ae):ae()}else t.isProductOf("dcrvideo")&&(J.nol_cumeTimeSpent=J.nol_cumeTimeSpent+1,J.nol_segmentTimeSpent=J.nol_segmentTimeSpent+1),ee=!0;t.isProductOf(["mtvr","id3"])||!P||!P.segmentEnd||$||ee||Z||(("dcrvideo"!==W({data:t,param:"nol_product"})||"dcrvideo"===W({data:t,param:"nol_product"})&&W({data:t,param:"nol_segmentTimeSpent"})>1)&&ot(t,{save:!0},a&&a.onPingFired?a.onPingFired:null),"episode"!==W({data:t,param:"nol_cadence"})&&W({data:t,param:"nol_pingCount",val:0}),T=st(W({data:t,param:"nol_segmentLength"})),W({data:t,param:"nol_minutes",val:T}),I&&I!==v&&(W({data:t,param:"nol_dayQhr",val:v}),W({data:t,param:"nol_weekQhr",val:m}),E&&E!==p&&W({data:t,param:"nol_localDay",val:p})),F&&F!==g&&W({data:t,param:"nol_wmDayQhr",val:g}),R&&R!==f&&W({data:t,param:"nol_wmDay",val:f})),W({data:t,param:"nolPriv_now",val:u()}),-1!==D&&"dcrstatic"!==W({data:t,param:"nol_product"})&&(D.pauseObj.pauseTime=0)}}else n=Math.floor(U/q+1),"content"===W({data:t,param:"nol_ac"})&&W({data:t,param:"nol_currSeg",val:z=n}),ot(t,null,a&&a.onPingFired?a.onPingFired:null);W({data:t,param:"nol_currSeg",val:z})}}function gt(e,t,a){var n=W({data:e,param:"iag_"+t});return void 0!==n&&""!==n?a="&pr=iag."+t+","+z(n):a&&a.length>0&&-1===a.indexOf("&pr=iag")?a="&pr=iag."+t+","+z(a):null==a&&(a=""),a}function _t(e,t){var a,n,r,i,o,s,l,d,c,u,p,m,v,f,g,_,h=W({data:e,param:"nol_vidtype"});W({data:e,param:"nol_prod"}).indexOf("iag")>=0&&(a="",n=gt(e,"sid",W({data:e,param:"nol_sid",vidType:"content"})),r=gt(e,"tfid",W({data:e,param:"nol_tfid",vidType:"content"})),i=gt(e,"bcr",W({data:e,param:"nol_clientid",vidType:"content"})),s=gt(e,"epi",W({data:e,param:"nol_title"})||W({data:e,param:"nol_title",vidType:"content"})),(o=gt(e,"pgm",W({data:e,param:"nol_censuscategory"})||W({data:e,param:"nol_category"})||W({data:e,param:"nol_iagcategory"})))||(o=gt(e,"pgm",W({data:e,param:"nol_censuscategory",vidType:"content"})||W({data:e,param:"nol_category",vidType:"content"})||W({data:e,param:"nol_iagcategory",vidType:"content"})))||(o="&pr=iag.pgm,general"),l="&pr=iag.seg,",b(W({data:e,param:"nol_chapter",vidType:"content"}),"num")>1?l+=W({data:e,param:"iag_seg"})||W({data:e,param:"nol_chapter",vidType:"content"}):l+="1",d=gt(e,"pd",d),c=gt(e,"oad",c),v=gt(e,"fp",v),_=gt(e,"cust1",_),"ad"===t?(u="&pr=iag.brn,"+W({data:e,param:"nol_clientid"}),p="&pr=iag.cte,"+z(W({data:e,param:"nol_adURL"})),m="midroll"===h?"&pr=iag.ap,mid":"postroll"===h?"&pr=iag.ap,post":"&pr=iag.ap,pre",n=gt(e,"sid",n),r=gt(e,"tfid",r),i=gt(e,"bcr",i),u=gt(e,"brn",u),p=gt(e,"cte",p),a=n+r+i+(o=gt(e,"pgm",o))+(s=gt(e,"epi",s))+(l=gt(e,"seg",l))+(d=gt(e,"pd",d))+u+m+p+(c=gt(e,"oad",c))+v+(f=gt(e,"pod",f))+(g=gt(e,"apt",g))+_):a=n+r+i+o+s+l+d+c+v+_,W({data:e,param:"nol_iagData",val:a+="&pr=iag.cp,soc"}))}var ht=function(e){var t=e.dataFunc,n=j.getInstance(),r=L(),i=O(),o={};return o.dtvr=o.dtvr||{_state:{current:{metaData:[]},new:null,index:0},compareMetaData:function(e,t){for(var a=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t),r=[],i=a.length>n.length?a.slice():n.slice(),o=0;o<i.length;o++){var s=i[o];e[s]!==t[s]&&r.push(s)}return r.length?"End event must be called before loading new metadata. The following parameters will not be updated: ".concat(r.join()):""},updateState:function(){"object"===a(this._state.new._param3)&&null!==this._state.new._param3&&(this._state.current.metaData[this._state.index]=this._state.new._param3,this._state.index++),"string"==typeof this._state.new._param3&&-1!==this._state.new._param3.indexOf("www.nielsen.com")&&(this._state.current.id3=this._state.new._param3),this._state.current.prevEvent=this._state.new.prevEvent,this._state.new=null}},o.dtvr.preHandleGgpm=null,o.dtvr.postHandleGgpm=null,o.dtvr.preQueueGgpm=function(){},o.dtvr.postQueueGgpm=function(){this._state.new&&this.updateState()},o.dtvr.handleGgpm=function(e,o,s){var l,d,c,p,v,f,g,_,h,P,y,O,L=X(),S=m.getInstance(),T=L.PLDPR._id3Map||{},C=o.evtInfo,w=C.param1,D=C.param3?C.param3:w.hasOwnProperty("param3")?w.param3:w,E=C.param2||"",I=t({data:e,param:"nol_playerId"}),k=i[I]||{},R=t({data:e,param:"nol_enableFilterMap"}),F=C.eventType.toString().toLowerCase(),A=n.getEventsFilter(e),M=n.findPlayer(e),x=b(t({data:e,param:"nolPriv_id3Count"}),"num"),V=t({data:e,param:"nolPriv_serverTimeOffset"}),G=t({data:e,param:"nol_prod"}),j={filters:{onId3PcCidChanged:!1,onId3FdCidChanged:!1},count:0,filterType:"old"},N="nol_assetid",B={},U={onCalcStart:function(t,a){e.isProductOf(["mtvr","id3"])&&s&&s.tickViewability&&"function"==typeof s.tickViewability?s.tickViewability(e,t,a):a&&a()},onPingFired:function(e){s&&s.resetViewability&&s.resetViewability(e),e.isProductOf(["mtvr","id3"])&&s&&s.tickViewability&&"function"==typeof s.tickViewability&&s.tickViewability(e,e.get("nolPriv_currPos"))}};switch(this._state.new||(this._state.new={},this._state.new._param3=D),F){case"3":case"15":case"loadmetadata":var Q=String(n.cms.parse(k.nol_assetid,e,{metadata:D,defaultKey:"nol_assetid",silent:!0})),H=!0===t({data:e,param:"nol_onCompleteFired"});if(D.nol_ac=e._currVidType,b(t({data:e,param:"nol_serverTime"}),"num")+86400<Math.round(u()/1e3)+V){ze(e,U.onPingFired),Me(o,t({data:e,param:"nol_playerId"}));break}if(("15"===F||"loadmetadata"===F)&&"id3"===t({data:e,param:"nol_product"})&&t({data:e,param:"nol_id3Data"})){ot(e,null,U&&U.onPingFired?U.onPingFired:null);break}if(e&&e._dataArrObj&&e._dataArrObj.content&&"object"===a(e._dataArrObj.content)&&!e._dataArrObj.content[0]&&!e._dataArrObj.content[e._currAssetid]){Ae(e,"loadMetadata",D,s),t({data:e,param:"nol_disabled",val:"true"});break}var q=Q!==t({data:e,param:N});if(this._state.assetIdChanged=q,"false"===t({data:e,param:"nol_disabled"})&&!H&&!q&&!this._state.new.noEndErr){if(this._state.current.metaData.length){var W=this.compareMetaData(this._state.current.metaData[this._state.index-1],D);W&&it(e,{type:17,msg:W},!0,!0)}else it(e,{type:17,msg:"End event must be called before loading new metadata."},!0,!0);this._state.new.noEndErr=!0}if(q)for(O in"ad"!==t({data:e,param:"nol_ac"})&&ze(e,U.onPingFired),D)D.hasOwnProperty(O)&&t({data:e,param:String(O),val:String(D[O])});t({data:e,param:"nol_pingStartTimeUTC",val:Math.round(u()/1e3)}),-1!==G.indexOf("iag")&&_t(e,e._currVidType);break;case"5":case"play":if(D[l=k.nol_channelName?k.nol_channelName.clientField:"nol_channelName"]&&D[l].length>0)for(O in D)D.hasOwnProperty(O)&&t({data:e,param:O,val:D[O]});break;case"55":case"sendid3":var z=w.toString().split("/"),K=z[1],J=z[2],Y=n.mtvr.fdChanged(e,J),$=n.mtvr.pcChanged(e,K),Z=J===t({data:e,param:"nol_cidNull"}),ee=n.mtvr.isPCTag(e),te=!0===t({data:e,param:"nol_onCompleteFired"}),ae="1"===e.get("nol_fdrtvod");if("15"===this._state.current.prevEvent||"loadmetadata"===this._state.current.prevEvent){var ne=this._state.current.metaData[this._state.index-1];if(te){if(Y||$&&Z||$&&!Z&&(ae||ee))t({data:e,param:N,val:-1}),mt(e),We({data:e,savedVals:["nol_nielsenAdSupportFlg"],savedReplayParams:{}});else if(!this._state.assetIdChanged)for(O in ne)ne.hasOwnProperty(O)&&t({data:e,param:String(O),val:String(ne[O])});t({data:e,param:"nol_onCompleteFired",val:!1})}e&&e._dataArrObj&&e._dataArrObj.content&&"object"===a(e._dataArrObj.content)&&!e._dataArrObj.content[0]&&!e._dataArrObj.content[e._currAssetid]&&(Ae(e,"loadMetadata",ne,s),t({data:e,param:"nol_disabled",val:"true"}))}"57"!==this._state.current.prevEvent&&"end"!==this._state.current.prevEvent&&"oncomplete"!==this._state.current.prevEvent||(Y||$&&Z||$&&!Z&&(ae||ee))&&mt(e);var re=!1,ie=!1;if(("object"===a(w)&&Object.keys(w).length>0||"string"==typeof w&&w.length>0)&&((!0===t({data:e,param:"nol_onCompleteFired"})&&M&&M.getPauseQueueCount&&M.getPauseQueueCount()>0||!0===t({data:e,param:"nol_onCompleteFired"})&&M&&!M.getPauseQueueCount)&&L._listeners.fireEvent("flushPauseEventQueue"),"object"===a(w)))for(y=0;y<w.length;y+=1)if(w[y].key&&"PRIV"===w[y].key){w=w[y].info;break}if(249!==(p=w.toString()).length&&(this._state.id3LengthErr||(it(e,{type:17,msg:"ID3 tag length is not 249. ID3 Tag: ".concat(p)},!0,!0),S&&S.logWarn("Warning: ID3 tag length is not 249."),this._state.id3LengthErr=!0)),w={},(c=p.split("/")).length<b(T.nol_breakout,"num"))return;for(O in(parseInt(c[4])>86400||parseInt(c[5])>86400)&&(this._state.offsetErr||(it(e,{type:17,msg:"Invalid offset value, offsets received - PC: ".concat(c[4],", FD: ").concat(c[5])},!0,!0),this._state.offsetErr=!0)),T)T.hasOwnProperty(O)&&(w[O]=c[T[O]],"nol_breakout"===O&&(w[O]=c[b(T[O],"num")].substr(0,2)),B[O]=w[O]);if(!w||t({data:e,param:"nol_tsvBreakoutMap"})&&-1===t({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(w.nol_breakout)||-1===w.nol_nWebAddress.indexOf("nielsen.com")||w.nol_fdcid===t({data:e,param:"nol_cidNull"})&&w.nol_pccid===t({data:e,param:"nol_cidNull"}))return;for(e._currVidType="content",P=0,y=R.length;P<y;P+=1)d=k[R[P]]?k[R[P]].clientField:R[P],B[R[P]]=w[d]||t({data:e,param:R[P]});if(B.nol_vidtype="content",He(e,A.onId3Detected,B),"false"!==B.nol_disabled||"nol_cmsoffset"===t({data:e,param:"nol_timer"}))return;if("daypart"===t({data:e,param:"nol_cadence"})){var oe=t({data:e,param:"nol_assetid"})||e._currAssetid;!oe&&w.nol_fdcid&&w.nol_fdcid!==t({data:e,param:"nol_cidNull"})?e._currAssetid=w.nol_fdcid:!e._currAssetid&&oe&&(e._currAssetid=oe)}w.nol_ac=e._currVidType,w.nol_assetid=t({data:e,param:"nol_assetid"})||e._currAssetid,x>0&&(-1!==t({data:e,param:"nol_product"}).indexOf("id3")||-1!==t({data:e,param:"nol_product"}).indexOf("mtvr"))&&(w.nol_pccid!==t({data:e,param:"nol_cidNull"})&&w.nol_pccid!==t({data:e,param:"nol_pccid"})||w.nol_fdcid!==t({data:e,param:"nol_cidNull"})&&w.nol_fdcid!==t({data:e,param:"nol_fdcid"}))&&(Y||$&&Z||$&&!Z&&(ae||ee))&&ot(e,null,U.onPingFired,!0);var se=n.mtvr.pcChanged(e,w.nol_pccid),le=n.mtvr.fdChanged(e,w.nol_fdcid);if(se&&(n.mtvr.isPCTag(e)||n.mtvr.isTransPing(e))&&(j.filters.onId3PcCidChanged=!0,j.count=j.count+1,s&&s.startViewability(e),(le||n.mtvr.isNullFDCid(e))&&e.set("nol_id3Seq",0)),le&&(n.mtvr.isFDTag(e)||n.mtvr.isTransPing(e))&&(j.filters.onId3FdCidChanged=!0,j.count=j.count+1,s&&s.startViewability(e),e.set("nol_id3Seq",0)),le&&n.mtvr.isPCTag(e)&&(re=!0),""===e.get("nol_fdrtvod")||"0"===e.get("nol_fdrtvod")||!n.mtvr.isPCTag(e)&&!n.mtvr.isFDTag(e)||n.mtvr.isNullPCCid(e)||""===e.get("nol_pccid")||n.mtvr.isNullFDCid(e)||""===e.get("nol_fdcid")||!se||(ie=!0,n.mtvr.isFDTag(e)&&A&&A.onId3FdCidChanged&&He(e,A.onId3FdCidChanged)),j.count){if(Ae(e,"sendID3",w,s),!j.filters.onId3FdCidChanged&&t({data:e,param:"nol_fdcid"})!=t({data:e,param:"nol_cidNull"})||-1===t({data:e,param:"nol_tsvBreakoutMap"}).enable.indexOf(w.nol_breakout)||(e.serviceFlag.tsv.need=!0),j.count>0)for(O in j.filters)if(j.filters[O]&&(He(e,A[O]),"true"===t({data:e,param:"nol_disabled"})))return;if(A.onComplete&&(He(e,A.onComplete),"true"===t({data:e,param:"nol_disabled"})))return}else{for(O in w)w.hasOwnProperty(O)&&t({data:e,param:O,val:w[O]});if("true"===t({data:e,param:"nolPriv_enableDtvr"})&&("true"===t({data:e,param:"nol_disabled"})&&t({data:e,param:"nol_disabled",val:"false"}),t({data:e,param:"nolPriv_enableDtvr",val:"false"}),e&&e._dataArrObj&&e._dataArrObj.content&&"object"===a(e._dataArrObj.content)&&e._dataArrObj.content[e._currAssetid]&&void 0!==e._dataArrObj.content[e._currAssetid].nol_davty)){var de=t({data:e,param:"nol_defaults"}).nol_davty;null!=de&&t({data:e,param:"nol_davty",val:de})}}if((le&&n.mtvr.isFDTag(e)||se&&n.mtvr.isPCTag(e))&&e.isProductOf("mtvr")&&"impression"===e.get("nol_cadence")&&"false"===e.get("nol_disabled")){var ce=r[I].nolPriv_newMTVRStreamId;r[I].nolPriv_newMTVRStreamId=ce&&r[I].restEvtTimestamp==o.timeStamp?ce:L.generateGUID(),n.mtvr.resetTagSession(e,r[I].nolPriv_newMTVRStreamId),r[I].restEvtTimestamp=o.timeStamp,L._listeners.fireEvent("debug",{type:"debug",msg:e.get("nol_comment")+" new mtvr session is "+ce})}if((e.isProductOf("mtvr")||e.isProductOf("id3"))&&"false"===e.get("nol_disabled")&&r[I].restEvtTimestamp!=o.timeStamp){var ue=r[I].nolPriv_newMTVRStreamId;ue&&ue!==e.get("nol_sessionId","content")&&n.mtvr.resetTagSession(e,ue)}if(t({data:e,param:"nol_id3Raw",val:p}),(e.serviceFlag.tsv.need||re||ie)&&-1!=="|mtvr|,|dprid3|,|id3|".indexOf("|"+t({data:e,param:"nol_product"})+"|")&&"false"===e.get("nol_disabled")&&(["true","1"].indexOf(e.get("nol_rtvodEnabled").toString().toLowerCase())>-1&&e.set("nol_rtvod",""),v=ie?t({data:e,param:"nol_pccid"}):re||!0!==j.filters.onId3PcCidChanged||n.mtvr.isNullPCCid(e)?t({data:e,param:"nol_fdcid"}):t({data:e,param:"nol_pccid"}),e.get("nol_tsvURL")&&Ve(e,{service:"tsv",key:v,url:t({data:e,param:"nol_tsvURL"})})),(e.isProductOf("id3")||e.isProductOf("mtvr")&&"interval"===e.get("nol_cadence")&&"false"===e.get("nol_disabled"))&&w.nol_watermark&&String(w.nol_watermark).length>0&&(g=t({data:e,param:"nol_id3Data"}),_=Math.round(u()/1e3+V),h=t({data:e,param:"nol_id3Seq"})||0,g?t({data:e,param:"nol_id3Data",val:g=g+"|"+_+","+t({data:e,param:"nol_id3Raw"})}):(t({data:e,param:"nol_id3Data",val:h+":"+t({data:e,param:"nol_clocksrc"})+":"+t({data:e,param:"nol_tsvFlag"})+":"+_+","+t({data:e,param:"nol_id3Raw"})}),t({data:e,param:"nol_id3Seq",val:b(h,"num")+1,vidType:"content"})),e.isProductOf("id3")))return x>0&&ot(e,{returnLength:!0},U.onPingFired),t({data:e,param:"nolPriv_id3Count",val:x+=1}),t({data:e,param:"nol_davState",val:"1"}),void(this._state.new.prevEvent=F);if(t({data:e,param:"nolPriv_id3Count",val:x+=1}),f=t({data:e,param:t({data:e,param:"nol_timer"})})||t({data:e,param:"nol_fdoffset"}),"daypart"===t({data:e,param:"nol_cadence"})&&(f=b(f,"num"),f+="nol_pcoffset"==t({data:e,param:"nol_timer"})?b(t({data:e,param:"nol_pcTimeCode"}),"num"):b(t({data:e,param:"nol_fdTimeCode"}),"num")),e.serviceFlag.tsv.need)t({data:e,param:"nol_queueTime",val:f});else{if("true"===t({data:e,param:"nol_disabled"}))return;ft(f,e,U),t({data:e,param:"nol_davState",val:"1"})}M&&M.sivt&&M.sivt.initialized&&M.sivt.addSIVTTag&&M.sivt.initialized()&&"impression"===e.get("nol_cadence")&&M.sivt.dtvrInit&&!M.sivt.dtvrInit()&&M.sivt.addSIVTTag(e),(le&&n.mtvr.isFDTag(e)||se&&n.mtvr.isPCTag(e))&&(n.mtvr.isPCTag(e)&&"false"===e.get("nol_disabled")?s&&s.tickViewability(e,w.nol_pcoffset):n.mtvr.isFDTag(e)&&"false"===e.get("nol_disabled")&&s&&s.tickViewability(e,w.nol_fdoffset));break;case"57":case"end":case"oncomplete":"static"!==t({data:e,param:"nol_ac"})&&(e._currVidType="content"),A.onEndDetected&&"false"===e.get("nol_disabled")&&He(e,A.onEndDetected),t({data:e,param:"nol_forceFireOnClose_content",val:"1"}),"false"!==t({data:e,param:"nol_disabled"})&&"id3"!==t({data:e,param:"nol_product"})||ze(e,U.onPingFired),t({data:e,param:"nol_onCompleteFired",val:!0}),r[I].forceStreamRegen=!0,"sessionReset"!==E&&M.disablePauseTimeout()}this._state.new.prevEvent=F},o};function Pt(){try{exports.firePingCallbackQueue.length&&(exports.firePingCallbackQueue.forEach((function(e){e&&e()})),exports.firePingCallbackQueue=[])}catch(e){}}function yt(e,t,a,n){var r=X();a&&!a.serviceSending[t]?(a.serviceSending[t]=!0,C(e.replace("fmt=jsonp","fmt=json"),{method:"GET"}).then((function(e){if(e&&e.status&&200===parseInt(e.status)){var t={};try{t=JSON.parse(e.response)}catch(e){}t.nol_playerId=a.id,r._listeners.fireEvent("tsvupdate",t)}else r._listeners.fireEvent("tsvupdate",{nol_playerId:a.id,nol_rtvodEnabled:!1});n&&n&&n(),Pt()}))):n&&exports.firePingCallbackQueue.push(n)}function bt(e){return e&&e.target&&e.target.hasOwnProperty("msg")?e.target.evtType?e.target.msg+" - (".concat(Math.floor(Date.now()/1e3),")"):e.target.msg:""}exports.firePingCallbackQueue=[];var Ot=null;exports.BsdkInstance=function(t,a,n,r){var i=(n&&n.protocol?n.protocol:"https")+"://"+(n&&void 0!==n.configEnv?n.configEnv:"cdn-gl.imrworldwide.com")+"/"+(n&&n.configPath?n.configPath:"conf")+"/",s=null,l=!1,d=null,c=function(){return new Promise((function(i){null===d&&(d=m.getInstance({implementationHooks:r})),null===Ot&&(Ot=y()),null===s&&(s=h(Ot,t,function(t){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?e(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:a},n))),null!==d&&null!==s&&i()})).catch((function(e){var t="Error assigning interface: ".concat(e);if(!d)throw new Error(t);d.logError(t)}))},u=function(e){var n=i+t+".json";return d.fetchUrl(n,{method:"GET",cache:"no-cache",credentials:"include",mode:"no-cors"}).then((function(e){return function(e){if("string"!=typeof e)return!1;try{JSON.parse(e)}catch(e){return!1}return!0}(e)?e:e.json()})).then((function(e){var n,r,i;n=t,r=e,(i=Ot).configs=i.configs||{},i.configs[n]=i.configs[n]||r;try{if(Ot&&a){var o=M.getStaticInstance().getInstance(a,!0);if(o&&!o.initialized)return o.ggInitialize(s),Promise.resolve(o)}}catch(e){d&&d.logError("Nielsen Log: Error initializing SDK ",e.stack)}})).catch((function(e){throw d&&d.logError("There has been a problem with your fetch operation:",e),e}))};if(!l)return new Promise((function(e,t){c().then((function(){return new Promise((function(e){e({})}))})).then((function(e){return u()})).then((function(t){l=!0,e(t)})).catch((function(e){t(e)}))})).then((function(e){return Promise.resolve(e)})).catch((function(e){return d&&d.logError("Error initializing SDK: ",e),Promise.reject(e)}))},exports.CMB=Pe,exports.Data=W,exports.GLCFG=$,exports.LibLoader=Z,exports.PLCMB=function(e){var t=e.glcfg,a=m.getInstance(),n={built:!1},r=e.global,i=t.getBaseBuildVer?t.getBaseBuildVer()+"3":"6.0.03";function o(e){var t,a,o,s,l,c,u,m=X(),v=e,g=i,_=0,h=!1,P=5,y="",b=1300,O=0,L="",S="",T="",C="",w="",D="",E=0,I=!1,k=0,R=0,F="",A="",M={},x=0,V="",G=-1,j=0,N=0,B=0,U=[0,0],Q=0,H=0,q={CS:new Array(0,0),PA:new Array(0,0),PL:new Array(0,0),SA:new Array(0,0),FA:new Array(0,0),SI:new Array(0,0),SR:new Array(0,0),SK:new Array(0,0),CI:new Array(0,0),DI:new Array(0,0),ER:new Array(0,0),SV:new Array(0,0),SH:new Array(0,0),PB:new Array(0,0),II:new Array(0,0),VL:new Array(0,0),PM:new Array(0,0),FP:new Array(0,0),MI:new Array(0,0),Title:new Array("",""),SS:new Array(0,0)},W=!1,z=[],K=r.location.protocol||"http:",J=this,Y=[];function $(e,t){var a=Number(e),n=Number(t),r=1;return a<n?r=-1:a==n&&(r=0),r}function Z(){var e;z=y.split(",");var t=[];for(e=0;e<z.length;e++)isNaN(z[e])&&(t=z[e].split("%"),isNaN(t[0])?z[e]=0:z[e]=Number(t[0])*q.VL[k]/100);for(z.sort($),e=z.length;--e>0;)for(;z[e]==z[e-1];)z.splice(e-1,1);0==z[0]&&z.splice(0,1)}function ee(e){return e>86400&&(e=(e-v.gmtOffset)%86400),e}function te(e,t){var a,n,r=-1;return void 0!==(a=1==t?A:F)&&((n=a.indexOf("<"+e+">"))>=0&&(n+=e.length+2,r=a.indexOf("</"+e+">",n)),n>=0&&r>n)?a.substring(n,r):null}function ae(e){var t,a,r;return void 0!==q&&0!==Object.keys(q).length||(q={Title:["",""],VL:[0,0]}),1==n._ggmsgfmt?t="":(t="",M.prod.indexOf("iag")>=0&&(t=R?S:L,2==e?t+="&pr=iag.cp,cep":1==e?t="":t+="&pr=iag.cp,soc"),M.prod.indexOf("vc")>=0?1==e?t="&ig=1":(null!=(a=te("censuscategory",R))&&""!=a&&(t=t+"&cg="+encodeURIComponent(a)),R&&(t+="&c3=st,a"),1!=e&&(t+=R?C:T),t=t+"&tl="+encodeURIComponent("dav"+e+"-"+q.Title[R].substr(0,128))):M.prod.indexOf("sc")>=0&&(null!=(a=te("censuscategory",R))&&""!=a&&(t=t+"&cg="+encodeURIComponent(a)),R&&(t+="&c3=st,a"),t=t+"&ou="+V+"_"+encodeURIComponent(D.substr(0,128)),0==e?q.VL[R]>0&&(t=t+"&sd="+Math.round(q.VL[R])):t=t+"&du="+Math.round(q.PM[R]),1!=e&&(t=(t+=R?C:T)+"&tl="+encodeURIComponent("dav"+e+"-"+q.Title[R].substr(0,128)))),0==e&&(t=t+"&rnd="+Math.floor(1e5*Math.random()),null!=(r=te("totalchap",R))&&""!=r&&(t=t+"&tc="+r)),t=(t=t+"&ch="+(te("chapter",R)||1))+"&sq="+(te("sequence",R)||1),t+="&tp=gg"),t}function ne(e,t,a){var n=te("iag_"+e,a);return null!=n&&""!=n?"&pr=iag."+e+","+encodeURIComponent(n):null==t?"":t}function re(e){var t=ae(e);o.report("NA",e,t),_=0}function ie(){if(W){var e=ae(1);o.reportend(e)}else;}function oe(e){var t,a="",n=k;return t=q.FP[n]>0&&1==h?Math.round(100*q.FA[n]/q.FP[n]):100,a=(a=null!=e&&""!=e?e:q.PL[n])+","+t,Number(q.PM[n])<e&&(q.PM[n]=e),a}this.getmetval=function(){return q},this.getgp=function(){return M},this.getpageurl=function(){return D},this.getaorc=function(){return R},this.getlfunctionType=function(){return O},this.detectsBrowserClose=function(){return false},this.getGGinstance=function(){return v},this.updateFocusNumbers=function(){h=m.globalHasFocus(),1==x&&(1==h&&(q.FA[k]+=1),q.FP[k]+=1)},this.genSummation=function(e,t){var a,n="",r=0,i=1,o=0,s=-1,l=-1;return e=k,0!=q.CS[e]&&q.PA[e]>0&&q.VL[e]>0&&(r=q.PA[e]>=q.VL[e]?99:q.VL[e]>0?Math.round(100*q.PA[e]/q.VL[e]):66,q.FP[e]>0&&1==h&&(i=q.FA[e]/q.FP[e],r=Math.round(.8*r+r*i*.2)),q.MI[e]>0&&q.SI[e]<=0?r-=10:q.SI[e]>0&&(r+=5),q.SR[e]>0&&(r+=10),(q.SH[e]>0||q.SV[e]>0||q.PB[e]>0||q.CI[e]>0)&&(r=99),q.II[e]>0&&(r+=10),q.ER[e]>0&&q.ER[e]<=5&&(r=20*q.ER[e]),r>99&&(r=99),n=t+",50,"+r+","+Math.round(100*i)+"|||",this.getGGinstance().player.PLVBL&&this.getGGinstance().player.PLVBL.getData()&&(m.childGlobal===m.parentFound&&(a=this.getGGinstance().player.PLVBL.getData()).cumm.samples>1&&(o+=a.cumm.samples,s=a.cumm.score/q.VL[e]*100>=a.cummRule.viewabilitylength?1:0,l=Math.round(a.cumm.totalViewPercent/o)),n=n+t+",53,"+l+","+s+"|||"),q.CS[e]=0),j>0&&(n=t+",25,"+j+","+N+","+B+"|||"+n,j=0,N=0,B=0),n},this.processEvent=function(e,t,n,r,i,d){try{var p,m,v,f,g,P,y,K,J,$,X,ae,ie,se=0,le=e;if(O==le&&s==n&&l==r&&c==i&&u==d)return;if(isFinite(n)&&(n=ee(Number(n))),isFinite(r)&&(r=ee(Number(r))),O=le,s=n,l=r,c=i,u=d,I=!1,null==(p=0==e.indexOf("cust:")?a.genericEvent(e,t,n,r,i,d):a.glanceguideEvent(e,t,n,r,i,d))||""==p)return;switch($=p.split(","),le=Number($[1]),n=$[2],r=$[3],R=k,le){case 1:return w=p,void(null!=s&&(D=s));case 51:if(w)return w=t+",1,"+s,null!=l&&""!=l&&(w=w+","+l),void(null!=s&&(D=s));p=t+",51,"+s,l&&(p=p+","+l),D=s;break;case 2:case 13:case 14:case 24:default:break;case 3:case 15:W=!1,E=0,0,"preroll"==(r=-1===p.toLowerCase().indexOf("<type>content")&&-1===p.toLowerCase().indexOf("<vidtype>content")?"ad":"content")||"postroll"==r||"midroll"==r||"ad"==r?(f=1,A=p):(f=0,F=p),3===le&&"content"===r&&(Y.push(p.substring(p.indexOf(","))),p="");var de={type:te("type",f),vidtype:te("vidtype",f)};V=null!==de.type?de.type:null!==de.vidtype?de.vidtype:0,k=f,R=f,function(e){q.CS[e]=0,q.PA[e]=0,q.PL[e]=0,q.SA[e]=0,q.FA[e]=0,q.FP[e]=0,q.SI[e]=0,q.MI[e]=0,q.SR[e]=0,q.SK[e]=0,q.CI[e]=0,q.DI[e]=0,q.ER[e]=0,q.SV[e]=0,q.SH[e]=0,q.PB[e]=0,q.II[e]=0,q.VL[e]=0,q.PM[e]=0,q.SS[e]=0}(f),15==le&&(q.CS[f]=1,x=1),X=unescape(te("length",k));var ce=te("ou",k);ce&&ce.length>0&&(D=ce),X=null==X||isNaN(X)?30:Number(X),q.VL[k]=X,v=te("title",k),q.Title[k]=null!=v&&""!=v?v:n,Z(),H=0,q.SS[k]=H,te("chapter",k)||1,function(e,t,a,n,r){var i,o,s,l,d,c,u,p,m,v,f,g,_,h,P,y;if(M.prod.indexOf("iag")>=0){if(e){if(S="",2==M.iagads)return}else if(L="",2==M.iagcontent)return;i=null!=M.sid?"&pr=iag.sid,"+M.sid:"",o=null!=M.tfid?"&pr=iag.tfid,"+M.tfid:"",s="&pr=iag.bcr,"+M.clientid,0!=e&&"preroll"==a||(null!=(y=te("iagcategory",0))&&""!=y||(y=te("category",0)),l=null!=y&&""!=y?"&pr=iag.pgm,"+encodeURIComponent(y):"&pr=iag.pgm,general",d=null!=(y=te("title",0))&&""!=y?"&pr=iag.epi,"+encodeURIComponent(y):"&pr=iag.epi,"+encodeURIComponent(q.Title[0].substr(0,255)),c="&pr=iag.seg,",c+=r>1?encodeURIComponent(r):"1",null==(y=te("pd",0))&&(y=M.pd),u=null!=y&&""!=y?"&pr=iag.pd,"+encodeURIComponent(y):"",p=null!=(y=te("oad",0))&&""!=y?"&pr=iag.oad,"+encodeURIComponent(y):"",i=ne("sid",i,0),o=ne("tfid",o,0),s=ne("bcr",s,0),l=ne("pgm",l,0),d=ne("epi",d,0)),g=ne("fp",g,e),P=ne("cust1",P,e),e?(m="&pr=iag.brn,"+M.clientid,v="&pr=iag.cte,"+encodeURIComponent(t),f="midroll"==a?"&pr=iag.ap,mid":"postroll"==a?"&pr=iag.ap,post":"&pr=iag.ap,pre",i=ne("sid",i,e),o=ne("tfid",o,e),s=ne("bcr",s,e),m=ne("brn",m,e),v=ne("cte",v,e),l=ne("pgm",l,e),d=ne("epi",d,e),c=ne("seg",c,e),u=ne("pd",u,e),p=ne("oad",p,e),_=ne("pod",_,e),h=ne("apt",h,e),S=i+o+s+l+d+c+u+m+f+v+p+g+_+h+P):L=i+o+s+l+d+c+u+p+g+P}}(f,n,r,0,d),function(e,t,a,n,r){var i,o,s,l,d,c="",u=0,p=!1;for(e?C="":T="",i=1==e?A:F;0==p;){if((u=i.indexOf("<nol_",u))<0){p=!0;break}if((o=i.indexOf(">",u))<0){p=!0;break}if(l=i.substring(u+5,o),(s=i.indexOf("</",o+1))<0){p=!0;break}d=i.substring(o+1,s),u=s+7,encodeURIComponent(l).indexOf("%")<0&&l.length>32&&(l=l.substring(0,31)),d.length>254&&(d=d.substring(0,253)),c=l.indexOf("raw_")>-1?c+"&"+(l=l.substr(4))+"="+d:c+"&"+l+"="+encodeURIComponent(d)}e?C=c:T=c}(f),W=!0;break;case 4:E=0,g=n,f=(g=isNaN(g)||0==g?q.PL[k]:ee(Number(n)))-q.PL[k],q.PA[k]+=f,q.PL[k]=g,Number(q.PM[k])<g&&(q.PM[k]=g),m=this.genSummation(k,t),de={type:te("type",k=0),vidtype:te("vidtype",k)},V=null!==de.type?de.type:null!==de.vidtype?de.vidtype:"content",x=0,H=0;break;case 5:if(0===k&&U&&3==U[k]&&Y.length>0){var ue=String(t-1)+String(Y.pop());V="content",p=""!==ue?ue+"|||"+p:p}if(E++,g=n,H=0,isNaN(g)){m="";break}0==(g=ee(Number(n)))&&0!=q.PA[k]||(q.PL[k]=g),q.CS[k]=1,x=1,o.updateViewState(oe(g)),q.SS[k]=H;break;case 6:if(E++,g=n,isNaN(g)){m="";break}(f=(g=ee(Number(n)))-q.PL[k])>0&&(q.PA[k]+=f),q.PL[k]=g,q.CS[k]=1,x=0,o.updateViewState(oe(g));break;case 7:if(q.CS[k]=1,1==q.SS[k]||null==q.SS[k])return;if(g=n,isNaN(g)){m="";break}g=ee(Number(n)),(f=Number(g)-q.PL[k])>0&&(q.PA[k]+=f),q.PL[k]=g,Number(q.PM[k])<g&&(q.PM[k]=g),q.PA[k]>0&&(m=this.genSummation(k,t)),x=0,H=1,q.SS[k]=H,q.PA[k]=0,q.FA[k]=0,q.FP[k]=0,0==k&&Z();break;case 8:if(E++,g=n,isNaN(g)){m="";break}if(g=ee(Number(n)),P=r,isNaN(P)){m="";break}P=Number(r),(f=g-q.PL[k])>0&&(q.PA[k]+=f),q.PL[k]=P,q.CS[k]=1,o.updateViewState(oe(P));break;case 9:n.toLowerCase().indexOf("true")>-1||!0===n||n.toLowerCase().indexOf("on")>-1||1==n?q.MI[k]+=1:q.MI[k]-=1;break;case 10:(n||n.toLowerCase().indexOf("on")||1==n)&&(q.SR[k]+=1),h=!1,q.FA[0]=q.FA[1]=0,q.FP[0]=q.FP[1]=0;break;case 11:isNaN(n)||(G<0||n>G&&(q.SI[k]+=1),G=n);break;case 12:q.DI[k]+=1;break;case 16:case 22:q.CI[k]+=1;break;case 17:q.SH[k]+=1;break;case 18:q.SV[k]+=1;break;case 19:case 20:q.PB[k]+=1;break;case 21:q.II[k]+=1;break;case 23:q.ER[k]+=1;break;case 25:return j+=1,N+=ee(Number(n)),void(B<N&&(B=N));case 49:if(isNaN(n))return;if((g=ee(Number(n)))<=1||1!=x)return;if(o.updateViewState(oe(g)),0==z.length)return;if(ae=q.PA[k]+(g-q.PL[k]),0!==z.length&&ae<z[0])return;q.PA[k]+=g-q.PL[k],q.PL[k]=n,m=this.genSummation(k,t),z.splice(0,1)}if(ie=10,(ie=isNaN(q.VL[k])?10:q.VL[k]/60*10)>100&&(ie=100),ie<20&&(ie=20),1==I)return;if(E>ie&&3!=le&&15!=le&&4!=le&&7!=le)return;if(E>5e3)return;if(null!=m&&m.length>0&&(p=m+p),""!==w&&""!==p&&(p=w+"|||"+p,w=""),K=Number(1!=R?M.trackcontent:M.trackads),!isNaN(K))switch(K){case 0:return;case 2:case 3:if(null!=(J=te("ggignr",R))&&"1"==J)return}""!==p&&(se=o.addMessage(p,"NA")),_+=se,y=U[k],7==le?(re(2),0==k?Q=1:(R=0,k=0),y=U[k]):49==le?(re(1),y=0):15==le?(re(0),y=0,0==k&&(Q=0)):3==le?5==U[k]?(re(0),y=0,0==k&&(Q=0)):y=3:5==le?3==U[k]?(re(0),y=0):0==n?1==Q&&0==k?(q.PM[k]=0,re(0),y=0,Q=0):y=5:y=0:(6==le&&0!=n||8==le&&0!=r)&&(y=0),U[k]=y,Number(_)>=Number(b)&&re(1),this.processGeneric=function(e,t,a,n,r,i){this.processEvent("cust:"+e,t,a,n,r,i)}}catch(e){}},this.init=function(e,i,s,l,c){var u=null.firstChild.firstChild,_=0,h=v.player?v.player.getClientConfig():{},O=v.player.getBaseDomain(h)||".nmrodam.com/";for(this._detectsBrowserClose=c;null!=u&&_<20;)null!=u.firstChild&&(M[u.nodeName]=u.firstChild.nodeValue),u=u.nextSibling,_++;1!=n._ggmsgfmt&&(s=(s=null==M.sfcode||M.sfcode.length<2?K+"//secure-gl"+O+"cgi-bin/m?":K+"//secure-"+M.sfcode+O+"cgi-bin/m?")+"ci="+M.clientid,null!=M.cisuffix&&""!=M.cisuffix&&(s+=M.cisuffix),null!=M.vcid&&""!=M.vcid&&(s=s+"&c6=vc,"+M.vcid),null!=M.partner&&""!=M.partner&&(s=s+"&c4=mn,"+encodeURIComponent(M.partner)),s+="&cc=1"),t=s,null==M.prod&&(M.prod="vc"),this._ggtrackid=M.clientid,null!=M.vcid&&(this._ggtrackid=this._ggtrackid+"."+M.vcid),a="genjsplayer"==e?new f:new p,this._ggplayername="gj3",null!=M.msgmax&&M.msgmax>0&&(b=M.msgmax),null!=M.msgint&&""!=M.msgint&&(y=M.msgint),null!=M.focusint&&M.focusint>=0&&(P=M.focusint),this._detectsBrowserClose&&(-1!=r.navigator.appName.toLowerCase().indexOf("safari")||-1!=r.navigator.userAgent.toLowerCase().indexOf("firefox")?r.addEventListener("pagehide",ie,!0):r&&r.NOLBUNDLE),o=new d(g,i,t,!0,!0,J),0!=P&&(m.globalHasFocus(),r.setInterval(this.updateFocusNumbers,1e3*P)),this.processEvent("1",(new Date).getTime(),r.location.href,r.document.referrer)}}function s(){var e=null,t=0;this.makeUserIDCookie=function(t){return e=function(e){var t,a="",n="";for(t=0;t<e;t++)n=Math.floor(36*Math.random()).toString(36),a+=Math.floor(2*Math.random())?n.toUpperCase():n.toLowerCase();return a}(32)},this.makeNewMessageCookie=function(){},this.clearMessageCookie=function(){},this.getMessageCookieSequenceNumber=function(){return++t},this.getUserId=function(){return e}}function l(e,t,a,n,r){var i='END"/></GGC>',o="|||",s="",l=Math.floor(1e5*Math.random())+1,d='<GGC><H value="'+e+","+(new Date).getTimezoneOffset()/-60+","+t+"."+l+","+n+","+r._ggplayername+'"/><L value="';this.getCurrentMessage=function(){return s},this.makePartialMessage=function(e){return""==s?s=d+e+o:s+=e+o,s},this.makeMessages=function(e){var t;return""==s?s:(t=s+i,s="",t)},this.makeUnloadMessages=function(e){var t;return""!=e?(t=e.split(","),r.processEvent("7",(new Date).getTime(),t[0]),null):(""==s&&(s=d),s+(new Date).getTime()+",2"+o+i)}}function d(e,t,a,n,r,i){var o,d=new s,p=null,m=d.getMessageCookieSequenceNumber(),v=i,f=new c(a,a+"logthisjs.php",a+"postjs.php","GET"),g=new u,_="",h=String.fromCharCode(56)+String.fromCharCode(103)+String.fromCharCode(36)+String.fromCharCode(15)+String.fromCharCode(126)+String.fromCharCode(3)+String.fromCharCode(71)+String.fromCharCode(91)+String.fromCharCode(100)+String.fromCharCode(7)+String.fromCharCode(17)+String.fromCharCode(31)+String.fromCharCode(95)+String.fromCharCode(28)+String.fromCharCode(64)+String.fromCharCode(14);d.makeUserIDCookie(t),d.makeNewMessageCookie(),null==t&&(t="0"),p=new l(e,t,m,v._ggtrackid,v),g.encrypt(h,'END"/></GGC>'),this.getMessage=function(){if(void 0!==p)return p.getCurrentMessage()},this.getSeqNumber=function(){return m},this.report=function(e,t,a){o=p.makeMessages(e),o="<m v=2 c="+d.getUserId()+">"+g.encrypt(h,o)+"<%2Fm>",f.report(o,a)},this.reportend=function(e){(o=p.makeUnloadMessages(_))&&(o="<m v=2 c="+d.getUserId()+">"+g.encrypt(h,o)+"<%2Fm>",f.report(o,e))},this.addMessage=function(e,t){return p.makePartialMessage(e).length},this.updateViewState=function(e){var t;v._detectsBrowserClose&&(5!=(t=v.getlfunctionType())&&8!=t||(e=""),_=e)}}function c(e,t,a,n){var r=e,i="GET-CONFIRM",o=new Image(1,1);null!=n&&(i=n),this.report=function(e,t){null!=e&&""!=e&&"POST"!=i&&function(e,t){var a=r;"GET"==i&&(o=new Image(1,1)),o.src=a+t+"HEX40%3D"+e}(e,t)}}function u(){this.urlencode=function(e){var t,a={},n=e.toString(),r=function(e,t,a){return a.split(e).join(t)};for(t in a["'"]="%27",a["("]="%28",a[")"]="%29",a["*"]="%2A",a["~"]="%7E",a["!"]="%21",a["%20"]="+",n=encodeURIComponent(n),a)a.hasOwnProperty(t)&&(n=r(t,a[t],n));return n.replace(/(\%([a-z0-9]{2}))/g,(function(e,t,a){return"%"+a.toUpperCase()}))},this.encrypt=function(e,t){return this.urlencode(function(e,t){var a,n,r,i,o,s,l="";if(null==e||null==t)return t;for(n=(a=e.split("")).length,i=(r=t.split("")).length,s=0;s<i;s++)l+=0==(o=r[s].charCodeAt(0)^(i%10|a[s%n].charCodeAt(0)))?r[s]:String.fromCharCode(o);return l}(e,function(e){var t,a,n,r;for(r="",n=void 0!==e&&e.length>0?e.length:0,t=0;t<n;t++)(a=e.charCodeAt(t))<128?r+=String.fromCharCode(a):a>127&&a<2048?(r+=String.fromCharCode(a>>6|192),r+=String.fromCharCode(63&a|128)):a<65536?(r+=String.fromCharCode(a>>12|224),r+=String.fromCharCode(a>>6&63|128),r+=String.fromCharCode(63&a|128)):(r+=String.fromCharCode(a>>18|240),r+=String.fromCharCode(a>>12&63|128),r+=String.fromCharCode(a>>6&63|128),r+=String.fromCharCode(63&a|128));return r}(t)))}}function p(){this._currentEvent=-1,this._currentDuration="NA";var e=null,t=null,a=null,n=null,r=null,i=null,o=null,s=null,l=null,d=null,c=null,u=null;this.getCurrentEvent=function(){return this._currentEvent},this.genericEvent=function(e,t,s,l,d,c){var u;return a==e&&n==s&&r==l&&i==d&&o==c?null:(u=function(e,t,a,n,r,i){var o=t+","+e;return null==e||e.length<=5?null:(null!=a&&(o=o+","+a),null!=n&&(o=o+","+n),null!=r&&(o=o+","+r),null!=i&&(o=o+","+i),o)}(e,t,s,l,d,c),null!=u&&(a=e,n=s,r=l,i=d,o=c),u)},this.glanceguideEvent=function(a,n,r,i,o,p){var m=null;return s==a&&l==r&&d==i&&c==o&&u==p?null:(1==a?(this._currentEvent=a,e=r,m=n+","+this._currentEvent+","+e,null!=i&&(m=m+","+i)):10==a||9==a?(this._currentEvent=a,m=0==r?n+","+this._currentEvent+",0":1==r?n+","+this._currentEvent+",1":n+","+this._currentEvent+","+r):12==a?(this._currentEvent=a,m=n+","+this._currentEvent):49==a||11==a?(this._currentEvent=a,m=n+","+this._currentEvent+","+r):"videoInfo"==a?t=r:m=this.processEvent(a,n,r,i,o,p),null!=m&&(s=a,l=r,d=i,c=o,u=p),m)},this.processEvent=function(e,t,a,n,r,i){},this.getVideoInfo=function(e,a){var n="";return null!=e&&(n="<length>"+e+"</length>"),null!=a&&(n=n+"<uurl>"+a+"</uurl>"),null!=t&&(n+=t,t=null),n}}function v(e,t){var a=e.indexOf("<"+t+">")+t.length+2,n=e.indexOf("</"+t+">",a),r=null;return a>=0&&n>a&&(r=e.substring(a,n)),r}function f(){this.inheritFrom=p,this.inheritFrom();var e=null;this.processEvent=function(t,a,n,r,i,o){var s,l,d="";return 3==t&&3!=this._currentEvent||15==t&&15!=this._currentEvent?(s=v(i,"censuscategory"),null==v(i,"category")&&null!=s&&""!=s&&(i=i+"<category>"+s+"</category>"),this._currentDuration=v(i,"length"),d=d+","+n+","+r+","+i,o&&""!=o&&!isNaN(o)?d=d+","+o:d+=",1",e=15!=t&&e):1==t||51==t||8==t?(d=d+","+n,null!=r&&(d=d+","+r)):6==t&&1!=e&&"00:00"!=n?(e=!0,d=d+","+n):5==t&&0!=e?(e=!1,d=d+","+n):7==t?(e=!0,"0",d=d+","+n):9==t?d+=0==n?",Off":",On":(d=d+","+n,null!=r&&r.length>0&&(d=d+","+r)),""==d?l=null:(this._currentEvent=t,l=a+","+this._currentEvent+d),l}}return n.init=function(e){var a={_playerID:null,gmtOffset:60*(new Date).getTimezoneOffset(),ggJsMet:null,ggLoaded:!1,ggEventQue:[],playerType:"genjsplayer",_nolggGlobalParams:{},_detectsBrowserClose:!1,_canDetectBrowser:!0,_bStr:"",_bLoc:"",_isFireFox:!1,bVer:"",player:e,ggInitialize:function(e){var r="",i=e||{};for(var s in a._nolggGlobalParams=i.ggParams,a._canDetectBrowser=void 0!==i.detectBrowser?i.detectBrowser:a._canDetectBrowser,a._playerID=i.nol_playerId,a._canDetectBrowser&&a.detectBrowser(),a._nolggGlobalParams)a._nolggGlobalParams.hasOwnProperty(s)&&(r=r+"<"+s+">"+a._nolggGlobalParams[s]+"</"+s+">");a.ggJsMet=new o(a),a.ggJsMet.init(a.playerType,i.uid,n.GGADDRESS,r,a._detectsBrowserClose),t._listeners.addListener("ggPM",(function(e){a.ggPM(e)}))},detectBrowser:function(){a._detectsBrowserClose=!0,a._bStr=r.navigator.userAgent,a._bLoc=a._bStr.indexOf("Firefox"),null!=a._bStr&&a._bLoc>=0&&(a._isFireFox=!0,a.bVer=a._bStr.substring(a._bLoc+8),Number(a.bVer)<3&&(a._detectsBrowserClose=!1)),a._bLoc=a._bStr.indexOf("MSIE"),null!=a._bStr&&a._bLoc>=0&&(a.bVer=a._bStr.substring(a._bLoc+5),Number(a.bVer)<6&&(a._detectsBrowserClose=!1))},ggPM:function(e){if(a._playerID==e.target.id){var t=e.target.evtInfo,n=String(t.eventType),r=String(t.param1),i=String(t.param2),o=String(t.param3),s=String(t.param4);if(!(-1!=="|14|56|48|57|55|".indexOf("|"+n+"|")||isNaN(n)&&"videoInfo"!==n))try{if(null!=a.ggJsMet){if(-1!==r.toLowerCase().indexOf("object"))for(var l in r=t.param1.uurl||"",i=t.param1.type||t.param1.vidtype,o="",t.param1)t.param1.hasOwnProperty(l)&&(o=o+"<"+l+">"+t.param1[l]+"</"+l+">");a.ggJsMet.processEvent(n,(new Date).getTime(),r,i,o,s)}else a.ggEventQue.push(n),a.ggEventQue.push((new Date).getTime()),a.ggEventQue.push(r),a.ggEventQue.push(i),a.ggEventQue.push(o),a.ggEventQue.push(s)}catch(e){}}},ggJsLoaded:function(){if(null!=a.ggJsMet){for(var e=0,t=a.ggEventQue.length;e<t;e+=6)a.ggJsMet.processEvent(a.ggEventQue[e],a.ggEventQue[e+1],a.ggEventQue[e+2],a.ggEventQue[e+3],a.ggEventQue[e+4],a.ggEventQue[e+5]);a.ggEventQue=[]}}};a.ggInitialize(e.getConfigParams()),e.hasOwnProperty("emptyQueue")&&e.emptyQueue()},void 0===t||n.built||(n.built=!0,a.logDebug("PLCMB built",t),t.bindPlayers(n,"PLCMB")),n},exports.PLDCR=G,exports.PLDPR=Q,exports.PLLOG=J,exports.Product=ht,exports.Tag=Ke,exports.addDataObj=Ie,exports.addScript=U,exports.applyTagFilter=He,exports.bindEvent=qe,exports.buildIAGParams=_t,exports.calcStreamId=Re,exports.calcTimeOffsetByServer=ct,exports.calculateDuration=dt,exports.calculateTriggers=ft,exports.callService=Ve,exports.cast=b,exports.checkSegmentTimeSpent=ut,exports.checkStop=ze,exports.cloneDeep=tt,exports.cmsMapDictionary=O,exports.containsParam=function(e,t){try{var a,n,r=e.split("&");for(a=0,n=r.length;a<n;a++)if(0===r[a].indexOf(t))return!0;return!1}catch(e){return!1}},exports.debug=function(e){var t=c(),a=m.getInstance();t.console&&a.logInfo("Nielsen Log: Debug - "+bt(e))},exports.emptyFirePingCallbackQueue=Pt,exports.encodeVal=z,exports.error=function(e){var t=c(),a=m.getInstance();t.console&&a.logError("Nielsen Log: Error - "+bt(e))},exports.filterLookup=Qe,exports.findScript=I,exports.fireCustomEvent=ae,exports.firePing=ot,exports.gIframe={},exports.getDataObj=L,exports.getDefaultField=A,exports.getGlcfgInstance=X,exports.getGlobalsField=F,exports.getInstanceGlobals=h,exports.getMessage=bt,exports.getNamespace=y,exports.getTSVFlag=yt,exports.getiagval=gt,exports.ggpmPostProc=je,exports.ggpmPreProc=Ge,exports.handleFunc=at,exports.handleGgpm=Be,exports.handleStopEvent=xe,exports.incViewCnt=pt,exports.info=function(e){var t=c(),a=m.getInstance();t.console&&a.logInfo("Nielsen Log: Info - "+bt(e))},exports.init=Ae,exports.isSDKReady=function(e){var t=c()[e];return t&&t.hasOwnProperty("isBuilt")&&"function"==typeof t.isBuilt&&t.isBuilt()},exports.iterateInstances=function(e,t){if(t){var a=S.findScript(e);if("string"==typeof a)t(e,S.parseNOLParams(a));else for(var n=0;n<a.length;n++)t(e,S.parseNOLParams(a[n]))}},exports.loadSDK=function(e,t,a,n){var r=m.getInstance();try{r.logDebug("MESSAGE: DONT BELEIVE WE NEED THIS ANY LONGER (QUEUE CONTROLLER) ")}catch(e){}},exports.loadScript=k,exports.logger=function(e){var t=c(),a=m.getInstance();t.console&&a.logInfo("Nielsen Log: Logger - "+bt(e))},exports.lookupVal=Ze,exports.param=w,exports.paramOverride=D,exports.parseNOLParams=E,exports.populateOttStatus=Fe,exports.populatePattern=st,exports.processVar=nt,exports.queryParam=ne,exports.reInit=Me,exports.removeParam=P,exports.request=C,exports.resetDataObj=We,exports.resetMinutes=mt,exports.resolveURL=rt,exports.returnTriggers=vt,exports.rounding=lt,exports.sendDebug=q,exports.sendError=it,exports.sendMaskedPing=T,exports.sendSyncData=H,exports.setTesting=R,exports.settings=K,exports.stnUpdate=ke,exports.timerApiCheck=Ne,exports.warn=function(e){var t=c(),a=m.getInstance();t.console&&a.logWarn("Nielsen Log: Warn - "+bt(e))},exports.xor=et;
